<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Webpack4 notes | Harry World</title><meta name="keywords" content="frontend,webpack4"><meta name="author" content="Harry Qu"><meta name="copyright" content="Harry Qu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="# Webpack # 构建工具 前端技术不断发展，比如： React  的 jsx ， Vue  和 Angular  指令， CSS  预处理器，最新的 ES  语法等，浏览器都不能识别。 构建工具的作用就是将这些浏览器不能识别的语法（高级语法）转换成了浏览器能识别的语法（低级语法）。 还有一个作用是将代码压缩混淆，在压缩代码体积的同时也让代码不易阅读。 webpack  是现在前端流行的构建">
<meta property="og:type" content="article">
<meta property="og:title" content="Webpack4 notes">
<meta property="og:url" content="https://harryqu1229.github.io/2022/02/25/webpack4/index.html">
<meta property="og:site_name" content="Harry World">
<meta property="og:description" content="# Webpack # 构建工具 前端技术不断发展，比如： React  的 jsx ， Vue  和 Angular  指令， CSS  预处理器，最新的 ES  语法等，浏览器都不能识别。 构建工具的作用就是将这些浏览器不能识别的语法（高级语法）转换成了浏览器能识别的语法（低级语法）。 还有一个作用是将代码压缩混淆，在压缩代码体积的同时也让代码不易阅读。 webpack  是现在前端流行的构建">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://raw.githubusercontent.com/HarryQu1229/image-host/ca78dff38e0bfb81a8e98ad64f749e97bcc55f14/notes-img/Billfish.yWAOuM.png">
<meta property="article:published_time" content="2022-02-24T13:31:45.483Z">
<meta property="article:modified_time" content="2022-02-25T15:29:18.110Z">
<meta property="article:author" content="Harry Qu">
<meta property="article:tag" content="frontend">
<meta property="article:tag" content="webpack4">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/HarryQu1229/image-host/ca78dff38e0bfb81a8e98ad64f749e97bcc55f14/notes-img/Billfish.yWAOuM.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://harryqu1229.github.io/2022/02/25/webpack4/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: undefined,
  noticeOutdate: {"limitDay":100,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"prismjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'mediumZoom',
  Snackbar: {"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Dark Mode Activated Manually","night_to_day":"Light Mode Activated Manually","bgLight":"#C78550","bgDark":"#c08eaf","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Webpack4 notes',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-02-26 04:29:18'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><style type="text/css">.aplayer.aplayer-fixed.aplayer-narrow .aplayer-body{left:-66px!important}.aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover{left:0!important}</style><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@master/Hexo/css/flink.min.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-footer-beautify@1.0.0/lib/runtime.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://raw.githubusercontent.com/HarryQu1229/image-host/6aca34ee52f40fe1b2d637474f90111e2c151939/notes-img/%E5%85%B6%E4%B8%AD%E5%8C%85%E6%8B%AC%E5%9B%BE%E7%89%87%EF%BC%9A%7B%7B%20pinTitle%20%7D%7D_m6kogp.jpeg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">171</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">89</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">60</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-graduation-cap"></i><span> Journey</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> Hobbies</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/Photos/"><i class="fa-fw fas fa-images"></i><span> Photos</span></a></li><li><a class="site-page child" href="/Videos/"><i class="fa-fw fa-regular fa-play"></i><span> Videos</span></a></li><li><a class="site-page child" href="/Movies/"><i class="fa-fw fas fa-video"></i><span> Movies</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Links</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAACMCAMAAABmmcPHAAAAw1BMVEX///8aHByO1vsceMAAAAAYGhoWGBjw8PCJ1Pv3/P8RExMiJSWV2PuG1Pu25PwAcL3MzMzo9/6fn5/O7P2yzudYl87T5PJ+rdhPUVHr6+uoqKjl5eUABwcRFBQKc76JiYlcXV3a8f6u4fzW1tZ5enqTlJQsLi5BQkLv+f4AbLtrbGxnaGjF6f1NT0+j3fzc3Ny7u7uwsbE0NjaAgIDI2+7f6/Wbvt9sodKKtNu60uk2hcbBwcF3p9U+iMdknNDO3+8AZLjWDvjfAAAPI0lEQVR4nO2de0PiOBfGW0xbKCKIOnJpAeWmKHKb67qzs9//U71pkpOcpCnirArMm+cvLaFNfz09lyQtnufk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OT0f6jK47nnPd7suxt/vC5OaxT0We32fN89+aN1/lQuMdDlcvmssu/e/LG6u62VSgJ0qVQuP+67Q3+mKmc1ileBpqhPnat+e12UGFwMmv795Fz12+rmSaDVQVP/cXa37779QbpTmA3QFHXJueo3EjhnO+jMqp2rfgtJ51wE2rnqt9DNaa1Uegk0tepb56r/i86fTKIFoLOouO/OHq8qt7U85wLQWVS82HeHj1OVx7IFZzFo+okrYH5DN6dWmNtA08/2NdYUtYX2c3gp6Ea06xdszhlYVujHuRAJ/mNPY02duMpEuvs4utKEd8Nv7db87rYQMyRyZtKnUO+lgOmQgGnfoKsp60Y836WxUaBgiNgJPxai3oOr7hCfae+gQ9aNeBeLLrbVU55WfL66ZmZdObNHy30UMMcH+qbIOVOXwLzvl3/qvd7Jd/b3+W2xq/7YAubYQFeeisjVeJC7+5tSpqr/dcm+sC0qvvdJYR0b6KKkTlTYle91hpmj/rHDNz5KRwfaGuOEy61cntRPkO6vPrFvXORRf7iTPi7QFRHjdG8A9d6Pnxpmql792xf+DT0qQjH+gbCPDHTplsc45KkB2qcrEzND3bvmrhuNioA7Pz+9fd+Twjoy0Kcws30j/Af8n6UaFs4M9VfW4g4uTu2JOecM/QeGw2MDraqNzFVDPX13fV+AmUXFE56AsMRQfp1a+PuAjqLFsBuZYwkm6Kg7XLw44JA1yu0Jf962HUrvTFdvsTtoGcioSfIRosrXky2YGeqfn9n3L06Fn+Hh0Qp62BTq4P7CRnxSHdjYUNsW41ZKMlUH/QXerQZ6MR4kWaN4OnrWsIzFHllHxi22p3SuN4IjNWfrmDUg69nSCnvYb/miM2PojAX0Kn/GHLQyZLbx8i+bczaj4j8sAamwr8CAlBV0g4Aiy8YlokJyG58pmjhgZxJSCC0ECIFuz6BVkCZk3bHsMvK6A60ROi5r2JzTj0N+KD9MiN/Poe5Mtc4MGgWgV/I8VHcFaDyG/zmXahSh5glINlsglyJYXYfoio+hjgWmZITh+6IhbJmR2MeKyUMedPQcJ7hRSFqSUcQbBYm3TLRGKRmg8dVoE5NUOxLdS1W7gbylbzSJySyygV4QcbnIWH1bgpa+tvK994LbkO5D1C+PKP2wgh6JU0w2attUdDqc5uHHgubQJ74pMgE+ADrpk9BolCRDHbTv9+HsESdpb0uSmJ+ya4HD7Ch3FNqZuQ20LxomD+jrCDTFxD3H+beifEMz6BOee3gXKAe3g34WZxtW5SYJwCfKbubCfMmKc44NI+MnBKQBtJ/kG6XpwjiOpVFIIBR0bZzpXtbqHB7y15x2tGMB/SAOlU4wAw10CUroXy96j179GhpflF8C7UmXIG/pJdE6y9Suwi3HUEaB4hymypySlgHapngdGRfUopDA3dG3NyNN6NvM1iBIunnQTQIfap5HB00D4jfuDi57W1HfX/H68PpyJ9AtMFXppEfSwuIZbAMXLbo8gCYhIZNplchbV1waHTTLTGJlmGRkAR2wpEJdv1j6LeZYwoSHMBkXwkmUuxC8ETtSysb6ddAN6aBXGoIc6Kv7n3w4Y4urrv/1WVyN+91Ad3KRT3nMwAczh7PhMWQlb4MJ63LUqQryAb8xMOiUrJur5erBV/slQxN0QPwZbdScKpLSZDskoJnIaPU87A6XA3VNG5oJsBA5ovsYt2Lahl9xDXQ7hsDf1xHkQfd6938zr/ClwFWDc86yk/puoNvgpMHpLdD5EwhcA7D77J6LJtBjeXGiVoKvBAJNphDXmgkwigcG6DTuiEs6nMPWsApXeRKPoB80qAQ6LojcfjKBA0XjasIvuAZ6Ks4hN7FlAc1Qsqza5qrBOfMKfUfQ0NMgFnEcWyMkQZFIYnkeAgathW4Rz2mypu2DoBRxCCbF5xIV6NBHPnMkbxeIEEOtkIfwzfMfGVBQ3kit54E7HgwabsowNpNwK2iVuRmjpPQDPk4KOeCuoCFxg4xqgNJjuPgNzb8Itx6kGACcMbsJJGjdelQy3tRAkwZuBVGjqHAWlsG98KDATBcm6GdiPdgW0Igo9h/1E+APrXYEPQSIPJOOfF6h8S4Sy8UAZ5PMtP3w73GGEjTRCwuwKuY7JGjDZ8qEjtiXhTxwtmGWvHTteQRIge5Kj9PMtSoEfSJdtRzFA+f8S1Xou4KO1rwLKb/buNUFk2mIzBxsmAXHlXELCM1ixbCj3d6IoQiILGUA0EFoAIW0B1Wr0XNzM5vNxqu2/Jj58I5uJcWgZR0wy7cqBs2GQ5mr5jW5dM7f7pGJ7wgaOi6cNDe6eDRmWxNmbBE2RK8vOMSzPtY8FAwRaGKMWqig2jX3igR3uSyTn2c0a0viOMveBg1xRYMMtLwmVoMG0OlAFrZTS6ttoDVXbTjn14J+1iyUGy9Zcstm2FSLFYblxwkWBDpsaMSMO9IHNRRo0jEatbWI4HVbuAqPweGwA4lbLZx4VsFITlV0WUb8V4DOhkMF30tB3Ph4V9Bt4V2Z9bZT9g9pR7wWZPnBWOM2tVXfUixEStDmsZbokkV2F0QlihseDRvG4JU8UAZ6sn3AGUDDyF9scRwvg5auOtPn3PDpzqDBRJmT5iSykQS+lRkxeHGeaq/zIzhYWVgSoAPfPBRE3iwkRci6dQl8LLVvWAaMFGhwwg/mLjTQwdSH+Gob7H4RtHLVNCqaH70CNL7RudPLOPCtzAYQHQ9ZdGBVlt8B6Kp5KCvo3Mkj0NFEHi3RSnDdogdbQacDCOCqCnod6CyrO6dew1Yn7g66i0IXN9cM1iKBk5UumkccCOBBGNtEFltcxzPyy5Hm+bGE68huMfBafhL2l4tGZyYNnIHWM6Yi0CjrSF6ZdSjdU0d9bftgd9BgF9RJc+ZBnG0VzBeQ/ULEmcEQdjeyykOgzUy4iawYQOdSM7jwmUOQExMzqNGrKQI9QBnIVtBqxN9MhHYFXX8D0MJsqPVyQvzU++BFhK9I+lprNRCSV6fIWPGYCYDOmSNETHpAcDUo2g1FCsLgQqpp9b1aZQi9DvJl0MeBlp6zMovVVecJXvwAAx0QtGTmMC7cIYBOjcIYij6tYMldsZaaZOhY/PgDsuIVMv7toGVoyS+W/jjQ4BTJkjEVY52eqBHFycg4EuHyDksVDaoE1zMKewme6JTUiEhX3T2oIBlDpEUleIFJY9BD2dQswj8QNFS181Ri8OA+T0XJp3JQef+PtJ0M1f8StO4WFMKVpw0qYb/Zhjwj+27T4qYwaNmX0NdLkdygkudtpPMwysgPBA3eINQuucAF4WhlttZJN4KUrBcGaD+ZK7N/hoAUhJEGOkC+vL2GDC5zTdJ1ICts4QAo+5Im6OaJHqp50N6kwHl8IOhImwGFK94maGMQKpOZShZruGPbbCY6FcTQmHYcC4jdmZxi4d4dDfwHZMCPGXXkbFYQt9U9EMi5c7lvkWmorJ6MRA/bfZLwWXJzKks7/j5AQ4DhtiFvd1xsYzOQY7vZPNVm3OyMB0SMTPHRMTx5EJDJqN/ftEiitngG6GwIY77p9wcETc1kNCKYagzDFePaBgcAoNVUlp+Q9WzTH7Ej8VvAmJxVcwpa+P1I0JiMmj3EE9BaCBmpD0K9YEur5u6yJlToSgqzN2bB06yRurFE1i5nigPiP2w2A3S5RHDGnQyzcS5mHdxaDNARZOXblhu8L2htolAG8AbeqhnB1LIWg50pdztblxsQUaBsXW4A+coCTRXH2pWQRcrcth/rcoOC6JIDbRnQKAbdu//xCtDIS6ipb2UB2gIb9snUSikO+eWQftQy8CaH3iVoSysVHptFl0NVgy1bE3YH5lYqwQoaLR3Mr1T6ak4TFoOuX/3ydlmpBFI3IB6gmUkEiTFFH81sy7CMrCMe5Ra3hGreSpXgA7NVnKiEb2N8GODKEJrkRm4DZrM50Mrno6Idr70Tyxzv8is6rKBhVqCCHojbDlp5CTwOv1Jbc2OZS99AnZANdF6ApqV8XxtNDkhVWZIcVBpTn49JhWSK/dRY20VMxnykHI9vPK911AGxBkMPOQ80uqRA19QT3V/+NlahW0DXxZKETOqBuBcWosdyPSvK/LtyY24cLltNWyWEPwOcLbaV2ZWX3e9c1KqGA9EoW00bj1ExiUB7jSlJ+K5ocJ0YIyTDORyHHoZeg0l+pbG3Yst2ZV82vC/QeVQ2DeQZSYMC0PBM1Zl4ruJKGxTNge7Vv4sHWfhqf3j09gXQwwYIb5Ub7QNIw/GUzWfF05G2OrwrvsU8yYI3qs7HepmMQWfryKdsRmzdtxxK7CKZ9rPeLSwdpcfstIKEN1LRPN/7qJE7UQ4ano6gvMol/qe2StoA3evxWZfsCXJ4To4/pfVez7CIkdGXWlk2AWjl/rc+WbHDYXbriyn2DIt4OcENf/in9sRRo3X/Guhe/R++wpE/nigfFsi+fXAv/7GA3o8o6NotPFMlQ5qw0q8QFTHo+5+/2DfVM53yQp0e3luWDgd06ZQ7Z+0lP+Uyf/oQ1ikp0LBWSX9KWT2Y5UAXqMJTuhvzIeVy7RE9cQ+g62Kt0nnuQX3xqGHl0F5mdTCgmfLcUFr9iSYgHDS8SeLO+iaJ2kG+XPqQQBe+5Accwuef/2ag76+tT4GjK3OAbyw9JNBewTvYSjIqepcU9CV/1q3wbT+H+Wa2gwK95QU+4HtBOV+O7PkAMR8aaOMlxjrAmnqDz03Ry2oO021kiuBVYgcC+gWIuTdNmHZ/sK/ujohY2nQwoLe8Koxuv9vmyQ/6Dcd4bdPBqPhda1temel+XuE3VJTpFYM+WOd86LI74sLXGrufwPl92d61VgDa/ajTf9Nj7j2lVtAHWaAclyq3RlS0gHYvQ38TGa7a8vMgj845v420n64wQdfcD1a8oS6U/9BBH3SBcoxSb+/GoA909Oi4BQUM+pk9V6C8j/hYk/zhyMMdPTp+ZWNNArRzzu+rszL/cV9XoLy3Klmpfeacs5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5PTa/U//8ZkEo9djoEAAAAASUVORK5CYII=')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Harry World</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-graduation-cap"></i><span> Journey</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> Hobbies</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/Photos/"><i class="fa-fw fas fa-images"></i><span> Photos</span></a></li><li><a class="site-page child" href="/Videos/"><i class="fa-fw fa-regular fa-play"></i><span> Videos</span></a></li><li><a class="site-page child" href="/Movies/"><i class="fa-fw fas fa-video"></i><span> Movies</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Links</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Webpack4 notes</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2022-02-24T13:31:45.483Z" title="Created 2022-02-25 02:31:45">2022-02-25</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2022-02-25T15:29:18.110Z" title="Updated 2022-02-26 04:29:18">2022-02-26</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Frontend/">Frontend</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Frontend/webpack/">webpack</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">7.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>30min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Webpack4 notes"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">Comments:</span><span class="disqus-comment-count"><a href="https://harryqu1229.github.io/2022/02/25/webpack4/#disqus_thread"></a></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="webpack"><a class="markdownIt-Anchor" href="#webpack">#</a> Webpack</h1>
<h2 id="构建工具"><a class="markdownIt-Anchor" href="#构建工具">#</a> 构建工具</h2>
<p>前端技术不断发展，比如： <code>React</code>  的 <code>jsx</code> ， <code>Vue</code>  和 <code>Angular</code>  指令， <code>CSS</code>  预处理器，最新的 <code>ES</code>  语法等，浏览器都不能识别。</p>
<p>构建工具的作用就是将这些浏览器不能识别的语法（高级语法）转换成了浏览器能识别的语法（低级语法）。</p>
<p>还有一个作用是将代码压缩混淆，在压缩代码体积的同时也让代码不易阅读。</p>
<p><code>webpack</code>  是现在前端流行的构建工具。</p>
<p><img src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220123013214817.png" alt="image-20220123013214817"></p>
<p>Webpack 作为静态模块打包器会根据入口文件的依赖关系，将资源引进来，形成 chunk 代码块，根据不同资源进行编译，这个处理过程我们叫打包，打包输出的文件叫 bundle</p>
<hr>
<h2 id="初识webpack"><a class="markdownIt-Anchor" href="#初识webpack">#</a> 初识 <code>webpack</code></h2>
<h3 id="配置script脚本"><a class="markdownIt-Anchor" href="#配置script脚本">#</a> 配置 <code>script</code>  脚本</h3>
<p>安装好 <code>webpack</code>  后，在命令行中使用 <code>webpack</code>  时，有两种方式：</p>
<ol>
<li>指定路径 <code>./node_modules/.bin/webpack</code></li>
<li>使用 <code>npx</code>  工具， <code>npx webpack</code></li>
</ol>
<p>这两种方法使用挺麻烦的。有种简单的方式使用 <code>package.json</code>  中的 <code>scripts</code> ，它能够读到 <code>node_modules/.bin</code>  目录下的命令。</p>
<p>在命令行中执行 <code>npm run build</code>  即可。</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
  <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"webpack"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="配置文件"><a class="markdownIt-Anchor" href="#配置文件">#</a> 配置文件</h3>
<p><code>webpack</code>  的默认配置文件__ <code>webpack.config.js</code> __，可以通过 <code>webpack --config</code>  来指定配置文件。</p>
<p>比如，生产环境的配置文件 <code>webpack.config.prod.js</code> ，开发环境的配置文件是 <code>webpack.config.dev.js</code> 。</p>
<p>所以在我们自己的那个 package.json 里面:</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
  <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"webpack --config webpack.config.prod.js"</span><span class="token punctuation">,</span>
  <span class="token property">"build:dev"</span><span class="token operator">:</span> <span class="token string">"webpack --config webpack.config.dev.js"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>一般在我们 <code>webpack.config.js</code>  配置文件中，使用 <code>module.exports</code>  (起码 webpack4 这么做) 也就是 commonjs 的方式</p>
<p>我们正常 src 里面的 js 文件该用 es6 module 模块方式就用，没影响</p>
</blockquote>
<h3 id="核心概念"><a class="markdownIt-Anchor" href="#核心概念">#</a> 核心概念</h3>
<p><strong> <code>webpack</code>  有 5 个核心概念： <code>entry</code> 、 <code>output</code> 、 <code>mode</code> 、 <code>loaders</code> 、 <code>plugins</code> 。</strong></p>
<h4 id="entry"><a class="markdownIt-Anchor" href="#entry">#</a>  <code>entry</code></h4>
<p><strong>打包时的入口文件</strong>，默认是 <code>./src/index.js</code></p>
<p><img src="C:%5CUsers%5Charry%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20220123105003939.png" alt="image-20220123105003939"></p>
<p><code>entry</code>  是有两种方式：单入口、多入口。</p>
<p>单入口用于单页面应用， <code>entry</code>  是个字符串</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  entry<span class="token operator">:</span> <span class="token string">"./src/index.js"</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>多入口用于多页面应用， <code>entry</code>  是对象形式</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  entry<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    index<span class="token operator">:</span> <span class="token string">"./src/index.js"</span><span class="token punctuation">,</span>
    app<span class="token operator">:</span> <span class="token string">"./src/app.js"</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="output"><a class="markdownIt-Anchor" href="#output">#</a>  <code>output</code></h4>
<p>打包后的输出文件，默认是 <code>./dist/main.js</code> 。</p>
<p><img src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220123105020439.png" alt="image-20220123105020439"></p>
<p><code>entry</code>  是单入口， <code>output</code>  可通过修改参数 <code>path</code>  和 <code>filename</code> 。</p>
<p><img src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220123115954930.png" alt="image-20220123115954930"></p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"path"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  entry<span class="token operator">:</span> <span class="token string">"./src/index.js"</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">"dist"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">"index.js"</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220123120101990.png" alt="image-20220123120101990"></p>
<p><code>entry</code>  是多入口， <code>output</code>  的 <code>filename</code>  需要用 [ <code>name</code> ] 占位符，用来指定打包后的名称，对应的是 <code>entry</code>  中的 <code>key(键名)</code></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"path"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  entry<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    index<span class="token operator">:</span> <span class="token string">"./src/index.js"</span><span class="token punctuation">,</span>
    app<span class="token operator">:</span> <span class="token string">"./src/app.js"</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">"dist"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">"[name].js"</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="mode"><a class="markdownIt-Anchor" href="#mode">#</a>  <code>mode</code></h4>
<p>可设置为 <code>development</code> 、 <code>production</code> 、 <code>none</code> ，默认是 <code>production</code> 。</p>
<ul>
<li><code>development</code> ：开发环境，设置 <code>process.env.NODE_ENV</code>  的值为 <code>development</code> 。开启 <code>NamedChunksPlugin</code>  和 <code>NamedModulesPlugin</code></li>
<li><code>production</code> ：生产环境，设置 <code>process.env.NODE_ENV</code>  的值为 <code>production</code> 。开启 <code>FlagDependencyUsagePlugin</code> ， <code>FlagIncludedChunksPlugin</code> ， <code>ModuleConcatenationPlugin</code> ， <code>NoEmitonErrorsPlugin</code> ， <code>OccurrenceOrderPlugin</code> ， <code>SideEffectsFlagPlugin</code>  和 <code>TerserPlugin</code></li>
<li><code>none</code> ：不开启任何优化选项</li>
</ul>
<p><img src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220123105612482.png" alt="image-20220123105612482"></p>
<blockquote>
<p>ps:</p>
<p><code>development</code>  模式下开启的两个插件在代码热更新阶段，会在控制台打印出哪个模块发生了热更新，这个模块的路径是啥。</p>
<p><code>production</code>  模式下开启的插件会在压缩代码。(所以一般我们用开发模式，不然打完包后看的很麻烦)</p>
</blockquote>
<h4 id="loaders翻译官"><a class="markdownIt-Anchor" href="#loaders翻译官">#</a>  <code>loaders(翻译官)</code></h4>
<p><strong> <code>webpack</code>  只支持 <code>js</code>  和 <code>json</code>  两种文件类型， <code>loader</code>  的作用就是用来处理其他的文件，并将它们添加到依赖图中。</strong></p>
<p><code>loader</code>  是个函数，接收源文件作为参数，返回转换后的结果。</p>
<p>一般 <code>loader</code>  命名的方式都是以 <code>-loader</code>  为后缀，比如 <code>css-loader</code> 、 <code>babel-loader</code> 。</p>
<p><code>test</code>  是指定匹配的规则， <code>use</code>  是指定使用 <code>loader</code>  的名称</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.less$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"style-loader"</span><span class="token punctuation">,</span> <span class="token string">"css-loader"</span><span class="token punctuation">,</span> <span class="token string">"less-loader"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>一个 <code>loader</code>  一般只做一件事，在解析 <code>less</code>  时，需要用 <code>less-loader</code>  将 <code>less</code>  转成 <code>css</code> ，由于 <code>webpack</code>  不能识别 <code>css</code> ，又需要用 <code>css-loader</code>  将 <code>css</code>  转换成 <code>commonjs</code>  对象放到 <code>js</code>  中，最后需要用 <code>style-loader</code>  将 <code>css</code>  插入到页面的 <code>style</code>  中。</p>
<blockquote>
<p>ps:  <code>loader</code>  的组合通常由两种方式，一种是从左到右（类似 <code>unix</code>  的 <code>pipe</code> ），另一种是从右到左（ <code>compose</code> ）。 <code>webpack</code>  选择的是 <code>compose</code> ，从右到左一次执行 <code>loader</code></p>
</blockquote>
<blockquote>
<p>loader 需要先下载，然后再可以用</p>
</blockquote>
<h4 id="plugins"><a class="markdownIt-Anchor" href="#plugins">#</a>  <code>plugins</code></h4>
<p><strong>任何 <code>loader</code>  没法做的事情，都可以用 <code>plugin</code>  解决，它主要用于文件优化、资源管理、环境变量注入，作用于整个构建过程。</strong></p>
<p>一般 <code>plugin</code>  命名的方式是以 <code>-webpack-plugin</code>  为后缀结尾，也有是以 <code>-plugin</code>  为后缀结尾的。</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> CleanWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"clean-webpack-plugin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>插件需要先下载，然后引入到 webpack.package.js 文件中，然后再可以用</p>
</blockquote>
<hr>
<h2 id="webpack资源解析"><a class="markdownIt-Anchor" href="#webpack资源解析">#</a>  <code>webpack</code>  资源解析</h2>
<h3 id="解析es6"><a class="markdownIt-Anchor" href="#解析es6">#</a> 解析 <code>es6</code></h3>
<p>需要安装 <code>@babel/core</code> ， <code>@babel/preset-env</code> ， <code>babel-loader</code></p>
<p>在根目录下面新建 <code>.babelrc</code>  文件，将 <code>@babel/preset-env</code>  添加到 <code>presets</code>  中</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"presets"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"@babel/preset-env"</span><span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><code>webpack</code>  中配置 <code>babel-loader</code></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token string">"babel-loader"</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>还有一种配置的方式，不使用 <code>.babelrc</code>  文件，将它配置在 <code>use</code>  的参数 <code>options</code>  中</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          loader<span class="token operator">:</span> <span class="token string">"babel-loader"</span><span class="token punctuation">,</span>
          options<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"@babel/preset-env"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="解析css"><a class="markdownIt-Anchor" href="#解析css">#</a> 解析 <code>css</code></h3>
<p>需要安装 <code>css-loader</code>  和 <code>style-loader</code> 。</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  moudle<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"style-loader"</span><span class="token punctuation">,</span> <span class="token string">"css-loader"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>注意 test 里写的是正则表达式，用来匹配哪个文件的</p>
</blockquote>
<h3 id="解析less"><a class="markdownIt-Anchor" href="#解析less">#</a> 解析 <code>less</code></h3>
<p>需要安装 <code>less-loader</code> ， <code>css-loader</code> ， <code>style-loader</code></p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.less$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"style-loader"</span><span class="token punctuation">,</span> <span class="token string">"css-loader"</span><span class="token punctuation">,</span> <span class="token string">"less-loader"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="解析图片和字体"><a class="markdownIt-Anchor" href="#解析图片和字体">#</a> 解析图片和字体</h3>
<p>需要安装 <code>file-loader</code></p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.(png|jpeg|jpg|gif)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"file-loader"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.(woff|woff2|eot|ttf|otf)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"file-loader"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="url-loader"><a class="markdownIt-Anchor" href="#url-loader">#</a>  <code>url-loader</code></h3>
<p><code>url-loader</code>  可以将较小的图片转换成 <code>base64</code> 。</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.(png|jpeg|jpg|gif)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          loader<span class="token operator">:</span> <span class="token string">"url-loader"</span><span class="token punctuation">,</span>
          options<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            limit<span class="token operator">:</span> <span class="token number">10240</span><span class="token punctuation">,</span> <span class="token comment">// 小于 10k 图片，webpack 在打包时自动转成 base64,</span>
              <span class="token comment">//(也就是10*1024bytes)</span>
          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>base64 在客户端本地解码所以会减少服务器压力，如果图片过大还继续采用 base64 编码会导致 cpu 调用率上升网页加载时变卡，所以设这个让小图片被 base64 处理会被变成对应的字符串，这字符串就代表了这个图片</p>
</blockquote>
<h3 id="配置vue"><a class="markdownIt-Anchor" href="#配置vue">#</a> 配置 <code>vue</code></h3>
<p>配置 <code>vue</code>  开发环境，需要安装 <code>vue</code> ， <code>vue-loader</code> ， <code>vue-template-compiler</code></p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">&#123;</span> VueLoaderPlugin <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"vue-loader"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>export <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">VueLoaderPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.vue$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token string">"vue-loader"</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>ps: 这里使用的 <code>vue-loader</code>  是 <code>15.x</code>  版本，我安装最新的版本 <code>16.x</code>  有问题，一直没有解决。</p>
</blockquote>
<h3 id="配置react"><a class="markdownIt-Anchor" href="#配置react">#</a> 配置 <code>react</code></h3>
<p>配置 <code>react</code>  开发环境需要安装 <code>react</code> ， <code>react-dom</code> ， <code>@babel/preset-react</code></p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          loader<span class="token operator">:</span> <span class="token string">"babel-loader"</span><span class="token punctuation">,</span>
          options<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"@babel/preset-env"</span><span class="token punctuation">,</span> <span class="token string">"@babel/preset-react"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h2 id="webpack文件监听及热更新"><a class="markdownIt-Anchor" href="#webpack文件监听及热更新">#</a>  <code>webpack</code>  文件监听及热更新</h2>
<h3 id="文件监听"><a class="markdownIt-Anchor" href="#文件监听">#</a> 文件监听</h3>
<p>每次修改代码后，都需要手动构建，影响开发效率。 <code>webpack</code>  提供了文件监听的作用。开启监听时， <code>webpack</code>  会调用 <code>node</code>  中 <code>fs</code>  模块来判断文件是否发生变化，如果发生了变化，自动重新构建输出新的文件。</p>
<p><code>webpack</code>  开启监听模式，有两种方式：（需要手动刷新浏览器）</p>
<ul>
<li>启动 <code>webpack</code>  命令时，带上 <code>--watch</code>  参数</li>
</ul>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
 <span class="token property">"watch"</span><span class="token operator">:</span> <span class="token string">"webpack --watch"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<ul>
<li><code>webpack.config.js</code>  中设置 <code>watch: true</code></li>
</ul>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  watch<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="文件监听分析"><a class="markdownIt-Anchor" href="#文件监听分析">#</a> 文件监听分析</h3>
<p><code>webpack</code>  文件监听判断依据是看文件的最后编辑时间是否发生变化。</p>
<p>它会将修改的时间保存起来，当文件修改时，它会和上一次的修改时间进行比对。</p>
<p>如果发现不一致，它并不会马上告诉监听者，而是先把文件的修改缓存起来，等待一段时间，如果这段时间内还有其他文件发生变化，它就会把这段时间内的文件列表一起构建。这个等待的时间就是 <code>aggregateTimeout</code> 。</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  watch<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  watchOptions<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    ignored<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    aggregateTimeout： <span class="token number">300</span><span class="token punctuation">,</span>
    poll<span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li><code>watch</code> ：默认为 <code>false</code></li>
<li><code>watchOptions</code> ：只有 <code>watch</code>  为 <code>true</code>  时，才生效
<ul>
<li><code>ignored</code> ：需要忽略监听的文件或者文件夹，默认为空，忽略 <code>node——modules</code>  性能会有所提升。</li>
<li><code>aggregateTimeout</code> ：监听到文件变化后，等待的时间，默认 <code>300ms</code></li>
<li><code>poll</code> ：轮询时间， <code>1s</code>  一次</li>
</ul>
</li>
</ul>
<h3 id="热更新"><a class="markdownIt-Anchor" href="#热更新">#</a> 热更新</h3>
<p>热更新需要 <code>webpack-dev-server</code>  和 <code>HotModuleReplacementPlugin</code>  两个插件背后使用。</p>
<p><strong>与 <code>watch</code>  相比，它不输出文件，直接方式内存中，所以它的构建熟读更快。</strong></p>
<p><img src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220123181703853.png" alt="image-20220123181703853"></p>
<p>热更新在开发模式中才会使用。</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"webpack"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"path"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  mode<span class="token operator">:</span> <span class="token string">"development"</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>HotModuleReplacementPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  devServer<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    contentBase<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">"dist"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    hot<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>在 <code>package.json</code>  中配置命令</p>
<pre class="line-numbers language-none"><code class="language-none">webpack4.x
&quot;scripts&quot;: &#123;
  &quot;dev&quot;: &quot;webpack-dev-server --open&quot;
&#125;
webpack5.x
&quot;scripts&quot;: &#123;
  &quot;dev&quot;: &quot;webpack server&quot;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>ps:  <code>webpack5.x</code>  和 <code>webpack-dev-server</code>  有冲突，不能使用 <code>--open</code>  打开浏览器。</p>
</blockquote>
<h3 id="hotmodulereplacementplugin"><a class="markdownIt-Anchor" href="#hotmodulereplacementplugin">#</a>  <code>HotModuleReplacementPlugin</code></h3>
<p>热更新的核心是 <code>HMR Server</code>  和 <code>HMR Runtime</code> 。</p>
<ul>
<li><code>HMR Server</code> ：是服务端，用来将变化的 <code>js</code>  模块通过 <code>websocket</code>  的消息通知给浏览器端</li>
<li><code>HMR Runtime</code> ：是浏览器端，用于接收 <code>HMR Server</code>  传递过来的模块数据，浏览器端可以看到 <code>.hot-update.json</code>  文件</li>
</ul>
<p><code>hot-module-replacement-plugin</code>  的作用： <code>webpack</code>  本身构建出来的 <code>bundle.js</code>  本身是不具备热更新的， <code>HotModuleReplacementPlugin</code>  的作用就是 <code>HMR Runtime</code>  注入到 <code>bundle.js</code> ，使得 <code>bundle.js</code>  可以和 <code>HMR Server</code>  建立 <code>websocket</code>  的通信能力。一旦磁盘里的文件发生修改，那么 <code>HMR Server</code>  将有修改的 <code>js</code>  模块通过 <code>websocket</code>  发送给 <code>HMR Runtime</code> ，然后 <code>HMR Runtime</code>  去局部更新页面的代码，这种方法不会刷新浏览器。</p>
<p><code>webpack-dev-server</code>  的作用：提供 <code>bundle server</code>  的能力，就是生成的 <code>bundle.js</code>  可以通过 <code>localhost://xxx</code>  的方式去访问，另外也提供 <code>livereload</code> （浏览器自动刷新）。</p>
<hr>
<h2 id="文件指纹"><a class="markdownIt-Anchor" href="#文件指纹">#</a> 文件指纹</h2>
<h3 id="什么是文件指纹"><a class="markdownIt-Anchor" href="#什么是文件指纹">#</a> 什么是文件指纹</h3>
<p>文件指纹是指打包后输出的文件名的后缀。比如： <code>index_56d51795.js</code> 。</p>
<p>通常用于用于版本管理</p>
<h3 id="文件指纹类型"><a class="markdownIt-Anchor" href="#文件指纹类型">#</a> 文件指纹类型</h3>
<ul>
<li><code>hash</code> : 和项目的构建相关，只要项目文件改变，构建项目的 <code>hash</code>  值就会改变。采用 <code>hash</code>  计算的话，每一次构建后的哈希值都不一样，假如说文件内容没有发生变化，那这样子是没法实现缓存的。</li>
<li><code>chunkhash</code> ：和 <code>webpack</code>  打包的 <code>chunk</code>  有关，不同的 <code>entry</code>  会生成不同的 <code>chunkhash</code> 。生产环境会将一些公共库和源码分开来，单独用 <code>chunkhash</code>  构建，只要不改变公共库的代码，它的哈希值就不会变，就可以实现缓存。</li>
<li><code>contenthash</code> ：根据文件内容来定义 <code>hash</code> ，文件内容不变，则 <code>contenthash</code>  不变。一般用于 <code>css</code>  资源，如果 <code>css</code>  资源使用 <code>chunkhash</code> ，那么修改了 <code>js</code> ， <code>css</code>  资源就会变化，缓存就会失效，所以 <code>css</code>  使用 <code>contenthash</code> 。</li>
</ul>
<blockquote>
<p>ps:</p>
<ol>
<li>使用 <code>hash</code>  的场景要结合 <code>mode</code>  来考虑，如果 <code>mode</code>  是 <code>development</code> ，在使用 <code>HMR</code>  情况下，使用 <code>chunkhash</code>  是不适合的，应该使用 <code>hash</code> 。而 <code>mode</code>  是 <code>production</code>  时，应该用 <code>chunkhash</code> 。</li>
<li><code>js</code>  使用 <code>chunkhash</code>  是便于寻找资源，因为 <code>js</code>  的资源关联度更高。 <code>css</code>  使用 <code>contenthash</code>  是因为 <code>css</code>  一般是根据不同的页面书写的， <code>css</code>  资源之间的关联度不高，也就不用在其他资源修改时，重新更新 <code>css</code> 。</li>
</ol>
</blockquote>
<h3 id="js文件指纹"><a class="markdownIt-Anchor" href="#js文件指纹">#</a>  <code>js</code>  文件指纹</h3>
<p>设置 <code>output</code>  的 <code>filename</code> ，使用 <code>[chunkhash]</code> ，</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"path"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  output<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">"dist"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">"[name]_[chunkhash:8].js"</span><span class="token punctuation">,</span> <span class="token comment">// 取 hash 的前 8位</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="css文件指纹"><a class="markdownIt-Anchor" href="#css文件指纹">#</a>  <code>css</code>  文件指纹</h3>
<p>需要安装 <code>mini-css-extract-plugin</code></p>
<p><code>style-loader</code>  是将 <code>css</code>  插入到页面的 <code>head</code>  中， <code>mini-css-extract-plugin</code>  是提取为单独的文件，它们之间是互斥的。</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"mini-css-extract-plugin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span> <span class="token string">"css-loader"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
      filename<span class="token operator">:</span> <span class="token string">"[name]_[contenthash:8].css"</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="图片文件指纹"><a class="markdownIt-Anchor" href="#图片文件指纹">#</a> 图片文件指纹</h3>
<p>需要安装 <code>file-loader</code></p>
<table>
<thead>
<tr>
<th style="text-align:center">占位符名称</th>
<th style="text-align:center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>[ext]</code></td>
<td style="text-align:center">资源后缀名</td>
</tr>
<tr>
<td style="text-align:center"><code>[name]</code></td>
<td style="text-align:center">文件名称</td>
</tr>
<tr>
<td style="text-align:center"><code>[path]</code></td>
<td style="text-align:center">文件的相对路径</td>
</tr>
<tr>
<td style="text-align:center"><code>[folder]</code></td>
<td style="text-align:center">文件所在的文件夹</td>
</tr>
<tr>
<td style="text-align:center"><code>[contenthash]</code></td>
<td style="text-align:center">文件内容的 <code>hash</code> ，默认是 <code>md5</code></td>
</tr>
<tr>
<td style="text-align:center"><code>[hash]</code></td>
<td style="text-align:center">文件内容的 <code>hash</code> ，默认是 <code>md5</code></td>
</tr>
<tr>
<td style="text-align:center"><code>[emoji]</code></td>
<td style="text-align:center">一个随机的指代文件内容的 <code>emoji</code></td>
</tr>
</tbody>
</table>
<p>图片的 <code>hash</code>  和 <code>css/js</code>  的 <code>hash</code>  概念不一样，图片的 <code>hash</code>  是有图片的内容决定的。</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.(png|jpeg|jpg|gif)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          loader<span class="token operator">:</span> <span class="token string">"file-loader"</span><span class="token punctuation">,</span>
          options<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            filename<span class="token operator">:</span> <span class="token string">"[folder]/[name]_[hash:8].[ext]"</span><span class="token punctuation">,</span>
          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#123;</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.(woff|woff2|eot|ttf|otf)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">&#123;</span>
            loader<span class="token operator">:</span> <span class="token string">"file-loader"</span><span class="token punctuation">,</span>
            options<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
              filename<span class="token operator">:</span> <span class="token string">"[name]_[hash:8].[ext]"</span><span class="token punctuation">,</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h2 id="代码压缩"><a class="markdownIt-Anchor" href="#代码压缩">#</a> 代码压缩</h2>
<p>代码压缩主要分为 <code>js</code>  压缩， <code>css</code>  压缩， <code>html</code>  压缩。</p>
<h3 id="js压缩"><a class="markdownIt-Anchor" href="#js压缩">#</a>  <code>js</code>  压缩</h3>
<p><code>webpack</code>  内置了 <code>uglifyjs-webpack-plugin</code>  插件，默认打包后的文件都是压缩过的，这里无需额外配置。</p>
<p>可以手动安装这个插件，可以额外设置一下配置，比如开启并行压缩，需要将 <code>parallel</code>  设置为 <code>true</code></p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> UglifyjsWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"uglifyjs-webpack-plugin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  optimization<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    minimizer<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token keyword">new</span> <span class="token class-name">UglifyjsWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
        parallel<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="css压缩"><a class="markdownIt-Anchor" href="#css压缩">#</a>  <code>css</code>  压缩</h3>
<p>安装 <code>optimize-css-webpack-plugin</code> ，同时安装 <code>css</code>  预处理器 <code>cssnano</code> 。</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> OptimizeCssWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"optimize-css-webpack-plugin"</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">OptimizeCssWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
      assetNameRegExp<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span>
      cssProcessor<span class="token operator">:</span> <span class="token function">require</span><span class="token punctuation">(</span>"cssnano<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="html压缩"><a class="markdownIt-Anchor" href="#html压缩">#</a>  <code>html</code>  压缩</h3>
<p>需要安装 <code>html-webpack-plugin</code> ，通过设置压缩参数。</p>
<blockquote>
<p>ps: 多页面应用需要写多个 <code>new HtmlWebpackPlugin(&#123;...&#125;)</code></p>
</blockquote>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"html-webpack-plugin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"path"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
     template<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">"src/search.html"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token comment">//html 模版所在的位置，模版里面可以使用 ejs 的语法</span>
      filename<span class="token operator">:</span> <span class="token string">"search.html"</span><span class="token punctuation">,</span>              <span class="token comment">// 打包出来后的 html 名称</span>
      chunks<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"search"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>           <span class="token comment">// 打包出来后的 html 要使用那些 chunk</span>
      inject<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                <span class="token comment">// 设置为 true，打包后的 js css 会自动注入到 HTML 中</span>
      minify<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        html5<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        collapseWhitespace<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        preserveLineBreaks<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        minifyCSS<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        minifyJS<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        removeComments<span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token operator">...</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>HtmlWebpackPlugin</code>  参数 <code>minify</code>  里面的 <code>minifyJS</code>  和 <code>minifyCSS</code>  的作用是用于压缩一开始就内联在 <code>html</code>  里的 <code>js</code> （不能使用 <code>ES6</code>  语法）和 <code>css</code> 。</p>
<p><code>chunks</code>  对应的是 <code>entry</code>  中的 <code>key</code> 。你希望哪个 <code>chunk</code>  自动注入，就将哪个 <code>chunk</code>  写到 <code>chunks</code> 。</p>
<p><code>chunk</code> 、 <code>bundle</code> 、 <code>module</code>  区别：</p>
<ul>
<li><code>chunk</code> ：每个 <code>chunk</code>  是又多个 <code>module</code>  组成，可以通过代码分割成多个 <code>chunk</code></li>
<li><code>bundle</code> ：打包生成的最终文件</li>
<li><code>module</code> ： <code>webpack</code>  中的模块（ <code>js</code> 、 <code>css</code> 、图片）</li>
</ul>
<blockquote>
<p>注意这里生成的 html 文件会自动帮你导入需要的 js 文件模块 (比如说 bundle.js), 也就是我们在上面 output 写的 js 打完包的文件</p>
</blockquote>
<hr>
<h2 id="自动清理构建目录"><a class="markdownIt-Anchor" href="#自动清理构建目录">#</a> 自动清理构建目录</h2>
<p>每次在构建的时候，会产生新的文件，造成输出目录 <code>output</code>  文件越来越多。</p>
<p>最常见的清理方法用命令 <code>rm</code>  去删除，在打包之前先执行 <code>rm -rf</code>  命令将 <code>dist</code>  目录删除，在进行打包。</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
  <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"rm -rf ./dist &amp;&amp; webpack"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>另一种是使用 <code>rimraf</code>  进行删除。</p>
<p>安装 <code>rimraf</code> ，使用时也是先在打包前先将 <code>dist</code>  目录进行删除，然后在打包。</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
  <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"rimraf ./dist &amp;&amp; webpack"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>这两种方案虽然都能将 <code>dist</code>  目录清空，但不太优雅。</p>
<p><code>webpack</code>  提供 <code>clean-webpack-plugin</code> ，它会自动清理 <code>output.path</code>  下的文件。</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">&#123;</span> CleanWebpackPlugin <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"clean-webpack-plugin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h2 id="自动补齐样式前缀"><a class="markdownIt-Anchor" href="#自动补齐样式前缀">#</a> 自动补齐样式前缀</h2>
<p>不同的浏览器厂商在实现 <code>css</code>  特性的标准没有完全统一，比如 <code>display: flex</code> ，在 <code>webkit</code>  内核中要写成 <code>display: -webkit-box</code> 。</p>
<p>在开发的时候一个个加上内核，将是一个巨大的工程。</p>
<p>在 <code>webpack</code>  中可以用 <code>loader</code>  去解决自动补齐 <code>css</code>  前缀的问题。</p>
<p>安装 <code>postcss-loader</code> ，以及它的插件 <code>autoprefixer</code> 。</p>
<p><code>autoprefixer</code>  是根据 <code>can i use</code>  这个网站提供的 <code>css</code>  兼容性进行不全前缀的。</p>
<p><code>autoprefixer</code>  是后置处理器，它和预处理器不同，预处理器是在打包的时候处理，而 <code>autoprefixer</code>  是在代码处理好之后，样式已经生成了再进行处理。</p>
<p>在 <code>webpack4.x</code>  中安装 <code>postcss-loader@3.0.0</code> ， <code>autoprefixer@9.5.1</code> 。</p>
<p><strong>方式一：</strong> 直接在 <code>webpack.config.js</code>  中配置</p>
<p><code>webpack.config.js</code> ：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"mini-css-extract-plugin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.less$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>
          MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span>
          <span class="token string">"css-loader"</span><span class="token punctuation">,</span>
          <span class="token string">"less-loader"</span><span class="token punctuation">,</span>
          <span class="token punctuation">&#123;</span>
            loader<span class="token operator">:</span> <span class="token string">"postcss-loader"</span><span class="token punctuation">,</span>
            options<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
              <span class="token function-variable function">plugins</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">[</span>
                <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"autoprefixer"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
                  overrideBrowserslist<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"last 2 version"</span><span class="token punctuation">,</span> <span class="token string">">1%"</span><span class="token punctuation">,</span> <span class="token string">"ios 7"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//最新的两个版本，用户大于1%，且兼容到 ios7</span>
                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>方式二：</strong> 利用 <code>postcss</code>  配置文件 <code>postcss.config.js</code> ， <code>webpack.config.js</code>  直接写 <code>postcss-loader</code>  即可。</p>
<p><code>webpack.config.js</code> ：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"mini-css-extract-plugin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.less$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>
          MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span>
          <span class="token string">"css-loader"</span><span class="token punctuation">,</span>
          <span class="token string">"less-loader"</span><span class="token punctuation">,</span>
          <span class="token string">"postcss-loader"</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>postcss.config.js</code> ：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"autoprefixer"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
      overrideBrowserslist<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"last 2 version"</span><span class="token punctuation">,</span> <span class="token string">">1%"</span><span class="token punctuation">,</span> <span class="token string">"ios 7"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>方法三：</strong> 浏览器的兼容性可以写 <code>package.json</code>  中， <code>postcss.config.js</code>  中只需加载 <code>autofixer</code>  即可。</p>
<p><code>webpack.config.js</code> ：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"mini-css-extract-plugin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.less$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>
          MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span>
          <span class="token string">"css-loader"</span><span class="token punctuation">,</span>
          <span class="token string">"less-loader"</span><span class="token punctuation">,</span>
          <span class="token string">"postcss-loader"</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>postcss.config.js</code> ：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"autofixer"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><code>package.json</code> ：</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"browserslist"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
  <span class="token string">"last 2 version"</span><span class="token punctuation">,</span>
  <span class="token string">"> 1%"</span><span class="token punctuation">,</span>
  <span class="token string">"ios 7"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h2 id="资源内联"><a class="markdownIt-Anchor" href="#资源内联">#</a> 资源内联</h2>
<p>在一些场景中需要使用到资源内联，常见的有：</p>
<ol>
<li>页面框架的初始化脚本</li>
<li>减少 <code>http</code>  网络请求，将一些小的图片变成 <code>base64</code>  内容到代码中，较少请求</li>
<li><code>css</code>  内联增加页面体验</li>
<li>尽早执行的 <code>js</code> ，比如 <code>REM</code>  方案</li>
</ol>
<h3 id="html内联"><a class="markdownIt-Anchor" href="#html内联">#</a>  <code>html</code>  内联</h3>
<p>在多页面项目中， <code>head</code>  中有很多公用的标签，比如 <code>meta</code> ，想要提升维护性，会将它提取成一个模版，然后引用进来。</p>
<p>安装 <code>raw-loader@0.5.1</code></p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
  $&#123;require("raw-loader!./meta.html")&#125;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="js内联"><a class="markdownIt-Anchor" href="#js内联">#</a>  <code>js</code>  内联</h3>
<p>在 <code>REM</code>  方案中，需要尽早的 <code>html</code>  标签的 <code>font-size</code> ，那么这段 <code>js</code>  就要尽早的加载、执行。</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span>
    $&#123;require('raw-loader!babel-loader!./calc-root-fontsize.js')&#125;
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="css内联"><a class="markdownIt-Anchor" href="#css内联">#</a>  <code>css</code>  内联</h3>
<p>为了更好的体验，避免页面闪动，需要将打包好的 <code>css</code>  内联到 <code>head</code>  中。</p>
<p>安装 <code>html-inline-css-webpack-plugin</code> ，这个插件需要放在 <code>html-webpack-plugin</code>  后面。</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"mini-css-extract-plugin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"html-webpack-plugin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> HtmlInlineCssWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"html-inline-css-webpack-plugin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span> <span class="token string">"css-loader"</span><span class="token punctuation">,</span> <span class="token string">"less-loader"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
      filename<span class="token operator">:</span> <span class="token string">"[name]_[contenthash:8].css"</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlInlineCssWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>需要先将 <code>css</code>  提取成单独的文件才行。</p>
<blockquote>
<p>ps:  <code>style-laoder</code>  和 <code>html-inline-css-webpack-plugin</code>  的区别是：</p>
<ul>
<li><code>style-loader</code> ：插入样式是一个动态的过程，打包后的源码不会有 <code>style</code>  标签，在执行的时候通过 <code>js</code>  动态插入 <code>style</code>  标签</li>
<li><code>html-inline-css-webpack-plugin</code> ：是在构建的时候将 <code>css</code>  插入到页面的 <code>style</code>  标签中</li>
</ul>
</blockquote>
<hr>
<h2 id="多页面应用"><a class="markdownIt-Anchor" href="#多页面应用">#</a> 多页面应用</h2>
<p>每个页面对应一个 <code>entry</code> ，同时对应 <code>plugins</code>  中一个 <code>html-webpack-plugin</code> 。</p>
<p>这种方式有个缺点，每个增加一个 <code>entry</code>  就要增加一个 <code>html-webpack-plguin</code> 。</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"html-webpack-plugin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  entry<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    index<span class="token operator">:</span> <span class="token string">"./src/index.js"</span><span class="token punctuation">,</span>
    search<span class="token operator">:</span> <span class="token string">"./src/search.js"</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> template<span class="token operator">:</span> <span class="token string">"./src/index.html"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> template<span class="token operator">:</span> <span class="token string">"./src/search.html"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>借助 <code>glob</code>  可以实现通用化的配置方式。</p>
<p>安装 <code>glob</code> ，同时所有的页面都要放在 <code>src</code>  下面，并且入口文件都要叫做 <code>index.js</code> 。</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"path"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> glob <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"glob"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"html-webpack-plugin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">setMPA</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> entry <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> htmlWebpackPlugins <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> entryFiles <span class="token operator">=</span> glob<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">"./src/*/index.js"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  entryFiles<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">entryFile</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> match <span class="token operator">=</span> entryFile<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">src\/(.*)\/index\.js</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> pageName <span class="token operator">=</span> match <span class="token operator">&amp;&amp;</span> match<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    entry<span class="token punctuation">[</span>pageName<span class="token punctuation">]</span> <span class="token operator">=</span> entryFile<span class="token punctuation">;</span>
    htmlWebpackPlugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
      <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
        template<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">src/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>pageName<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/index.html</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        filename<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>pageName<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">.html</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
        chunks<span class="token operator">:</span> <span class="token punctuation">[</span>pageName<span class="token punctuation">]</span><span class="token punctuation">,</span>
        inject<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        minify<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          html5<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          collapseWhitespace<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          preserveLineBreaks<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
          minifyCSS<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          minifyJS<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          removeComments<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">&#123;</span>
    entry<span class="token punctuation">,</span>
    htmlWebpackPlugins<span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">&#123;</span> entry<span class="token punctuation">,</span> htmlWebpackPlugins <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">setMPA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  entry<span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>htmlWebpackPlugins<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h2 id="sourcemap使用方法"><a class="markdownIt-Anchor" href="#sourcemap使用方法">#</a>  <code>sourceMap</code>  使用方法</h2>
<p>发布到生成环境中的代码，要将代码进行压缩混淆，但是在压缩混淆之后，看代码就像在看天书一样。</p>
<p><code>sourceMap</code>  提供了压缩后的代码和源代码之间的映射关系。</p>
<p><code>sourceMap</code>  在开发环境开启，线上环境中关闭，在线上排查问题时将 <code>source map</code>  上传到错误监控系统。</p>
<h3 id="source-map关键字"><a class="markdownIt-Anchor" href="#source-map关键字">#</a>  <code>source map</code>  关键字</h3>
<ul>
<li><code>eval</code> ：使用 <code>eval</code>  包裹模块代码</li>
<li><code>source map</code> ：产生 <code>map</code>  文件</li>
<li><code>cheap</code> ：不包含列信息</li>
<li><code>inline</code> ：将 <code>.map</code>  作为 <code>DataURI</code>  嵌入，不单独生成 <code>.map</code>  文件</li>
<li><code>module</code> ：包含 <code>loader</code>  的 <code>sourcemap</code></li>
</ul>
<h3 id="source-map类型"><a class="markdownIt-Anchor" href="#source-map类型">#</a>  <code>source map</code>  类型</h3>
<table>
<thead>
<tr>
<th style="text-align:center">devtool</th>
<th style="text-align:center">首次构建</th>
<th style="text-align:center">二次构建</th>
<th style="text-align:center">是否适合生产环境</th>
<th style="text-align:center">可以定位的代码</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>(none)</code></td>
<td style="text-align:center">+++</td>
<td style="text-align:center">+++</td>
<td style="text-align:center">yes</td>
<td style="text-align:center">最终输出的代码</td>
</tr>
<tr>
<td style="text-align:center"><code>eval</code></td>
<td style="text-align:center">+++</td>
<td style="text-align:center">+++</td>
<td style="text-align:center">no</td>
<td style="text-align:center"><code>webpack</code>  生成的代码 (一个个的模块)</td>
</tr>
<tr>
<td style="text-align:center"><code>cheap-eval-source-map</code></td>
<td style="text-align:center">+</td>
<td style="text-align:center">++</td>
<td style="text-align:center">no</td>
<td style="text-align:center">经过 loader 转换后的代码 (只能看到行)</td>
</tr>
<tr>
<td style="text-align:center"><code>cheap-module-eval-source-map</code></td>
<td style="text-align:center">o</td>
<td style="text-align:center">++</td>
<td style="text-align:center">no</td>
<td style="text-align:center">源代码 (只能看到行)</td>
</tr>
<tr>
<td style="text-align:center"><code>eval-source-map</code></td>
<td style="text-align:center">–</td>
<td style="text-align:center">+</td>
<td style="text-align:center">no</td>
<td style="text-align:center">源代码</td>
</tr>
<tr>
<td style="text-align:center"><code>cheap-source-map</code></td>
<td style="text-align:center">+</td>
<td style="text-align:center">o</td>
<td style="text-align:center">yes</td>
<td style="text-align:center">经过 <code>loader</code>  转换后的代码只能看到行)</td>
</tr>
<tr>
<td style="text-align:center"><code>cheap-module-source-map</code></td>
<td style="text-align:center">o</td>
<td style="text-align:center">-</td>
<td style="text-align:center">yes</td>
<td style="text-align:center">源代码 (只能看到行)</td>
</tr>
<tr>
<td style="text-align:center"><code>inline-cheap-source-map</code></td>
<td style="text-align:center">+</td>
<td style="text-align:center">-</td>
<td style="text-align:center">no</td>
<td style="text-align:center">经过 <code>loader</code>  转换后的代码 (只能看到行)</td>
</tr>
<tr>
<td style="text-align:center"><code>inline-cheap-module-source-map</code></td>
<td style="text-align:center">o</td>
<td style="text-align:center">-</td>
<td style="text-align:center">no</td>
<td style="text-align:center">源代码 (只能看到行)</td>
</tr>
<tr>
<td style="text-align:center"><code>source-map</code></td>
<td style="text-align:center">–</td>
<td style="text-align:center">–</td>
<td style="text-align:center">yes</td>
<td style="text-align:center">源代码</td>
</tr>
<tr>
<td style="text-align:center"><code>Inline-source-map</code></td>
<td style="text-align:center">–</td>
<td style="text-align:center">–</td>
<td style="text-align:center">no</td>
<td style="text-align:center">源代码</td>
</tr>
<tr>
<td style="text-align:center"><code>hidden-source- map</code></td>
<td style="text-align:center">–</td>
<td style="text-align:center">–</td>
<td style="text-align:center">yes</td>
<td style="text-align:center">源代码</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="提取页面公共资源"><a class="markdownIt-Anchor" href="#提取页面公共资源">#</a> 提取页面公共资源</h2>
<p>在项目中，多个页面中都会使用到一些基础库，比如 <code>react</code> 、 <code>react-dom</code> ，还有一写公共的代码，当在打包时这些都会被打包进最终的代码中，这是比较浪费的，而且打包后的体积也比较大。</p>
<p><code>webpack4</code>  内置了 <code>SplitChunksPlugin</code>  插件。</p>
<p><code>chunks</code>  参数说明：</p>
<ul>
<li><code>async</code>  异步引入的库进行分离（默认）</li>
<li><code>initial</code>  同步引入的库进行分离</li>
<li><code>all</code>  所有引入的库进行分离（推荐）</li>
</ul>
<p>抽离出基础库的名称 <code>cacheGroups</code>  里中的 <code>filename</code>  放到 <code>html-webpack-plugin</code>  中 <code>chunks</code>  中，会自动导入：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
        chunks<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"vendors"</span><span class="token punctuation">,</span> <span class="token string">"commons"</span><span class="token punctuation">,</span> <span class="token string">"index"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//打包出来后的 html 要使用那些 chunk</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  optimization<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    splitChunks<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      chunks<span class="token operator">:</span> <span class="token string">"async"</span><span class="token punctuation">,</span>
      minSize<span class="token operator">:</span> <span class="token number">30000</span><span class="token punctuation">,</span> <span class="token comment">// 抽离的公共包最小的大小，单位字节</span>
      maxSize<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 最大的大小</span>
      minChunks<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 资源使用的次数(在多个页面使用到)， 大于1， 最小使用次数</span>
      maxAsyncRequests<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token comment">// 并发请求的数量</span>
      maxInitialRequests<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token comment">// 入口文件做代码分割最多能分成3个js文件</span>
      automaticNameDelimiter<span class="token operator">:</span> <span class="token string">"~"</span><span class="token punctuation">,</span> <span class="token comment">// 文件生成时的连接符</span>
      automaticNameMaxLength<span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token comment">// 自动自动命名最大长度</span>
      name<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//让cacheGroups里设置的名字有效</span>
      cacheGroups<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//当打包同步代码时,上面的参数生效</span>
        vendors<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\/]node_modules[\\/]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token comment">//检测引入的库是否在node_modlues目录下的</span>
          priority<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token comment">//值越大,优先级越高.模块先打包到优先级高的组里</span>
          filename<span class="token operator">:</span> <span class="token string">"vendors.js"</span><span class="token punctuation">,</span> <span class="token comment">//把所有的库都打包到一个叫vendors.js的文件里</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token keyword">default</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          minChunks<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token comment">// 上面有</span>
          priority<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token comment">// 上面有</span>
          reuseExistingChunk<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//如果一个模块已经被打包过了,那么再打包时就忽略这个上模块</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h2 id="tree-shaking摇树优化"><a class="markdownIt-Anchor" href="#tree-shaking摇树优化">#</a>  <code>tree shaking</code> （摇树优化）</h2>
<p>在一个模块中有多个方法，用到的方法会被打包进 <code>bundle</code>  中，没有用到的方法不会打包进去。</p>
<p><code>tree shaking</code>  就是只把用到的方法打包到 <code>bundle</code> ，其余没有用到的会在 <code>uglify</code>  阶段擦除。</p>
<p><code>webpack</code>  默认支持，在 <code>.babelrc</code>  里设置 <code>modules: false</code>  即可。 <code>production</code>  阶段默认开启。</p>
<p>必须是 <code>ES6</code>  语法， <code>CJS</code>  的方式不支持。</p>
<blockquote>
<p>ps: 如果把 <code>ES6</code>  转成 <code>ES5</code> ，同时又要开启 <code>tree shaking</code> ，需要在 <code>.babelrc</code>  里设置 <code>module: false</code> ，不然 <code>babel</code>  默认会把 <code>ES6</code>  转成 <code>CJS</code>  规范的写法，这样就不能进行 <code>tree shaking</code> 。</p>
</blockquote>
<h3 id="dcedeal-code-elimination"><a class="markdownIt-Anchor" href="#dcedeal-code-elimination">#</a>  <code>DCE</code> （deal code elimination）</h3>
<p><code>DEC</code>  全称 deal code elimination，中文意思是死代码删除，主要是下面三种：</p>
<ol>
<li>代码不会被执行</li>
</ol>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"代码不会被执行"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<ol>
<li>代码执行的结果不会被用到</li>
</ol>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token string">"this is a"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">let</span> <span class="token constant">A</span> <span class="token operator">=</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<ol>
<li>代码只写不读</li>
</ol>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="tree-shaking原理"><a class="markdownIt-Anchor" href="#tree-shaking原理">#</a>  <code>tree shaking</code>  原理</h3>
<p>对代码进行静态分析，在编译阶段，代码有没有用到是要确定下来的，不能通过在代码运行时在分析哪些代码有没有用到， <code>tree shaking</code>  会把没用到的代码用注释标记出来，在 <code>uglify</code>  阶段将这些无用代码擦除。</p>
<p>利用 <code>ES6</code>  模块的特点：</p>
<ul>
<li>只能作为模块顶层的语句出现</li>
<li><code>import</code>  的模块名只能是字符串常量</li>
<li><code>import binding</code>  是 <code>immutable</code></li>
</ul>
<h3 id="删除无用的css"><a class="markdownIt-Anchor" href="#删除无用的css">#</a> 删除无用的 <code>css</code></h3>
<ul>
<li><code>purgecss-webpack-plugin</code> ：遍历代码，识别已经用到的 <code>css class</code>
<ul>
<li>和 <code>mini-css-extract-plugin</code>  配合使用</li>
</ul>
</li>
<li><code>uncss</code> ： <code>html</code>  需要通过 <code>jsdom</code>  加载，所有的样式通过 <code>postCSS</code>  解析，通过 <code>document.querySelector</code>  来识别在 <code>html</code>  文件里面不存在的选择器</li>
</ul>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> PurgecssPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"purgecss-webpack-plugin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token constant">PATHS</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  src<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">"src"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">PurgecssPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
      paths<span class="token operator">:</span> glob<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">PATHS</span><span class="token punctuation">.</span>src<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/**/*</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> nodir<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h2 id="scope-hoisting使用和原理分析"><a class="markdownIt-Anchor" href="#scope-hoisting使用和原理分析">#</a>  <code>scope hoisting</code>  使用和原理分析</h2>
<p>构建够的代码会产生大量的闭包，如下图所示：</p>
<p><img src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/1460000040646083" alt="1.png"></p>
<p>当引入外部模块时，会用一个函数包裹起来。当引入的模块越多时，就会产生大量的函数包裹代码，导致体积变大，在运行的时候，由于创建的函数作用域越多，内存开销也会变大。</p>
<ul>
<li>被 <code>webpack</code>  转换后的模块会被包裹一层</li>
<li><code>import</code>  会被转换成 <code>__webpack_require</code></li>
</ul>
<h3 id="分析"><a class="markdownIt-Anchor" href="#分析">#</a> 分析</h3>
<ol>
<li>打包出来的是一个 <code>IIFE</code> （匿名闭包）</li>
<li><code>modules</code>  是一个数组，每一项是一个模块初始化函数</li>
<li><code>__webpack_require</code>  用来加载模块，返回 <code>module.exports</code></li>
<li>通过 <code>WEBPACK_REQUIRE_METHOD(0)</code>  启动程序</li>
</ol>
<h3 id="scope-hoisting原理"><a class="markdownIt-Anchor" href="#scope-hoisting原理">#</a>  <code>scope hoisting</code>  原理</h3>
<p>将所有模块的代码按照引用顺序放在一个函数作用域里，然后适当的重名一些变量以防止变量名冲突。</p>
<p>模块调用有先后顺序， <code>a</code>  模块调用 <code>b</code>  模块，因为有函数包裹， <code>a</code>  模块和 <code>b</code>  模块的顺序无所谓，如果消除包裹代码的话，需要根据模块的引用顺序来排放模块，就要将 <code>b</code>  模块放到 <code>a</code>  模块之前， <code>b</code>  模块才能被 <code>a</code>  模块调用。</p>
<p>通过 <code>scope hoisting</code>  可以减少函数声明和内存开销。 <code>production</code>  阶段默认开启。</p>
<p>必须是 <code>ES6</code>  语法， <code>CJS</code>  不支持。</p>
<blockquote>
<p>ps:  <code>scope hoisting</code>  把多个作用域变成一个作用域。当模块被引用的次数大于 <code>1</code>  次时，是不产生效果的。如果一个模块引用次数大于 <code>1</code>  次，那么这个模块的代码会被内联多次，从而增加打包后文件的体积。</p>
</blockquote>
<hr>
<h2 id="使用eslint"><a class="markdownIt-Anchor" href="#使用eslint">#</a> 使用 <code>ESLint</code></h2>
<p>是 <code>ESLint</code>  能够统一团队的代码风格，能够帮助发现带错误。</p>
<p>两种使用方法：</p>
<ul>
<li>与 <code>CI/CD</code>  集成</li>
<li>与 <code>webpack</code>  集成</li>
</ul>
<h3 id="webpack与cicd集成"><a class="markdownIt-Anchor" href="#webpack与cicd集成">#</a>  <code>webpack</code>  与 <code>CI/CD</code>  集成</h3>
<p>需要安装 <code>husky</code> 。</p>
<p>增加 <code>scripts</code> ，通过 <code>lint-staged</code>  检查修改文件。</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
  <span class="token property">"precommit"</span><span class="token operator">:</span> <span class="token string">"lint-staged"</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token property">"lint-staged"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
  <span class="token property">"linters"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"*.&#123;js,less&#125;"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"eslint --fix"</span><span class="token punctuation">,</span> <span class="token string">"git add"</span><span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h2 id="webpack与eslint集成"><a class="markdownIt-Anchor" href="#webpack与eslint集成">#</a>  <code>webpack</code>  与 <code>ESLint</code>  集成</h2>
<p>使用 <code>eslint-loader</code> ，构建是检查 <code>js</code>  规范</p>
<p>安装插件 <code>babel-eslint</code> 、 <code>eslint</code> 、 <code>eslint-config-airbnb</code> 、 <code>eslint-config-airbnb-base</code> 、 <code>eslint-loader</code> 、 <code>eslint-plugin-import</code> 、 <code>eslint-plugin-jsx-ally</code> 、 <code>eslint-plugin-react</code> 。</p>
<p>新建 <code>.eslintrc.js</code>  文件</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  parser<span class="token operator">:</span> <span class="token string">"babel-eslint"</span><span class="token punctuation">,</span>
  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token string">"airbnb"</span><span class="token punctuation">,</span>
  env<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    browser<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    node<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  rules<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    indent<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"error"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">文件配置</span><span class="token template-punctuation string">`</span></span>eslint<span class="token operator">-</span>loader
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"babel-loader"</span><span class="token punctuation">,</span> <span class="token string">"eslint-loader"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h2 id="代码分割和动态import"><a class="markdownIt-Anchor" href="#代码分割和动态import">#</a> 代码分割和动态 <code>import</code></h2>
<p>对于大的 <code>web</code>  应用来说，将所有的代码都放在一个文件中显然是不够有效的，特别是当你的某些代码块是在某些特殊情况下才会被用到。</p>
<p><code>webpack</code>  有一个功能是将你的代码分割成 <code>chunks</code> （语块），当代码运行到需要它们的时候在进行加载。</p>
<p>使用场景：</p>
<ul>
<li>抽离相同代码到一个共享块</li>
<li>脚本懒加载，使得初始下载的代码更小</li>
</ul>
<p>懒加载 <code>js</code>  脚本的方式</p>
<ul>
<li><code>CJS</code> ： <code>require.ensure</code></li>
<li><code>ES6</code> ：  <code>import</code> （目前还没有原生支持，需要 <code>bable</code>  转换）</li>
</ul>
<p>安装 <code>@bable/plugin-syntax-dynamic-import</code>  插件</p>
<p><code>.babelrc</code>  文件：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token punctuation">&#123;</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"@bable/plugin-syntax-dynamic-import"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>例子：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">Index</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token operator">...</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
      Text<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token function-variable function">loadComponent</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">"./text.js"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">Text</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> Text<span class="token operator">:</span> Text<span class="token punctuation">.</span>default <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> Text <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"search"</span><span class="token operator">></span>
        react1
        <span class="token punctuation">&#123;</span>Text <span class="token operator">&amp;&amp;</span> <span class="token operator">&lt;</span>Text <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">&#125;</span>
        <span class="token operator">&lt;</span>div onClick<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>loadComponent<span class="token punctuation">&#125;</span><span class="token operator">></span>点我<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
        <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token punctuation">&#123;</span>img<span class="token punctuation">&#125;</span> alt<span class="token operator">=</span><span class="token string">""</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这里要注意一点，当配置了 <code>cacheGroups</code>  时， <code>minChunks</code>  设置了 <code>1</code> ，上面设置的懒加载脚本就不生效了，因为 <code>import</code>  在加载时是静态分析的。</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">cacheGroups<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
  commons<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    name<span class="token operator">:</span> <span class="token string">"commons"</span><span class="token punctuation">,</span>
    chunks<span class="token operator">:</span> <span class="token string">"all"</span><span class="token punctuation">,</span>
    priority<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token comment">//值越大,优先级越高.模块先打包到优先级高的组里</span>
    minChunks<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h2 id="多进程多实例并行压缩"><a class="markdownIt-Anchor" href="#多进程多实例并行压缩">#</a> 多进程 / 多实例：并行压缩</h2>
<p>方法一：使用 <code>webpack-parallel-uglify-plugin</code>  插件</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> WebpackParalleUglifyPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"webpack-parallel-uglify-plugin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">WebpackParalleUglifyPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
      uglifyJs<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        output<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          beautify<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
          comments<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        compress<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
          warnings<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
          drop_console<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          collapse_vars<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          reduce_vars<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>方法二：使用 <code>uglifyjs-webapck-plugin</code>  开启 <code>parallel</code>  参数</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> UglifyJsPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"uglifyjs-webpack-plugin"</span><span class="token punctuation">)</span>

modules<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    UglifyJsPlugin<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      warnings<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      parse<span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      compress<span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      mangle<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      output<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      toplevel<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      nameCache<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      ie8<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      keep_fnames<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    parallel<span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>方法三： <code>terser-webpack-plugin</code>  开启 <code>parallel</code>  参数（ <code>webpack4</code>  推荐）</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> TerserPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"terser-webpack-plugin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  optimization<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    minimizer<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token keyword">new</span> <span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
        parallel<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h2 id="提升构建速度"><a class="markdownIt-Anchor" href="#提升构建速度">#</a> 提升构建速度</h2>
<p>思路：将 <code>react</code> 、 <code>react-dom</code> 、 <code>redux</code> 、 <code>react-redux</code>  基础包和业务基础包打包成一个文件</p>
<p>方法：使用 <code>DLLPlugin</code>  进行分包， <code>DLLReferencePlugin</code>  对 <code>manifest.json</code>  引用</p>
<h3 id="使用dllplugin进行分包"><a class="markdownIt-Anchor" href="#使用dllplugin进行分包">#</a> 使用 <code>DLLPlugin</code>  进行分包</h3>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"path"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"webpack"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  context<span class="token operator">:</span> process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  resolve<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">".js"</span><span class="token punctuation">,</span> <span class="token string">".jsx"</span><span class="token punctuation">,</span> <span class="token string">".json"</span><span class="token punctuation">,</span> <span class="token string">".less"</span><span class="token punctuation">,</span> <span class="token string">".css"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    modules<span class="token operator">:</span> <span class="token punctuation">[</span>__dirname<span class="token punctuation">,</span> <span class="token string">"nodu_modules"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  entry<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    library<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"react"</span><span class="token punctuation">,</span> <span class="token string">"react-dom"</span><span class="token punctuation">,</span> <span class="token string">"redux"</span><span class="token punctuation">,</span> <span class="token string">"react-redux"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    filename<span class="token operator">:</span> <span class="token string">"[name].dll.js"</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">"./build/library"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    library<span class="token operator">:</span> <span class="token string">"[name]"</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DllPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
      name<span class="token operator">:</span> <span class="token string">"[name]"</span><span class="token punctuation">,</span>
      path<span class="token operator">:</span> <span class="token string">"./build/library/[name].json"</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>在 <code>webpack.config.js</code>  引入</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">webapck<span class="token punctuation">.</span>DllReferencePlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
      manifest<span class="token operator">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./build/library/manifest.json"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>在项目使用了 <code>webpack4</code> ，对 <code>dll</code>  的依赖没那么大了，使用 <code>dll</code>  相对来说提升也不是特别明显，而 <code>hard-source-webpack-plugin</code>  可以极大的提升二次构建。<br>
不过从实际的前端工厂中来说， <code>dll</code>  还是很有必要的。对于一个团队而言，基本是使用相同的技术栈，要么 <code>react</code> ，要么 <code>vue</code> 。这时候，通常的做法都是把公共框架打成一个 <code>common bundle</code>  文件供所有项目使用。 <code>dll</code>  就可以很好的满足这种场景：将多个 <code>npm</code>  包打成一个公共包。因此团队里面的分包方案使用 <code>dll</code>  还是很有价值。</p>
<p><code>splitChunks</code>  也可以做 <code>DllPlugin</code>  的事情，但是推荐使用 <code>splitChunks</code>  去提取页面间的公共 <code>js</code>  文件，因为使用 <code>splitChunks</code>  每次去提取基础包还是需要耗费构建时间的，如果是 <code>DllPlugin</code>  只需要预编译一次，后面的基础包时间都是可以省略掉的。</p>
<h3 id="提升二次构建速度"><a class="markdownIt-Anchor" href="#提升二次构建速度">#</a> 提升二次构建速度</h3>
<p>方法一：使用 <code>terser-webpack-plugin</code>  开启缓存</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  optimization<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    minimizer<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token keyword">new</span> <span class="token class-name">TerserWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
        parallel<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        cache<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>方法二：使用 <code>cache-loader</code>  或者 <code>hard-source-webpack-plugin</code></p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">HardSourceWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<hr>
<h2 id="缩小构建目标"><a class="markdownIt-Anchor" href="#缩小构建目标">#</a> 缩小构建目标</h2>
<p>比如 <code>babel-loader</code>  不解析 <code>node_modules</code></p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  rules<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    loader<span class="token operator">:</span> <span class="token string">"happypack/loader"</span><span class="token punctuation">,</span>
    <span class="token comment">// exclude: "node_modules"</span>
    <span class="token operator">/</span><span class="token operator">--</span> 或者 <span class="token operator">--</span><span class="token operator">/</span>
    <span class="token comment">// include: path.resolve("src"),</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h2 id="减少文件搜索范围"><a class="markdownIt-Anchor" href="#减少文件搜索范围">#</a> 减少文件搜索范围</h2>
<ul>
<li>优化 <code>resolve.modules</code>  配置（减少模块搜索层级）</li>
<li>优化 <code>resolve.mainFields</code>  配置
<ul>
<li>先查找 <code>package.json</code>  中 <code>main</code>  字段指定的文件 -&gt; 查找根目录的 <code>index.js</code>  -&gt; 查找 <code>lib/index.js</code></li>
</ul>
</li>
<li>优化 <code>resolve.extensions</code>  配置
<ul>
<li>模块路径的查找， <code>import xx from &quot;index&quot;</code>  会先找 <code>.js</code>  后缀的</li>
</ul>
</li>
<li>合理使用 <code>alias</code></li>
</ul>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  resolve<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    alias<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      react<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">"./node_modules/react/dist/react.min.js"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    modules<span class="token operator">:</span> <span class="token punctuation">[</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">"node_modules"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 查找依赖</span>
    extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">".js"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 查找模块路径</span>
    mainFields<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"main"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 查找入口文件</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Harry Qu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://harryqu1229.github.io/2022/02/25/webpack4/">https://harryqu1229.github.io/2022/02/25/webpack4/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/frontend/">frontend</a><a class="post-meta__tags" href="/tags/webpack4/">webpack4</a></div><div class="post_share"><div class="addthis_inline_share_toolbox"></div><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-621848f44e1c3724" async="async"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/02/25/Java%20%E8%99%9A%E6%8B%9F%E6%9C%BA/"><img class="prev-cover" src="https://raw.githubusercontent.com/HarryQu1229/image-host/18bbc356ddf5fcd5544ddb91bb7b35a99ebfef25/notes-img/download%20(1).png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Java Virtual Machine</div></div></a></div><div class="next-post pull-right"><a href="/2022/02/25/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%9F%A5%E8%AF%86%E7%82%B9/"><img class="next-cover" src="https://w.wallhaven.cc/full/72/wallhaven-72myve.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Operating Systems</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2022/02/01/JS%E6%A8%A1%E5%9D%97%E5%8C%96/" title="My Javascript modularity notes"><img class="cover" src="https://w.wallhaven.cc/full/72/wallhaven-72myve.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-01</div><div class="title">My Javascript modularity notes</div></div></a></div><div><a href="/2022/02/25/%E4%B8%80%E7%82%B9%E7%82%B9js%E9%9D%A2%E8%AF%95%E9%A2%98/" title="Javascript Interview Questions"><img class="cover" src="https://w.wallhaven.cc/full/57/wallhaven-57jlo1.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-25</div><div class="title">Javascript Interview Questions</div></div></a></div><div><a href="/2022/02/25/AJAX/" title="My Ajax notes"><img class="cover" src="https://w.wallhaven.cc/full/q2/wallhaven-q257x7.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-25</div><div class="title">My Ajax notes</div></div></a></div><div><a href="/2022/01/12/CSS%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93-YK%E8%8F%8C/" title="css Interview Questions"><img class="cover" src="https://w.wallhaven.cc/full/wq/wallhaven-wqvov7.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-01-12</div><div class="title">css Interview Questions</div></div></a></div><div><a href="/2022/01/01/50%E9%81%93%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E9%A2%98/" title="50 Frontend Interview Quesitions"><img class="cover" src="https://w.wallhaven.cc/full/57/wallhaven-57jlo1.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-01-01</div><div class="title">50 Frontend Interview Quesitions</div></div></a></div><div><a href="/2022/02/01/JQuery/" title="My jQuery notes"><img class="cover" src="https://raw.githubusercontent.com/HarryQu1229/image-host/9575054fd0f7d407d7b7d5343dfc530a06ed4104/notes-img/cat.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-01</div><div class="title">My jQuery notes</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div><div id="comment-switch"><span class="first-comment">Disqus</span><span class="switch-btn"></span><span class="second-comment">Gitalk</span></div></div><div class="comment-wrap"><div><div id="disqus_thread"></div></div><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://raw.githubusercontent.com/HarryQu1229/image-host/6aca34ee52f40fe1b2d637474f90111e2c151939/notes-img/%E5%85%B6%E4%B8%AD%E5%8C%85%E6%8B%AC%E5%9B%BE%E7%89%87%EF%BC%9A%7B%7B%20pinTitle%20%7D%7D_m6kogp.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Harry Qu</div><div class="author-info__description">Software Engineering Student</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">171</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">89</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">60</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/HarryQu1229"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://www.linkedin.com/in/harry-qu-a0a38220a" target="_blank" title="LinkedIn"><i class="fab fa-linkedin"></i></a><a class="social-icon" href="https://github.com/HarryQu1229" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:Harryqu666@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="weixin://dl/chat?harry666ya" target="_blank" title="Wechat"><i class="fab fa-weixin"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">be healthy, stay safe</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#webpack"><span class="toc-number">1.</span> <span class="toc-text"> Webpack</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7"><span class="toc-number">1.1.</span> <span class="toc-text"> 构建工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9D%E8%AF%86webpack"><span class="toc-number">1.2.</span> <span class="toc-text"> 初识 webpack</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEscript%E8%84%9A%E6%9C%AC"><span class="toc-number">1.2.1.</span> <span class="toc-text"> 配置 script  脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.2.</span> <span class="toc-text"> 配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5"><span class="toc-number">1.2.3.</span> <span class="toc-text"> 核心概念</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#entry"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">  entry</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#output"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">  output</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#mode"><span class="toc-number">1.2.3.3.</span> <span class="toc-text">  mode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#loaders%E7%BF%BB%E8%AF%91%E5%AE%98"><span class="toc-number">1.2.3.4.</span> <span class="toc-text">  loaders(翻译官)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#plugins"><span class="toc-number">1.2.3.5.</span> <span class="toc-text">  plugins</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#webpack%E8%B5%84%E6%BA%90%E8%A7%A3%E6%9E%90"><span class="toc-number">1.3.</span> <span class="toc-text">  webpack  资源解析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E6%9E%90es6"><span class="toc-number">1.3.1.</span> <span class="toc-text"> 解析 es6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E6%9E%90css"><span class="toc-number">1.3.2.</span> <span class="toc-text"> 解析 css</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E6%9E%90less"><span class="toc-number">1.3.3.</span> <span class="toc-text"> 解析 less</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E6%9E%90%E5%9B%BE%E7%89%87%E5%92%8C%E5%AD%97%E4%BD%93"><span class="toc-number">1.3.4.</span> <span class="toc-text"> 解析图片和字体</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#url-loader"><span class="toc-number">1.3.5.</span> <span class="toc-text">  url-loader</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEvue"><span class="toc-number">1.3.6.</span> <span class="toc-text"> 配置 vue</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEreact"><span class="toc-number">1.3.7.</span> <span class="toc-text"> 配置 react</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#webpack%E6%96%87%E4%BB%B6%E7%9B%91%E5%90%AC%E5%8F%8A%E7%83%AD%E6%9B%B4%E6%96%B0"><span class="toc-number">1.4.</span> <span class="toc-text">  webpack  文件监听及热更新</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%9B%91%E5%90%AC"><span class="toc-number">1.4.1.</span> <span class="toc-text"> 文件监听</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%9B%91%E5%90%AC%E5%88%86%E6%9E%90"><span class="toc-number">1.4.2.</span> <span class="toc-text"> 文件监听分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%83%AD%E6%9B%B4%E6%96%B0"><span class="toc-number">1.4.3.</span> <span class="toc-text"> 热更新</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hotmodulereplacementplugin"><span class="toc-number">1.4.4.</span> <span class="toc-text">  HotModuleReplacementPlugin</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%8C%87%E7%BA%B9"><span class="toc-number">1.5.</span> <span class="toc-text"> 文件指纹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E6%96%87%E4%BB%B6%E6%8C%87%E7%BA%B9"><span class="toc-number">1.5.1.</span> <span class="toc-text"> 什么是文件指纹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%8C%87%E7%BA%B9%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.5.2.</span> <span class="toc-text"> 文件指纹类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#js%E6%96%87%E4%BB%B6%E6%8C%87%E7%BA%B9"><span class="toc-number">1.5.3.</span> <span class="toc-text">  js  文件指纹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#css%E6%96%87%E4%BB%B6%E6%8C%87%E7%BA%B9"><span class="toc-number">1.5.4.</span> <span class="toc-text">  css  文件指纹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E7%89%87%E6%96%87%E4%BB%B6%E6%8C%87%E7%BA%B9"><span class="toc-number">1.5.5.</span> <span class="toc-text"> 图片文件指纹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%8E%8B%E7%BC%A9"><span class="toc-number">1.6.</span> <span class="toc-text"> 代码压缩</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#js%E5%8E%8B%E7%BC%A9"><span class="toc-number">1.6.1.</span> <span class="toc-text">  js  压缩</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#css%E5%8E%8B%E7%BC%A9"><span class="toc-number">1.6.2.</span> <span class="toc-text">  css  压缩</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#html%E5%8E%8B%E7%BC%A9"><span class="toc-number">1.6.3.</span> <span class="toc-text">  html  压缩</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E6%B8%85%E7%90%86%E6%9E%84%E5%BB%BA%E7%9B%AE%E5%BD%95"><span class="toc-number">1.7.</span> <span class="toc-text"> 自动清理构建目录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E8%A1%A5%E9%BD%90%E6%A0%B7%E5%BC%8F%E5%89%8D%E7%BC%80"><span class="toc-number">1.8.</span> <span class="toc-text"> 自动补齐样式前缀</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B5%84%E6%BA%90%E5%86%85%E8%81%94"><span class="toc-number">1.9.</span> <span class="toc-text"> 资源内联</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#html%E5%86%85%E8%81%94"><span class="toc-number">1.9.1.</span> <span class="toc-text">  html  内联</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#js%E5%86%85%E8%81%94"><span class="toc-number">1.9.2.</span> <span class="toc-text">  js  内联</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#css%E5%86%85%E8%81%94"><span class="toc-number">1.9.3.</span> <span class="toc-text">  css  内联</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E9%A1%B5%E9%9D%A2%E5%BA%94%E7%94%A8"><span class="toc-number">1.10.</span> <span class="toc-text"> 多页面应用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sourcemap%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">1.11.</span> <span class="toc-text">  sourceMap  使用方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#source-map%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-number">1.11.1.</span> <span class="toc-text">  source map  关键字</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#source-map%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.11.2.</span> <span class="toc-text">  source map  类型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%90%E5%8F%96%E9%A1%B5%E9%9D%A2%E5%85%AC%E5%85%B1%E8%B5%84%E6%BA%90"><span class="toc-number">1.12.</span> <span class="toc-text"> 提取页面公共资源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#tree-shaking%E6%91%87%E6%A0%91%E4%BC%98%E5%8C%96"><span class="toc-number">1.13.</span> <span class="toc-text">  tree shaking （摇树优化）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#dcedeal-code-elimination"><span class="toc-number">1.13.1.</span> <span class="toc-text">  DCE （deal code elimination）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tree-shaking%E5%8E%9F%E7%90%86"><span class="toc-number">1.13.2.</span> <span class="toc-text">  tree shaking  原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%97%A0%E7%94%A8%E7%9A%84css"><span class="toc-number">1.13.3.</span> <span class="toc-text"> 删除无用的 css</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#scope-hoisting%E4%BD%BF%E7%94%A8%E5%92%8C%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90"><span class="toc-number">1.14.</span> <span class="toc-text">  scope hoisting  使用和原理分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%9E%90"><span class="toc-number">1.14.1.</span> <span class="toc-text"> 分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#scope-hoisting%E5%8E%9F%E7%90%86"><span class="toc-number">1.14.2.</span> <span class="toc-text">  scope hoisting  原理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8eslint"><span class="toc-number">1.15.</span> <span class="toc-text"> 使用 ESLint</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#webpack%E4%B8%8Ecicd%E9%9B%86%E6%88%90"><span class="toc-number">1.15.1.</span> <span class="toc-text">  webpack  与 CI&#x2F;CD  集成</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#webpack%E4%B8%8Eeslint%E9%9B%86%E6%88%90"><span class="toc-number">1.16.</span> <span class="toc-text">  webpack  与 ESLint  集成</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%88%86%E5%89%B2%E5%92%8C%E5%8A%A8%E6%80%81import"><span class="toc-number">1.17.</span> <span class="toc-text"> 代码分割和动态 import</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E8%BF%9B%E7%A8%8B%E5%A4%9A%E5%AE%9E%E4%BE%8B%E5%B9%B6%E8%A1%8C%E5%8E%8B%E7%BC%A9"><span class="toc-number">1.18.</span> <span class="toc-text"> 多进程 &#x2F; 多实例：并行压缩</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%90%E5%8D%87%E6%9E%84%E5%BB%BA%E9%80%9F%E5%BA%A6"><span class="toc-number">1.19.</span> <span class="toc-text"> 提升构建速度</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8dllplugin%E8%BF%9B%E8%A1%8C%E5%88%86%E5%8C%85"><span class="toc-number">1.19.1.</span> <span class="toc-text"> 使用 DLLPlugin  进行分包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%90%E5%8D%87%E4%BA%8C%E6%AC%A1%E6%9E%84%E5%BB%BA%E9%80%9F%E5%BA%A6"><span class="toc-number">1.19.2.</span> <span class="toc-text"> 提升二次构建速度</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%A9%E5%B0%8F%E6%9E%84%E5%BB%BA%E7%9B%AE%E6%A0%87"><span class="toc-number">1.20.</span> <span class="toc-text"> 缩小构建目标</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%8F%E5%B0%91%E6%96%87%E4%BB%B6%E6%90%9C%E7%B4%A2%E8%8C%83%E5%9B%B4"><span class="toc-number">1.21.</span> <span class="toc-text"> 减少文件搜索范围</span></a></li></ol></li></ol></div></div><div class="card-widget card-map"><div class="card-content"><div class="item-headline"><i class="fa fa-globe-asia" aria-hidden="true"></i><span>Visitor Map</span></div><script id="clstr_globe" type="text/javascript" defer="defer" src="//clustrmaps.com/globe.js?d=4LA950xi3DtQgUHPlkO0mo-n_QgrcOu-1BIiVpExg7k"></script></div></div><div class="card-widget card-pixiv"><div class="card-content"><div class="item-headline"><i class="fa fa-image" aria-hidden="true"></i><span>Pixiv Top50</span><iframe src="https://cloud.mokeyjay.com/pixiv" frameborder="0" style="width:99%;height:380px;margin:0;"></iframe></div></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/04/02/linux%E5%B0%8F%E7%AC%94%E8%AE%B0/" title="Linux easy notes"><img src="https://raw.githubusercontent.com/HarryQu1229/image-host/18bbc356ddf5fcd5544ddb91bb7b35a99ebfef25/notes-img/download%20(1).png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux easy notes"/></a><div class="content"><a class="title" href="/2022/04/02/linux%E5%B0%8F%E7%AC%94%E8%AE%B0/" title="Linux easy notes">Linux easy notes</a><time datetime="2022-04-01T11:00:00.000Z" title="Created 2022-04-02 00:00:00">2022-04-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/02/linux%E7%9A%84%E4%B8%80%E4%BA%9B%E5%91%BD%E4%BB%A4/" title="Linux commands"><img src="https://w.wallhaven.cc/full/q2/wallhaven-q257x7.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux commands"/></a><div class="content"><a class="title" href="/2022/04/02/linux%E7%9A%84%E4%B8%80%E4%BA%9B%E5%91%BD%E4%BB%A4/" title="Linux commands">Linux commands</a><time datetime="2022-04-01T11:00:00.000Z" title="Created 2022-04-02 00:00:00">2022-04-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/02/Linux/" title="Linux notes"><img src="https://w.wallhaven.cc/full/q2/wallhaven-q257x7.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux notes"/></a><div class="content"><a class="title" href="/2022/04/02/Linux/" title="Linux notes">Linux notes</a><time datetime="2022-04-01T11:00:00.000Z" title="Created 2022-04-02 00:00:00">2022-04-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/03/01/nodejs/" title="Nodejs notes"><img src="https://w.wallhaven.cc/full/k7/wallhaven-k7v9yq.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Nodejs notes"/></a><div class="content"><a class="title" href="/2022/03/01/nodejs/" title="Nodejs notes">Nodejs notes</a><time datetime="2022-02-28T11:00:00.000Z" title="Created 2022-03-01 00:00:00">2022-03-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/03/01/%E5%88%9D%E4%B8%AD%E7%BA%A7%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E9%A2%98/" title="Frontend interview questions"><img src="https://w.wallhaven.cc/full/8o/wallhaven-8o6rmo.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Frontend interview questions"/></a><div class="content"><a class="title" href="/2022/03/01/%E5%88%9D%E4%B8%AD%E7%BA%A7%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E9%A2%98/" title="Frontend interview questions">Frontend interview questions</a><time datetime="2022-02-28T11:00:00.000Z" title="Created 2022-03-01 00:00:00">2022-03-01</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2022 By Harry Qu</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="Chat"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Local search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function loadDisqus () {
  var disqus_config = function () {
    this.page.url = 'https://harryqu1229.github.io/2022/02/25/webpack4/'
    this.page.identifier = '2022/02/25/webpack4/'
    this.page.title = 'Webpack4 notes'
  };

  window.disqusReset = () => {
    DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  if (window.DISQUS) disqusReset()
  else {
    (function() { 
      var d = document, s = d.createElement('script');
      s.src = 'https://harry-study-blog.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  }
}

if ('Disqus' === 'Disqus' || !false) {
  if (false) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
  else loadDisqus()
} else {
  function loadOtherComment () {
    loadDisqus()
  }
}
</script><script>if (window.DISQUSWIDGETS === undefined) {
  var d = document, s = d.createElement('script');
  s.src = 'https://harry-study-blog.disqus.com/count.js';
  s.id = 'dsq-count-scr';
  (d.head || d.body).appendChild(s);
} else {
  DISQUSWIDGETS.getCount({reset: true});
}</script><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: '5df1e915e0fa867b50de',
      clientSecret: 'ce1cb793fe49078ee9d0102d3326d0d50ff6937b',
      repo: 'blog-comments-storage',
      owner: 'HarryQu1229',
      admin: ['HarryQu1229'],
      id: 'd38970a8b41c1c540411bde3ad1d0e2a',
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Disqus' === 'Gitalk' || !false) {
  if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[image]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[link]') // replace url
    content = content.replace(/<code>.*?<\/code>/gi, '[code]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    fetch('https://disqus.com/api/3.0/forums/listPosts.json?forum=harry-study-blog&related=thread&limit=6&api_key=a5KJbIVovxK3ZXvlrPvv7wgYLY4fAh3pvP4thfjXYUdM2cNymlgVhMhdyhb9e0O3')
      .then(response => response.json())
      .then(data => {
        const disqusArray = data.response.map(item => {
          return {
            'avatar': item.author.avatar.cache,
            'content': changeContent(item.message),
            'nick': item.author.name,
            'url': item.url,
            'date': item.createdAt
          }
        })

        saveToLocal.set('disqus-newest-comments', JSON.stringify(disqusArray), 10/(60*24))
        generateHtml(disqusArray)
      }).catch(e => {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.innerHTML= "Unable to get the data, please make sure the settings are correct."
      })
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick}</span><time> / ${btf.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += 'No Comment'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('disqus-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><div class="aplayer no-destroy" data-id="2809513713" data-server="netease" data-type="playlist" data-autoplay="false" data-fixed="true" data-order="random" data-theme="#e9ccd3"> </div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script>((window.gitter = {}).chat = {}).options = {
  disableDefaultChat: true,
};
document.addEventListener('gitter-sidecar-ready', (e) => {
  const GitterChat = e.detail.Chat
  let chat

  function initGitter () {
    chat = new GitterChat({
      room: 'HarryStudyBlog/community',
      activationElement: '#chat_btn'
    });
  }

  initGitter()

  if (true) {
    document.addEventListener('pjax:complete', () => {
      chat.destroy()
      initGitter()
    })
  }

})</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async="async" defer="defer"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<div id="workboard"></div><div id="ghbdages" style="overflow:hidden;max-height:90px;height:auto;text-align:center;margin-top:10px"><div class="swiper-wrapper"><div class="swiper-slide"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" title="博客框架为Hexo_v5.4.0"><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" title="主题版本Butterfly_v3.8.2"><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://www.jsdelivr.com/" style="margin-inline:5px" title="本站使用JsDelivr为静态资源提供CDN加速"><img src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&amp;logo=jsDelivr" alt=""/></a></div><div class="swiper-slide"><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" title="本站采用双线部署，默认线路托管于Vercel"><img src="https://img.shields.io/badge/Hosted-Vercel-brightgreen?style=flat&amp;logo=Vercel" alt=""/></a><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" title="本站采用双线部署，联通线路托管于Coding"><img src="https://img.shields.io/badge/Hosted-Coding-0cedbe?style=flat&amp;logo=Codio" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" title="本站项目由Github托管"><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a></div><div class="swiper-slide"><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a></div></div></div><style>a.github-badge:hover:before {display:none}</style>';
    console.log('已挂载butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><script async src="/js/footer-beautify-runtime.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-footer-beautify/lib/swiperbdage_init.min.js"></script><script data-pjax src="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.js"></script><script data-pjax>
  function gitcalendar_injector_config(){
      var parent_div_git = document.getElementById('recent-posts');
      var item_html = '<div class="recent-post-item" style="width:100%;height:auto;padding:10px;"><style>#git_container{min-height: 280px}@media screen and (max-width:650px) {#git_container{min-height: 0px}}</style><div id="git_loading" style="width:10%;height:100%;margin:0 auto;display: block;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animatetransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animatetransform></path></svg><style>#git_container{display: none;}</style></div><div id="git_container"></div></div>';
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      console.log('已挂载gitcalendar')
      }

    if( document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
        gitcalendar_injector_config()
        GitCalendarInit("https://gitcalendar.akilar.top/api?HarryQu1229",['#ebedf0', '#fdcdec', '#fc9bd9', '#fa6ac5', '#f838b2', '#f5089f', '#c4067e', '#92055e', '#540336', '#48022f', '#30021f'],'HarryQu1229')
    }
  </script><!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":300,"height":450},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>