<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>My Webpack5 Advanced notes | Harry Blog</title><meta name="keywords" content="frontend,webpack5"><meta name="author" content="Harry Qu"><meta name="copyright" content="Harry Qu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="# 0、课程介绍 # 为什么学习 Webpack？  # 为什么是 Webpack 呢？  而全新版本 webpadk5 则是具备了比以往版本更强大的功能，甚至是诸多企业级前端工程化的技术选型的不二选择。 # 学习 Webpack5 的前提？ _ 前端基础知识：htm、css、es6 以及以上的版本 _ nodejs 和工程化 # 课程安排？   # 课程收获？   # 第一章：为什么需要 web">
<meta property="og:type" content="article">
<meta property="og:title" content="My Webpack5 Advanced notes">
<meta property="og:url" content="https://harryqu1229.github.io/2021/12/29/webpack5%E5%9F%BA%E7%A1%80/index.html">
<meta property="og:site_name" content="Harry Blog">
<meta property="og:description" content="# 0、课程介绍 # 为什么学习 Webpack？  # 为什么是 Webpack 呢？  而全新版本 webpadk5 则是具备了比以往版本更强大的功能，甚至是诸多企业级前端工程化的技术选型的不二选择。 # 学习 Webpack5 的前提？ _ 前端基础知识：htm、css、es6 以及以上的版本 _ nodejs 和工程化 # 课程安排？   # 课程收获？   # 第一章：为什么需要 web">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://harryqu1229.github.io/img/default-covers/hello-world.png">
<meta property="article:published_time" content="2021-12-28T11:00:00.000Z">
<meta property="article:modified_time" content="2022-06-12T01:16:40.086Z">
<meta property="article:author" content="Harry Qu">
<meta property="article:tag" content="frontend">
<meta property="article:tag" content="webpack5">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://harryqu1229.github.io/img/default-covers/hello-world.png"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://harryqu1229.github.io/2021/12/29/webpack5%E5%9F%BA%E7%A1%80/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: undefined,
  noticeOutdate: {"limitDay":100,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"prismjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'mediumZoom',
  Snackbar: {"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Dark Mode Activated Manually","night_to_day":"Light Mode Activated Manually","bgLight":"#C78550","bgDark":"#c08eaf","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'My Webpack5 Advanced notes',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-06-12 13:16:40'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><style type="text/css">.aplayer.aplayer-fixed.aplayer-narrow .aplayer-body{left:-66px!important}.aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover{left:0!important}</style><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-footer-beautify@1.0.0/lib/runtime.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/avatar.jpeg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">158</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">84</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">57</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-graduation-cap"></i><span> Journey</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> Hobbies</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/Photos/"><i class="fa-fw fas fa-images"></i><span> Photos</span></a></li><li><a class="site-page child" href="/Movies/"><i class="fa-fw fas fa-video"></i><span> Movies</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Links</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAACMCAMAAABmmcPHAAAAw1BMVEX///8aHByO1vsceMAAAAAYGhoWGBjw8PCJ1Pv3/P8RExMiJSWV2PuG1Pu25PwAcL3MzMzo9/6fn5/O7P2yzudYl87T5PJ+rdhPUVHr6+uoqKjl5eUABwcRFBQKc76JiYlcXV3a8f6u4fzW1tZ5enqTlJQsLi5BQkLv+f4AbLtrbGxnaGjF6f1NT0+j3fzc3Ny7u7uwsbE0NjaAgIDI2+7f6/Wbvt9sodKKtNu60uk2hcbBwcF3p9U+iMdknNDO3+8AZLjWDvjfAAAPI0lEQVR4nO2de0PiOBfGW0xbKCKIOnJpAeWmKHKb67qzs9//U71pkpOcpCnirArMm+cvLaFNfz09lyQtnufk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OT0f6jK47nnPd7suxt/vC5OaxT0We32fN89+aN1/lQuMdDlcvmssu/e/LG6u62VSgJ0qVQuP+67Q3+mKmc1ileBpqhPnat+e12UGFwMmv795Fz12+rmSaDVQVP/cXa37779QbpTmA3QFHXJueo3EjhnO+jMqp2rfgtJ51wE2rnqt9DNaa1Uegk0tepb56r/i86fTKIFoLOouO/OHq8qt7U85wLQWVS82HeHj1OVx7IFZzFo+okrYH5DN6dWmNtA08/2NdYUtYX2c3gp6Ea06xdszhlYVujHuRAJ/mNPY02duMpEuvs4utKEd8Nv7db87rYQMyRyZtKnUO+lgOmQgGnfoKsp60Y836WxUaBgiNgJPxai3oOr7hCfae+gQ9aNeBeLLrbVU55WfL66ZmZdObNHy30UMMcH+qbIOVOXwLzvl3/qvd7Jd/b3+W2xq/7YAubYQFeeisjVeJC7+5tSpqr/dcm+sC0qvvdJYR0b6KKkTlTYle91hpmj/rHDNz5KRwfaGuOEy61cntRPkO6vPrFvXORRf7iTPi7QFRHjdG8A9d6Pnxpmql792xf+DT0qQjH+gbCPDHTplsc45KkB2qcrEzND3bvmrhuNioA7Pz+9fd+Twjoy0Kcws30j/Af8n6UaFs4M9VfW4g4uTu2JOecM/QeGw2MDraqNzFVDPX13fV+AmUXFE56AsMRQfp1a+PuAjqLFsBuZYwkm6Kg7XLw44JA1yu0Jf962HUrvTFdvsTtoGcioSfIRosrXky2YGeqfn9n3L06Fn+Hh0Qp62BTq4P7CRnxSHdjYUNsW41ZKMlUH/QXerQZ6MR4kWaN4OnrWsIzFHllHxi22p3SuN4IjNWfrmDUg69nSCnvYb/miM2PojAX0Kn/GHLQyZLbx8i+bczaj4j8sAamwr8CAlBV0g4Aiy8YlokJyG58pmjhgZxJSCC0ECIFuz6BVkCZk3bHsMvK6A60ROi5r2JzTj0N+KD9MiN/Poe5Mtc4MGgWgV/I8VHcFaDyG/zmXahSh5glINlsglyJYXYfoio+hjgWmZITh+6IhbJmR2MeKyUMedPQcJ7hRSFqSUcQbBYm3TLRGKRmg8dVoE5NUOxLdS1W7gbylbzSJySyygV4QcbnIWH1bgpa+tvK994LbkO5D1C+PKP2wgh6JU0w2attUdDqc5uHHgubQJ74pMgE+ADrpk9BolCRDHbTv9+HsESdpb0uSmJ+ya4HD7Ch3FNqZuQ20LxomD+jrCDTFxD3H+beifEMz6BOee3gXKAe3g34WZxtW5SYJwCfKbubCfMmKc44NI+MnBKQBtJ/kG6XpwjiOpVFIIBR0bZzpXtbqHB7y15x2tGMB/SAOlU4wAw10CUroXy96j179GhpflF8C7UmXIG/pJdE6y9Suwi3HUEaB4hymypySlgHapngdGRfUopDA3dG3NyNN6NvM1iBIunnQTQIfap5HB00D4jfuDi57W1HfX/H68PpyJ9AtMFXppEfSwuIZbAMXLbo8gCYhIZNplchbV1waHTTLTGJlmGRkAR2wpEJdv1j6LeZYwoSHMBkXwkmUuxC8ETtSysb6ddAN6aBXGoIc6Kv7n3w4Y4urrv/1WVyN+91Ad3KRT3nMwAczh7PhMWQlb4MJ63LUqQryAb8xMOiUrJur5erBV/slQxN0QPwZbdScKpLSZDskoJnIaPU87A6XA3VNG5oJsBA5ovsYt2Lahl9xDXQ7hsDf1xHkQfd6938zr/ClwFWDc86yk/puoNvgpMHpLdD5EwhcA7D77J6LJtBjeXGiVoKvBAJNphDXmgkwigcG6DTuiEs6nMPWsApXeRKPoB80qAQ6LojcfjKBA0XjasIvuAZ6Ks4hN7FlAc1Qsqza5qrBOfMKfUfQ0NMgFnEcWyMkQZFIYnkeAgathW4Rz2mypu2DoBRxCCbF5xIV6NBHPnMkbxeIEEOtkIfwzfMfGVBQ3kit54E7HgwabsowNpNwK2iVuRmjpPQDPk4KOeCuoCFxg4xqgNJjuPgNzb8Itx6kGACcMbsJJGjdelQy3tRAkwZuBVGjqHAWlsG98KDATBcm6GdiPdgW0Igo9h/1E+APrXYEPQSIPJOOfF6h8S4Sy8UAZ5PMtP3w73GGEjTRCwuwKuY7JGjDZ8qEjtiXhTxwtmGWvHTteQRIge5Kj9PMtSoEfSJdtRzFA+f8S1Xou4KO1rwLKb/buNUFk2mIzBxsmAXHlXELCM1ixbCj3d6IoQiILGUA0EFoAIW0B1Wr0XNzM5vNxqu2/Jj58I5uJcWgZR0wy7cqBs2GQ5mr5jW5dM7f7pGJ7wgaOi6cNDe6eDRmWxNmbBE2RK8vOMSzPtY8FAwRaGKMWqig2jX3igR3uSyTn2c0a0viOMveBg1xRYMMtLwmVoMG0OlAFrZTS6ttoDVXbTjn14J+1iyUGy9Zcstm2FSLFYblxwkWBDpsaMSMO9IHNRRo0jEatbWI4HVbuAqPweGwA4lbLZx4VsFITlV0WUb8V4DOhkMF30tB3Ph4V9Bt4V2Z9bZT9g9pR7wWZPnBWOM2tVXfUixEStDmsZbokkV2F0QlihseDRvG4JU8UAZ6sn3AGUDDyF9scRwvg5auOtPn3PDpzqDBRJmT5iSykQS+lRkxeHGeaq/zIzhYWVgSoAPfPBRE3iwkRci6dQl8LLVvWAaMFGhwwg/mLjTQwdSH+Gob7H4RtHLVNCqaH70CNL7RudPLOPCtzAYQHQ9ZdGBVlt8B6Kp5KCvo3Mkj0NFEHi3RSnDdogdbQacDCOCqCnod6CyrO6dew1Yn7g66i0IXN9cM1iKBk5UumkccCOBBGNtEFltcxzPyy5Hm+bGE68huMfBafhL2l4tGZyYNnIHWM6Yi0CjrSF6ZdSjdU0d9bftgd9BgF9RJc+ZBnG0VzBeQ/ULEmcEQdjeyykOgzUy4iawYQOdSM7jwmUOQExMzqNGrKQI9QBnIVtBqxN9MhHYFXX8D0MJsqPVyQvzU++BFhK9I+lprNRCSV6fIWPGYCYDOmSNETHpAcDUo2g1FCsLgQqpp9b1aZQi9DvJl0MeBlp6zMovVVecJXvwAAx0QtGTmMC7cIYBOjcIYij6tYMldsZaaZOhY/PgDsuIVMv7toGVoyS+W/jjQ4BTJkjEVY52eqBHFycg4EuHyDksVDaoE1zMKewme6JTUiEhX3T2oIBlDpEUleIFJY9BD2dQswj8QNFS181Ri8OA+T0XJp3JQef+PtJ0M1f8StO4WFMKVpw0qYb/Zhjwj+27T4qYwaNmX0NdLkdygkudtpPMwysgPBA3eINQuucAF4WhlttZJN4KUrBcGaD+ZK7N/hoAUhJEGOkC+vL2GDC5zTdJ1ICts4QAo+5Im6OaJHqp50N6kwHl8IOhImwGFK94maGMQKpOZShZruGPbbCY6FcTQmHYcC4jdmZxi4d4dDfwHZMCPGXXkbFYQt9U9EMi5c7lvkWmorJ6MRA/bfZLwWXJzKks7/j5AQ4DhtiFvd1xsYzOQY7vZPNVm3OyMB0SMTPHRMTx5EJDJqN/ftEiitngG6GwIY77p9wcETc1kNCKYagzDFePaBgcAoNVUlp+Q9WzTH7Ej8VvAmJxVcwpa+P1I0JiMmj3EE9BaCBmpD0K9YEur5u6yJlToSgqzN2bB06yRurFE1i5nigPiP2w2A3S5RHDGnQyzcS5mHdxaDNARZOXblhu8L2htolAG8AbeqhnB1LIWg50pdztblxsQUaBsXW4A+coCTRXH2pWQRcrcth/rcoOC6JIDbRnQKAbdu//xCtDIS6ipb2UB2gIb9snUSikO+eWQftQy8CaH3iVoSysVHptFl0NVgy1bE3YH5lYqwQoaLR3Mr1T6ak4TFoOuX/3ydlmpBFI3IB6gmUkEiTFFH81sy7CMrCMe5Ra3hGreSpXgA7NVnKiEb2N8GODKEJrkRm4DZrM50Mrno6Idr70Tyxzv8is6rKBhVqCCHojbDlp5CTwOv1Jbc2OZS99AnZANdF6ApqV8XxtNDkhVWZIcVBpTn49JhWSK/dRY20VMxnykHI9vPK911AGxBkMPOQ80uqRA19QT3V/+NlahW0DXxZKETOqBuBcWosdyPSvK/LtyY24cLltNWyWEPwOcLbaV2ZWX3e9c1KqGA9EoW00bj1ExiUB7jSlJ+K5ocJ0YIyTDORyHHoZeg0l+pbG3Yst2ZV82vC/QeVQ2DeQZSYMC0PBM1Zl4ruJKGxTNge7Vv4sHWfhqf3j09gXQwwYIb5Ub7QNIw/GUzWfF05G2OrwrvsU8yYI3qs7HepmMQWfryKdsRmzdtxxK7CKZ9rPeLSwdpcfstIKEN1LRPN/7qJE7UQ4ano6gvMol/qe2StoA3evxWZfsCXJ4To4/pfVez7CIkdGXWlk2AWjl/rc+WbHDYXbriyn2DIt4OcENf/in9sRRo3X/Guhe/R++wpE/nigfFsi+fXAv/7GA3o8o6NotPFMlQ5qw0q8QFTHo+5+/2DfVM53yQp0e3luWDgd06ZQ7Z+0lP+Uyf/oQ1ikp0LBWSX9KWT2Y5UAXqMJTuhvzIeVy7RE9cQ+g62Kt0nnuQX3xqGHl0F5mdTCgmfLcUFr9iSYgHDS8SeLO+iaJ2kG+XPqQQBe+5Accwuef/2ag76+tT4GjK3OAbyw9JNBewTvYSjIqepcU9CV/1q3wbT+H+Wa2gwK95QU+4HtBOV+O7PkAMR8aaOMlxjrAmnqDz03Ry2oO021kiuBVYgcC+gWIuTdNmHZ/sK/ujohY2nQwoLe8Koxuv9vmyQ/6Dcd4bdPBqPhda1temel+XuE3VJTpFYM+WOd86LI74sLXGrufwPl92d61VgDa/ajTf9Nj7j2lVtAHWaAclyq3RlS0gHYvQ38TGa7a8vMgj845v420n64wQdfcD1a8oS6U/9BBH3SBcoxSb+/GoA909Oi4BQUM+pk9V6C8j/hYk/zhyMMdPTp+ZWNNArRzzu+rszL/cV9XoLy3Klmpfeacs5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5OTk5PTa/U//8ZkEo9djoEAAAAASUVORK5CYII=')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Harry Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-graduation-cap"></i><span> Journey</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> Hobbies</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/Photos/"><i class="fa-fw fas fa-images"></i><span> Photos</span></a></li><li><a class="site-page child" href="/Movies/"><i class="fa-fw fas fa-video"></i><span> Movies</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Links</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">My Webpack5 Advanced notes</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2021-12-28T11:00:00.000Z" title="Created 2021-12-29 00:00:00">2021-12-29</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2022-06-12T01:16:40.086Z" title="Updated 2022-06-12 13:16:40">2022-06-12</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Frontend/">Frontend</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Frontend/webpack/">webpack</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">16.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>63min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="My Webpack5 Advanced notes"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="0-课程介绍"><a class="markdownIt-Anchor" href="#0-课程介绍">#</a> 0、课程介绍</h1>
<h2 id="为什么学习webpack"><a class="markdownIt-Anchor" href="#为什么学习webpack">#</a> 为什么学习 Webpack？</h2>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/ba3917652bbe4553aa4e8956d0655a88%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<h2 id="为什么是webpack呢"><a class="markdownIt-Anchor" href="#为什么是webpack呢">#</a> 为什么是 Webpack 呢？</h2>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/6701f331110944bcac3cfaea41ef0624%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>而全新版本 webpadk5 则是具备了比以往版本更强大的功能，甚至是诸多企业级前端工程化的技术选型的不二选择。</p>
<h2 id="学习webpack5的前提"><a class="markdownIt-Anchor" href="#学习webpack5的前提">#</a> 学习 Webpack5 的前提？</h2>
<p>_ 前端基础知识：htm、css、es6 以及以上的版本<br>
_ nodejs 和工程化</p>
<h2 id="课程安排"><a class="markdownIt-Anchor" href="#课程安排">#</a> 课程安排？</h2>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124030557293.png" alt="image-20220124030557293"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124030605042.png" alt="image-20220124030605042"></p>
<h2 id="课程收获"><a class="markdownIt-Anchor" href="#课程收获">#</a> 课程收获？</h2>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124030612945.png" alt="image-20220124030612945"></p>
<hr>
<h1 id="第一章-为什么需要webpack"><a class="markdownIt-Anchor" href="#第一章-为什么需要webpack">#</a> 第一章：为什么需要 webpack</h1>
<h2 id="10-为什么需要webpack"><a class="markdownIt-Anchor" href="#10-为什么需要webpack">#</a> 1.0 为什么需要 webpack</h2>
<p>我们先回顾一下历史，在打包工具出现之前，我们是如何的在 web 网页中去使用 JavaScript 代码的？</p>
<p>我们先来看一个文档：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/ccc587ef51cc46698e0af80b7b414ee0%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>这是一个 html 文档，在这个文档中，我们共加载了 11 个 js 文件，这 11 个 js 文件，我们又可以分为两部分来看：</p>
<p><strong>第一部分：是引入的外部或者叫第三方的库以及框架文件</strong>。这里我们引入了 jquery lodash bootstrap 等等。jquery 和 lodash 是第三方的 js 库，可以提高我们项目的开发效率。bootstrap 是第三方的 U 框架，可以协助我们做页面的布局，以及交互等等。</p>
<p><strong>第二部分是我们自己的 JavaScript 文件，是项目的业务代码</strong>。比如 commonjs，一些公共的文件，user 用户相关的，authentication 授权相关的，像 product 产品，inventory 库存，payment 付款，checkout 结算，shipping 物流等等。可见，这是一个电商平台的一些 js 文件。</p>
<p>那么一般情况下，我们自己的业务代码可能会需要依赖上面的第三方的代码。根据我们 js<strong> 在浏览器上</strong>的加载特性，那么所有的<strong> js 代码，是从上至下来加载的</strong>。因此如果我们的业务代码，依赖上面的那些库，或者是框架代码，那么<strong>顺序一定不能颠倒</strong>。那假如我们把两组文件加载的顺序来颠倒一下，那么这个项目可能就崩溃掉了。这种传统的方式对我们开发人员来说的话，会有很大的开发的心智负担，代码也很难扩展。</p>
<p>我们把这些文件按照一些预定的顺序来合并到一个文件里，不就解决问题了吗？</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/cb25cf1271464d1fa4659712ff48395a%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>他只加载了一个 js 文件，这个文件包含了 11 个文件，虽然解决了我们上个页面加载多个 js 的问题，但可能会导致其他的问题：作用域问题、文件太大、可读性差、可维护性弱等。</p>
<p><strong>作用域问题</strong>：我们使用过 jquery lodash bootstrap 同学应该知道，这些库文件会分别在 window 对象上面来绑定全局的变量，比如 jqurey 可能会绑定 $，lodash 可能会绑定下滑线_等等。就连我们自己的业务文件，可能也会在全局上面绑定一些变量。这些变量会严重的污染我们的 window 对象，使我们的 window 对象变得臃肿，这就是变量的作用域问题。</p>
<p><strong>文件太大</strong>：如果我们 11 个文件分散加载，那么页面会随着文件的加载而逐渐来显示内容。可如果我们将这 11 个文件合并成一个 js 文件，那这个脚本会带来网络瓶颈，用户得等待一段时间才能看到页面的内容，会有短暂的白屏，用户体验非常差。</p>
<p><strong>可读性差、可维护性弱</strong>：如果我们把所有代码都合并在一个超大的文件里，那么对于程序的可读性以及可维护性就带来了灾难，最终是加重了我们编程人员的负担。</p>
<p>那如何解决这些问题？那我们接下来将继续研究。</p>
<h2 id="11-如何解决作用域问题"><a class="markdownIt-Anchor" href="#11-如何解决作用域问题">#</a> 1.1 如何解决作用域问题</h2>
<h3 id="iife"><a class="markdownIt-Anchor" href="#iife">#</a> IIFE</h3>
<p>早先前我们使用的是 grunt 以及 gulp 两个工具， 来管理我们的项目资源，这两个工具我们称之为任务执行器，他们是将所有的项目文件拼接在一起。其实事实上呢，是利用了 js 的立即调用函数表达式，（<strong>立即调用函数表达式 Immediately invoked function expressions IIFE</strong>）。这样就解决了大型项目的作用域问题。当脚本被封装在 IIFE 内部的时候，我们可以安全的拼接，或者是组合所有的文件了，而不必担心作用域冲突。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/bf87b47a713f48a7b2c3c5817f4ee1d2%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>那什么是 IIFE？<br>
<strong>IIFE 既解决了作用域的问题，又可以在外部去暴露我们想暴露的内容。</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/67c52d6415f54e9eac85acdd28706570%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>如果我们想要去修改我们两段代码里的一段代码，那么我们得需要重新编译这段代码。假如说我们这个代码呢有 10,000 行，但是我只改了一行，那么这个文件也会重新编译，或者说这个文件也会被同时的加载。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124030630893.png" alt="image-20220124030630893"></p>
<p>我们为了使用 lodash 的一个 join 方法，我们却把整个 lodash 这个大的库文件全都加载下来了。那么我们能不能想一个办法把这个文件给拆成一个一个的方法的模块呢？或者说，我们来实现一个这个方法的懒加载呢？如果是我们通过手工的方法来实现，那工作量可就大了，所以下个视频我们来研究如何的去实现代码的拆分。</p>
<h2 id="12-如何解决代码拆分问题"><a class="markdownIt-Anchor" href="#12-如何解决代码拆分问题">#</a> 1.2 如何解决代码拆分问题</h2>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/68a81036d8fc4e6f95d4cc3fc14749ca%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<h3 id="nodejs"><a class="markdownIt-Anchor" href="#nodejs">#</a> node.js</h3>
<p>我们先感谢一下<strong> node.js</strong>，它使 javascript 模块诞生了。我们知道 node.js 是一个 javascript 运行环境，我们可以在浏览器环境之外的计算机或者是服务器上使用它。</p>
<p>webpack 其实就是运行在 node.js 中的。</p>
<p>当 node.js 发布的时候，一个新的时代就开始了。</p>
<p>既然我们不是在浏览器中运行 javascript，那么现在就没有了可以添加到我们浏览器的 html 文件，以及我们编写的 script 标签了。那么 node.js 究竟是如何的去加载新的代码文件？</p>
<h3 id="commonjs"><a class="markdownIt-Anchor" href="#commonjs">#</a> common.js</h3>
<p><strong>common.js</strong> 的问世引入了一个叫做 require 的机制，他允许在我们当前的文件中，去加载和使用某个模块，导入需要的每个模块。这个开箱即用的功能帮助我们解决了代码的拆分问题。</p>
<p>我们通过代码来给大家演示一下。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/3f9d6bfa4803465195e7b7fd319a64b9%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>现在 node.js 俨然已经成为一种语言，一个平台，乃至快速开发和创建应用的一种方式了，他接管了我们整个 JavaScript 世界。</p>
<p>通过刚才的例子我们看到，虽然 commonjs 是 node.js 项目的绝佳模块拆分的解决方案，但是浏览器是不支持这个模块化的。我们在 node.js 里边开箱即用的一个加载模块的方法 require ()，在浏览器上失效了。</p>
<p>那我们该如何的解决这个何题？下一个小节我们再见。</p>
<h2 id="13-如何让浏览器支持模块"><a class="markdownIt-Anchor" href="#13-如何让浏览器支持模块">#</a> 1.3 如何让浏览器支持模块</h2>
<p>在早期，我们使用类似于像 browserify、requirejs 这样的打包工具分别来将 CommonJS、AMD 模块化语法的代码转换为能够在浏览器中运行的代码。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/48f2de866fbc4cd9baaae0f5f1d5ab3a%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>Webpack 可以帮助我们打包 javascript 的应用程序，并且同时支持 es 的模块化以及 commonjs，还可以扩展支持很多的静态资源打包，比如像图片、字体文件、样式文件等等。</p>
<h2 id="14-webpack与竞品"><a class="markdownIt-Anchor" href="#14-webpack与竞品">#</a> 1.4 webpack 与竞品</h2>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/8ae10067446243d883c46e17b6b5d340%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>下面我们来看一下 webpack、PARCEL、rollup.js、Vite 的 pk。</p>
<p><strong>PARCEL</strong> 号称是零配置，用户一般无需做其他的配置开箱即用。</p>
<p><strong>rollup.js</strong> 用标准化的格式来编写代码，比如像 es6，通过减少无用的代码，来尽可能的缩小包的体积。一般只能用来打包 js。</p>
<p>如果你想要构建一个简单的应用，并且让他快速的运行起来，那你可以使用 PARCEL。</p>
<p>如果你想要构建一个类库，只需要导入很少的第三方的库，那你可以使用 rollup。</p>
<p>如果你想要构建一个复杂的应用，并且想集成很多的第三方的库，并且还要拆分代码，还要使用静态的资源文件，还要支持 common.js、esmodule 等等，那只能是<strong> webpack</strong> 了。</p>
<p>最后的一匹黑马那就是<strong> Vite</strong>，在刚刚结束的这个 VueConf 2021 大会里边，除了 Vue3.0 以外，另外的一个亮点就是下一代的构建工具 Vite。Vite 将成为 Vue 的现代标配，甚至最近还推出了一个框架叫 petite Vue，从开发、编译、发布、demo，几乎全部都使用的是 Vite 来完成的。Vite 这种基于 esmodule 的构建方式，日益的受到了用户的青睐，不仅可以按需编译、热模块的更新等等，它还有其他的丝滑的开发体验，以及和 Vue3 的完美结合。</p>
<p>webpack、Vite 作为前端热门的工程化工具，他们各自有各自的使用场景，其实并不存在取代的这一说法。</p>
<hr>
<h1 id="第二章-小试webpack"><a class="markdownIt-Anchor" href="#第二章-小试webpack">#</a> 第二章：小试 webpack</h1>
<h2 id="21-开发准备"><a class="markdownIt-Anchor" href="#21-开发准备">#</a> 2.1 开发准备</h2>
<p>在进入 Webpack 世界之前，我们先来用原生的方法构建一个 web 应用。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//hello-world.js</span>
<span class="token keyword">function</span> <span class="token function">helloworld</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//index.js</span>
<span class="token function">helloworld</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">//index.html</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">></span>
<span class="token operator">&lt;</span>html<span class="token operator">></span>
    <span class="token operator">&lt;</span>head<span class="token operator">></span>
        <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>title<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span>
    <span class="token operator">&lt;</span>body<span class="token operator">></span>
        <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"./hello-world.js"</span> type<span class="token operator">=</span><span class="token string">"text/javascript"</span> charset<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
        <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"./index.js"</span> type<span class="token operator">=</span><span class="token string">"text/javascript"</span> charset<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>在浏览器中直接打开 index.html，控制台输出：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/1dd9180d1f984c6ba3dc500b515862c7%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>原始应用 存在的问题：如果 js 文件非常多，它们的引入顺序将难以维护。</p>
<h2 id="22-安装webpack"><a class="markdownIt-Anchor" href="#22-安装webpack">#</a> 2.2 安装 Webpack</h2>
<h3 id="安装nodejs"><a class="markdownIt-Anchor" href="#安装nodejs">#</a> 安装 Node.js</h3>
<p>在开始之前，请确保安装了 Node.js 的最新版本。使用 Node.js 最新的长期支持版本 (LTS -Long Term Support)，是理想的起步。使用旧版本，你可能遇到各种问题，因为它们可能缺少 webpack 功能，或者缺少相关 package。</p>
<p>检查 Node.js 是否安装成功：在命令行中，执行 <code>node -v</code> ，如果打印出版本号，则说明安装成功。</p>
<p>注意：Node.js V14 版本 只支持 Windows 8.1、Windows Server 2012 R2 或更高版本。Windows7 装不了？？？</p>
<p>Node.js 自带 <strong>npm</strong>。npm 全称为 node package manager，它是 node 的一个包管理工具。</p>
<p>检查 npm 版本： <code>npm -v</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/81efc79c3c4b46d3985bf84b2def8582%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>webpack 是基于 node 来开发的，所以安装 webpack 就得需要通过 npm。把我们的 webpack 当成是一个 node 的包，来进行安装和管理。</p>
<h3 id="安装webpack"><a class="markdownIt-Anchor" href="#安装webpack">#</a> 安装 webpack</h3>
<p>webpack 的安装有两种情况：一种我们可以在全局里安装 webpack，另一种我们可以在本地的工作目录下安装 webpack。</p>
<p>webpack 含两个包：一个是 webpack 主包，一个是 webpack-cli。</p>
<p>webpack-cli 表示我们可以在命令行里边执行 webpack 命令。</p>
<p><strong>1. 全局安装</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npm install webpack webpack<span class="token operator">-</span>cli <span class="token operator">--</span>global<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>全局安装的好处：可以让我们在任何的目录下面去执行 webpack。 检查是否安装成功：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">webpack <span class="token operator">-</span>v<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/8fe0d9cf0b774ec6ae9b849733c065fd%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>卸载全局的 webpack：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npm uninstall webpack webpack<span class="token operator">-</span>cli <span class="token operator">--</span>global<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><strong>2. 本地安装（推荐）</strong></p>
<p>我们并不推荐大家在全局里安装 webpack，因为这样会使你项目的 webpack 锁定到某个版本里，并且你在使用不同的 webpack 版本的项目里边可能会导致构建失败。另外还有一个问题，如果是一个团队协作的项目，你的小伙伴如果不知道在全局里安装 webpack，构建也会有问题。推荐大家还是在本地的工作目录下去安装 webpack。</p>
<p><strong>生成 包管理文件 package.json</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npm init <span class="token operator">-</span>y<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><strong>本地安装 webpack</strong></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npm install webpack webpack<span class="token operator">-</span>cli <span class="token operator">--</span>save<span class="token operator">-</span>dev<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>基本的目录结构如下：<br>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124030755217.png" alt="image-20220124030755217"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/05b4e702592e43d5a9281947a14dc44a%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<h2 id="23-运行webpack"><a class="markdownIt-Anchor" href="#23-运行webpack">#</a> 2.3 运行 Webpack</h2>
<p><strong>准备测试项目</strong></p>
<p>1. 使用 esmodule 模块化语法，编写以下测试代码。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//hello-world.js</span>

<span class="token keyword">function</span> <span class="token function">helloworld</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//导出模块</span>
<span class="token keyword">export</span> <span class="token punctuation">&#123;</span>
    helloworld
<span class="token punctuation">&#125;</span>

<span class="token comment">//index.js</span>

<span class="token comment">//导入模块</span>
<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> helloworld <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'./hello-world.js'</span>

<span class="token function">helloworld</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/f9f9be612ec849aab418f74e49dc26e3%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>2. 执行打包命令。<br>
在项目 根目录 命令行 执行:</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">webpack<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>3. 打包结果。<br>
报错了。 查看 webpack 打包信息：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">webpack <span class="token operator">--</span>stats detailed<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="方式1使用全局的webpack进行打包"><a class="markdownIt-Anchor" href="#方式1使用全局的webpack进行打包">#</a> 方式 1：使用全局的 webpack 进行打包</h3>
<p>直接执行打包命令  <code>webpack</code> ，默认会去使用全局安装的 webpack。如果全局没有安装 webpack，也不会使用本地的，而是会报错。</p>
<h3 id="方式2使用本地的webpack进行打包-推荐"><a class="markdownIt-Anchor" href="#方式2使用本地的webpack进行打包-推荐">#</a> 方式 2：使用本地的 webpack 进行打包 （推荐）</h3>
<p>需要使用一个新的工具<strong> npx</strong>，npx 依托于 npm，npm 自带 npx。 npx 的作用：观察我们当前文件夹里面有没有你想要去运行的这个命令，如果没有则往上一层父级目录中查找，如果有则执行。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npx webpack<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="24-自定义webpack配置"><a class="markdownIt-Anchor" href="#24-自定义webpack配置">#</a> 2.4 自定义 Webpack 配置</h2>
<p><strong>查看命令行参数</strong></p>
<p>实际上，webpack-cli 给我们提供了丰富的终端命令行指令，可以通过  <code>webpack --help</code>  来查看:</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124030847059.png" alt="image-20220124030847059"></p>
<h3 id="方式1命令行参数"><a class="markdownIt-Anchor" href="#方式1命令行参数">#</a> 方式 1：命令行参数</h3>
<p>1. 执行打包命令，同时添加一些参数，来自定义打包配置。<br>
<strong>npx webpack --entry ./src/js/index.js --mode production</strong></p>
<p>–entry 指定入口文件<br>
–mode 指定打包模式</p>
<p>2. 执行结果。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124030900202.png" alt="image-20220124030900202"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/5ccc165a1e294b769cb1c1fcc695b338%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>可以发现，打包成功，输出了一个目录 dist，以及一个文件 main.js。</p>
<p>缺点： 添加命令行参数的方式，不直观，也不方便，而且还不能保存下来。</p>
<h3 id="方式2配置文件推荐"><a class="markdownIt-Anchor" href="#方式2配置文件推荐">#</a> 方式 2：配置文件（推荐）</h3>
<p>1、在项目根目录中创建 <strong>webpack.config.js</strong> 文件。</p>
<p>注意：</p>
<ul>
<li>配置文件的名字不能修改，Node.js 会自动读取。</li>
<li>必须使用 CommonJS 模块化语法。</li>
</ul>
<p>2、编写配置文件内容。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/b6b526a8a78f4669b7a910d1a60e0a94%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">//指定入口文件</span>
    entry<span class="token operator">:</span> <span class="token string">'./src/js/index.js'</span><span class="token punctuation">,</span>
    <span class="token comment">//指定打包输出目录</span>
    output<span class="token operator">:</span><span class="token punctuation">&#123;</span>
        <span class="token comment">//指定输出文件名</span>
        filename<span class="token operator">:</span> <span class="token string">'bundle.js'</span><span class="token punctuation">,</span>
        <span class="token comment">//指定输出路径</span>
        path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./dist'</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    mode<span class="token operator">:</span> <span class="token string">'none'</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>path 模块<br>
 path.resolve () 方法<br>
__dirname 表示 webpack.config.js 所在的绝对路径。</p>
<p>3、执行打包命令：<strong>npx webpack</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124030938966.png" alt="image-20220124030938966"></p>
<p>4、打包结果。<br>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/838e3a85e4ee49da98e712aa87c45c2e%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124030956648.png" alt="image-20220124030956648"></p>
<p>可以看到，打包成功，输出了一个 dist/bundle.js 文件。</p>
<p>5、引入打包文件。<br>
在 index.html 中，引入打包文件 bundle.js。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//index.html</span>

<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">></span>
<span class="token operator">&lt;</span>html<span class="token operator">></span>
    <span class="token operator">&lt;</span>head<span class="token operator">></span>
        <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>title<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span>
    <span class="token operator">&lt;</span>body<span class="token operator">></span>
        <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"../dist/bundle.js"</span> type<span class="token operator">=</span><span class="token string">"text/javascript"</span> charset<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>6、浏览器执行。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124031007667.png" alt="image-20220124031007667"></p>
<p>可以看到，代码正常执行，也就说明 webpack 打包已经成功了。</p>
<p>缺点：在 html 文件中，手动引入打包文件，不方便，如何才能做自动引入呢？</p>
<hr>
<h1 id="第三章-自动引入资源"><a class="markdownIt-Anchor" href="#第三章-自动引入资源">#</a> 第三章：自动引入资源</h1>
<h2 id="31-什么是插件"><a class="markdownIt-Anchor" href="#31-什么是插件">#</a> 3.1 什么是插件</h2>
<p>webpadk 就像一条生产线，他要经过一系列的处理流程以后，才能将源文件转化成输出的结果。 入口文件 还可以依赖于其他的 js 模块，其中被依赖的 js 模块可能还依赖其他的 js 模块。并且 js 模块还可以引入 css 文件。</p>
<p>webpack 会把整个依赖的关系都记录下来，然后交给 webpadk 编译器。webpack 编译器经过加工以后会生成目标文件，比如 css 和 js 文件。</p>
<p>webpack 编译的过程需要应用一些工具来帮忙，这些工具可以帮助 webpack 来执行一些特定的任务，比如：打包优化、资原管理等等。这些工具就是我们所谓 plugins 插件。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/9ec5d15ca730421abcfeb5bef64ef7a7%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>webpack 插件有三种类型：<br>
1.Community 社区插件<br>
 2.Webpack 官方插件<br>
 3.Webpack Contrib 第三方插件</p>
<p>查看 webpack 有哪些插件？ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwebpack.js.org%2Fplugins%2F">webpack Plugins</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124031146526.png" alt="image-20220124031146526"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124031049517.png" alt="image-20220124031049517"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124031220328.png" alt="image-20220124031220328"></p>
<h2 id="32-使用htmlwebpackplugin"><a class="markdownIt-Anchor" href="#32-使用htmlwebpackplugin">#</a> 3.2 使用 HtmlWebpackPlugin</h2>
<h3 id="plugins选项"><a class="markdownIt-Anchor" href="#plugins选项">#</a> plugins 选项</h3>
<p><strong>webpack 中使用插件的步骤</strong>：<br>
0 . 安装插件。<br>
1 . webpack.config.js 中，添加一个 plugins 选项。<br>
2 . webpack.config.js 中，引入插件，再在 plugins 选项中，通过 new 来实例化插件的构造函数。<br>
3 . 实例化插件的构造函数时，可以传入一个配置对象，来进行一些插件配置。</p>
<p>1、首先安装插件：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npm install <span class="token operator">--</span>save<span class="token operator">-</span>dev html<span class="token operator">-</span>webpack<span class="token operator">-</span>plugin<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/50c78f8f7cd847fdab2cf00aa4a5ca0b%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>2、并且调整 webpack.config.js 文件:</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token comment">//引入插件</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    entry<span class="token operator">:</span> <span class="token string">'./src/js/index.js'</span><span class="token punctuation">,</span>
    output<span class="token operator">:</span><span class="token punctuation">&#123;</span>
        filename<span class="token operator">:</span> <span class="token string">'bundle.js'</span><span class="token punctuation">,</span>
        path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./dist'</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    mode<span class="token operator">:</span> <span class="token string">'none'</span><span class="token punctuation">,</span>
    <span class="token comment">//配置插件</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>3、打包:</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npx webpack<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>4、打包结果</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/909afeed1c3f48899e7715f4a674c4fe%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124031345241.png" alt="image-20220124031345241"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/fa7d1521713b49c5b3a4ced1104c74f9%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>可以看到，打包生成了一个新的文件 index.html，并且它自动引入了 bundle.js。</p>
<h3 id="插件的配置对象"><a class="markdownIt-Anchor" href="#插件的配置对象">#</a> 插件的配置对象</h3>
<p>HtmlWebpackPlugin 默认会创建一个新的空白的 html 文件，然后在 head 标签中，自动引入 bundle.js。如果我们想在我们自己的 html 文件的 body 标签中自动引入 bundle.js，该怎么办呢？</p>
<p>我们可以给插件传入一个配置对象，来对插件进行一些配置。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//webpack.config.js</span>

<span class="token operator">...</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
	entry<span class="token operator">...</span>
	output<span class="token operator">...</span>
	mode<span class="token operator">...</span>
	plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token comment">//配置对象</span>
                <span class="token comment">//指定html模板</span>
                template<span class="token operator">:</span> <span class="token string">'./index.html'</span><span class="token punctuation">,</span>
                <span class="token comment">//指定输出名字</span>
                filename<span class="token operator">:</span> <span class="token string">'app.html'</span><span class="token punctuation">,</span>
                <span class="token comment">//指定在body标签中引入打包文件</span>
                inject<span class="token operator">:</span> <span class="token string">'body'</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
	<span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="33-清理dist"><a class="markdownIt-Anchor" href="#33-清理dist">#</a> 3.3 清理 dist</h2>
<p>如何才能自动地将上一次打包的输出文件清除呢？ 在 output 选项，添加一个配置即可： <code>clean：true</code></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//webpack.config.js</span>

<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    entry<span class="token operator">:</span> <span class="token string">'./src/js/index.js'</span><span class="token punctuation">,</span>
    output<span class="token operator">:</span><span class="token punctuation">&#123;</span>
        filename<span class="token operator">:</span> <span class="token string">'bundle.js'</span><span class="token punctuation">,</span>
        path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">//自动删除上一次的打包文件</span>
        clean<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    mode<span class="token operator">:</span> <span class="token string">'none'</span><span class="token punctuation">,</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
            template<span class="token operator">:</span> <span class="token string">'./src/index.html'</span><span class="token punctuation">,</span>
            filename<span class="token operator">:</span> <span class="token string">'app.html'</span><span class="token punctuation">,</span>
            inject<span class="token operator">:</span> <span class="token string">'body'</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h1 id="第四章-搭建开发环境"><a class="markdownIt-Anchor" href="#第四章-搭建开发环境">#</a> 第四章：搭建开发环境</h1>
<h2 id="41-mode选项"><a class="markdownIt-Anchor" href="#41-mode选项">#</a> 4.1 mode 选项</h2>
<p>可以通过搭建一个开发环境（也称本地服务器）解决以下的重复性的人工问题，以提高开发效率：<br>
1. 手动在浏览器中打开 html 文件。<br>
2. 每次修改代码，需要手动重新执行打包命令。</p>
<p>mode 选项的作用：指定打包的模式。</p>
<p>‘development’ 表示开发模式。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">mode<span class="token operator">:</span> <span class="token string">'development'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="42-使用source-map"><a class="markdownIt-Anchor" href="#42-使用source-map">#</a> 4.2 使用 source map</h2>
<p>source-map 的作用：当 js 代码出错时，点击浏览器控制台右侧的报错行数，可以精确定位到源代码的出错位置，而不是打包文件中的出错位置，有助于我们调试代码。</p>
<p>配置文件中，添加一个<strong> devtool</strong> 选项。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">devtool<span class="token operator">:</span> <span class="token string">'inline-source-map'</span> <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="43-使用watch-mode"><a class="markdownIt-Anchor" href="#43-使用watch-mode">#</a> 4.3 使用 watch mode</h2>
<p>在每次编译代码时，手动运行 npx webpack 会显得很麻烦。如果才能修改源代码后，自动进行打包呢？</p>
<p>执行打包命令时，添加一个命令行参数<strong> watch</strong> 即可。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npx webpack <span class="token operator">--</span>watch<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>如果其中一个文件被更新，代码将被重新编译，所以你不必再去手动运行整个构建。</p>
<p>–watch 参数的作用：打包命令不会立即结束，而是光标一直在闪烁，只要修改源代码并且保存，就会自动重新执行打包，继续监听下一次修改。</p>
<p>Ctrl+C：可以终止命令行窗口中执行的命令。</p>
<h2 id="44-使用webpack-dev-server"><a class="markdownIt-Anchor" href="#44-使用webpack-dev-server">#</a> 4.4 使用 webpack-dev-server</h2>
<p><strong>webpack-dev-server</strong> 为你提供了一个基本的 web server，并且具有 live reloading (实时重新加载) 功能。</p>
<p>注意：<br>
1、需要手动创建 dist 目录。<br>
2、有时候自动打开浏览器后，在页面上看不到 dist 目录中的文件，需要手动在地址栏访问 app.html 文件。</p>
<p>1、先安装。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npm install <span class="token operator">--</span>save<span class="token operator">-</span>dev webpack<span class="token operator">-</span>dev<span class="token operator">-</span>server<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>2、修改配置文件，添加一个 devServer 选项，告知 dev server，从什么位置查找文件。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//...</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">//...</span>
    <span class="token comment">// dev-server</span>
    devServer<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">static</span><span class="token operator">:</span> <span class="token string">'./dist'</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>以上配置告知 webpack-dev-server ，将 dist 目录下的文件作为 web 服务的根目录。</p>
<p>提示：webpack-dev-server 在编译之后不会写入到任何输出文件。而是将 bundle 文件保留在内存中，然后将它们 serve 到 server 中，就好像它们是挂载在 server 根路径上的真实文件一样。</p>
<p>3、执行命令。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npx webpack serve<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>或</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npx webpack<span class="token operator">-</span>dev<span class="token operator">-</span>server <span class="token operator">--</span>open<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>或者</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npx webpack serve <span class="token operator">--</span>open<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>–open：自动打开浏览器，并访问 <a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A8080%2F">http://localhost:8080/</a> 页面。</p>
<p>4、在浏览器里可以直接访问 <a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A8080%2F">http://localhost:8080/</a> ，来查看页面。</p>
<p><strong>watch mode 和 webpack-dev-server 的区别</strong>：<br>
–watch：监听源文件的修改，自动执行打包命令。<br>
webpack-dev-server：不仅可以监听源文件的修改，自动执行打包命令。还可以自动刷新浏览器，方便查看最新的 js 代码的执行效果。</p>
<p>所以，后者完全可以取代前者来使用。</p>
<h2 id="小结"><a class="markdownIt-Anchor" href="#小结">#</a> 小结</h2>
<p>经过第 2、3、4 章的学习，我们在配置文件中，进行了以下的设置：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//webpack.config.js</span>

<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    entry<span class="token operator">:</span> <span class="token string">'./src/js/index.js'</span><span class="token punctuation">,</span>
    output<span class="token operator">:</span><span class="token punctuation">&#123;</span>
        filename<span class="token operator">:</span> <span class="token string">'bundle.js'</span><span class="token punctuation">,</span>
        path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        clean<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    mode<span class="token operator">:</span> <span class="token string">'development'</span><span class="token punctuation">,</span>
    devtool<span class="token operator">:</span> <span class="token string">'inline-source-map'</span><span class="token punctuation">,</span>
    devServer<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">static</span><span class="token operator">:</span> <span class="token string">'./dist'</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
            template<span class="token operator">:</span> <span class="token string">'./src/index.html'</span><span class="token punctuation">,</span>
            filename<span class="token operator">:</span> <span class="token string">'app.html'</span><span class="token punctuation">,</span>
            inject<span class="token operator">:</span> <span class="token string">'body'</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h1 id="第五章-资源模块"><a class="markdownIt-Anchor" href="#第五章-资源模块">#</a> 第五章：资源模块</h1>
<h2 id="51-资源模块介绍"><a class="markdownIt-Anchor" href="#51-资源模块介绍">#</a> 5.1 资源模块介绍</h2>
<p>到目前为止我们的项目只能加载 JS，那现在我们能不能尝试混合一些其他的资源呢？比如像 images，看看 webpack 是如何处理的？</p>
<p>其实 webpack 最出色的功能之一就是除了引入 js，还可以使用内置的资源模块  asset modules，来引入任何的其他类型资源。</p>
<p><strong>资源模块 (asset module)</strong> 是一种模块类型，它允许我们应用 Webpack 来打包其他资源文件（如字体，图标等）。</p>
<p><strong>资源模块类型 (asset module type)</strong>，通过添加 4 种新的模块类型，来替换所有这些 loader：</p>
<ul>
<li>asset/resource 导出一个单独的文件并导出 URL。</li>
<li>asset/inline 导出一个资源的 data URI。</li>
<li>asset/source 导出资源的源代码。</li>
<li>asset 在导出一个 data URI 和发送一个单独的文件之间自动选择。</li>
</ul>
<h2 id="52-resource资源"><a class="markdownIt-Anchor" href="#52-resource资源">#</a> 5.2 Resource 资源</h2>
<p>原理：</p>
<ul>
<li>js 文件中，import 导入图片等资源时，可以得到它的 url。</li>
<li>以 url 的方式来使用图片。</li>
<li>打包时，会把图片等资源以单独的文件的形式输出到 dist 目录中。</li>
</ul>
<h3 id="module选项"><a class="markdownIt-Anchor" href="#module选项">#</a> module 选项</h3>
<p>配置文件中，添加一个新的<strong> module</strong> 选项，来配置资源模块。</p>
<h3 id="rules选项"><a class="markdownIt-Anchor" href="#rules选项">#</a> rules 选项</h3>
<p><strong>rules</strong> 数组：里面可以配置多个对象，来去加载不同类型的文件。<br>
test 属性：值为一个正则表达式，指定要匹配的文件类型。<br>
type 属性：指定资源模块类型。</p>
<h3 id="处理图片资源"><a class="markdownIt-Anchor" href="#处理图片资源">#</a> 处理图片资源</h3>
<p>webpack 在打包时，如何处理图片模块呢？</p>
<p>原理：图片也可以看成一个 js 模块，在 js 文件中，可以对图片进行导入、使用和打包。</p>
<p>1、在入口文件中，使用 esmodule 模块化语法，引入图片。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/6ca54f9145d24557ab7634c202c3a5c6%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//index.js</span>

<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> helloworld <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'./hello-world.js'</span>

<span class="token comment">//导入图片</span>
<span class="token keyword">import</span> imgsrc <span class="token keyword">from</span> <span class="token string">'./assets/img-1.png'</span>

<span class="token function">helloworld</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">//imgsrc是图片的url</span>
<span class="token keyword">const</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span> 
img<span class="token punctuation">.</span>src <span class="token operator">=</span> imgsrc 
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>2、修改配置文件。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token operator">...</span>
    <span class="token comment">//配置资源模块</span>
    module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        rules<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token comment">//处理图片资源</span>
            <span class="token punctuation">&#123;</span>
                test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.png$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                type<span class="token operator">:</span> <span class="token string">'asset/resource'</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>3、执行打包命令。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npx webpack<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>注意：<br>
我在使用 webpack-dev-server 时，执行 npm install --save-dev webpack-dev-server 打包命令后，打包成功，但是访问 8080 端口时，无法访问页面，不知道为什么？所以，这里在配置文件中，注释掉 devServer 选项，就不使用本地服务器来自动编译和自动打开浏览器了。</p>
<p>4、查看打包结果。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124031440322.png" alt="image-20220124031440322"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/626a0e3487934f288215c638028bc374%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>5、查看浏览器执行效果。</p>
<p>复制打包输出的 html 文件的绝对路径，在浏览器地址栏中打开。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/e7915b6d06f748f48a064214c7c65ac0%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<h3 id="自定义输出目录和文件名"><a class="markdownIt-Anchor" href="#自定义输出目录和文件名">#</a> 自定义输出目录和文件名</h3>
<p>webpack 默认把图片资源打包到 dist 目录下，并且帮助我们自动的起好文件名。那我们能不能自己定义图片的输出目录和文件名呢？</p>
<p>有两种方法：</p>
<h4 id="方法1assetmodulefilename属性"><a class="markdownIt-Anchor" href="#方法1assetmodulefilename属性">#</a> 方法 1：assetModuleFilename 属性</h4>
<p>output 选项中，添加一个新的属性<strong> assetModuleFilename</strong>，可以指定图片的输出目录和文件名。</p>
<p>指定输出目录和文件名：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">output<span class="token operator">:</span><span class="token punctuation">&#123;</span>
    <span class="token operator">...</span>
    assetModuleFilename<span class="token operator">:</span> <span class="token string">'images/test.png'</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>但是我们不可能一一为每个资源都指定名字，所以需要设置成自动生成名字。 我们可以使用 webpack 系统自带的默认的生成文件名的方法：<br>
<strong>contenthash</strong> 表示根据文件的内容来生成一个哈希的字符串。<br>
<strong>ext</strong> 表示使用资源原来的扩展名。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">output<span class="token operator">:</span><span class="token punctuation">&#123;</span>
    <span class="token operator">...</span>
    assetModuleFilename<span class="token operator">:</span> <span class="token string">'images/[contenthash][ext]'</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="方法2generator属性"><a class="markdownIt-Anchor" href="#方法2generator属性">#</a> 方法 2：generator 属性</h4>
<p>配置方式和 assetModuleFilename 属性是一样的。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">...</span>
module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        rules<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">&#123;</span>
                test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.png$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                type<span class="token operator">:</span> <span class="token string">'asset/resource'</span><span class="token punctuation">,</span>
                <span class="token comment">//指定资源的输出路径和文件名</span>
                generator<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                    filename<span class="token operator">:</span> <span class="token string">'images/[contenthash][ext]'</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>注意：generator 属性优先级高于 assetModuleFilename 属性，如果两者同时设置了，则只有前者生效。</p>
<h2 id="53-inline资源"><a class="markdownIt-Anchor" href="#53-inline资源">#</a> 5.3 inline 资源</h2>
<p>原理：将资源文件（如 svg 图片）转换为 data uri，嵌入到 bundle.js，而没有单独输出成一个文件。</p>
<p>1. 引入 svg 图片。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/4c766267df724df184d9092a783b9316%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//index.js</span>

<span class="token operator">...</span>
<span class="token comment">//入口文件中，引入svg图片 </span>
<span class="token keyword">import</span> logosvg <span class="token keyword">from</span> <span class="token string">'../assets/webpack-logo.svg'</span>

<span class="token operator">...</span>

<span class="token keyword">const</span> img2 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span> 
img2<span class="token punctuation">.</span>style<span class="token punctuation">.</span>cssText <span class="token operator">=</span> <span class="token string">'width: 600px; height: 200px'</span>
img2<span class="token punctuation">.</span>src <span class="token operator">=</span> logosvg
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>img2<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>2. 修改配置文件。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">...</span>
module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token operator">...</span>
        <span class="token comment">//打包svg图片</span>
        <span class="token punctuation">&#123;</span>
            test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.svg$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            type<span class="token operator">:</span> <span class="token string">'asset/inline'</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>3. 打包。 <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/46e104a09a4346469f75b10ca6e637e2%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124031510237.png" alt="image-20220124031510237"></p>
<p>4. 浏览器查看效果。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/ea75b0adb13e4f51b5d794a95079723f%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<h2 id="54-source资源"><a class="markdownIt-Anchor" href="#54-source资源">#</a> 5.4 source 资源</h2>
<p>source 资源，导出资源的源代码。</p>
<p>特点：webpack 会将 asset/source 资源 的源代码 原样嵌入到 js 中，而不会单独输出成一个文件。</p>
<p>1. 修改配置文件，添加：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">...</span>
module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token operator">...</span>
        <span class="token comment">//打包asset/source资源，如txt</span>
        <span class="token punctuation">&#123;</span>
            test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.txt$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            type<span class="token operator">:</span> <span class="token string">'asset/source'</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>2. 引入 txt</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//example.txt</span>

hello webpack

<span class="token comment">//index.js</span>

<span class="token operator">...</span>

<span class="token comment">//导入txt</span>
<span class="token keyword">import</span> exampleTxt <span class="token keyword">from</span> <span class="token string">'../assets/example.txt'</span>

<span class="token operator">...</span>

<span class="token keyword">const</span> block <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
block<span class="token punctuation">.</span>textContent <span class="token operator">=</span> exampleTxt
block<span class="token punctuation">.</span>style<span class="token punctuation">.</span>cssText <span class="token operator">=</span> <span class="token string">'width: 200px; height: 200px; background: aliceblue'</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>block<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>3. 打包。</p>
<p>npx webpack</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/c69b400dd9c24b8597400be1ff504520%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/6c151464e2524208ada6b6e56fb9efe8%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>4. 浏览器执行效果。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124031532037.png" alt="image-20220124031532037"></p>
<h2 id="55-通用数据类型"><a class="markdownIt-Anchor" href="#55-通用数据类型">#</a> 5.5 通用数据类型</h2>
<p>通用资源类型 <code>asset</code> , 在导出一个 data URI 和发送一个单独的文件之间自动选择。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.jpg</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        type<span class="token operator">:</span> <span class="token string">'asset'</span> <span class="token comment">//设置通用数据类型</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>现在，webpack 将按照默认条件，自动地在 resource 和 inline 之间进行选择： 小于 8kb 的文件，将会视为 inline 模块类型，否则会被视为 resource 模块类型。</p>
<p>可以通过在 webpack 配置的 module rules 层级中，设置 Rule.parser.dataUrlCondition.maxSize 选项来修改阈值的大小。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">rules<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">&#123;</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.jpg</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        type<span class="token operator">:</span> <span class="token string">'asset'</span><span class="token punctuation">,</span>
        parser<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            dataUrlCondition<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                <span class="token comment">//设置阈值</span>
                maxSize<span class="token operator">:</span> <span class="token number">4</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token comment">// 4kb</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>1. 修改配置文件。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">...</span>
module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">&#123;</span>
            test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.png$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            <span class="token comment">//设置通用数据类型</span>
            type<span class="token operator">:</span> <span class="token string">'asset'</span><span class="token punctuation">,</span>
            generator<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                filename<span class="token operator">:</span> <span class="token string">'images/[contenthash][ext]'</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
            parser<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                dataUrlCondition<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                    <span class="token comment">//设置阈值</span>
                    maxSize<span class="token operator">:</span> <span class="token number">6</span><span class="token operator">*</span><span class="token number">1024</span> <span class="token comment">// 6kb</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token operator">...</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span>                              <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>2. 引入 png。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//index.js</span>

<span class="token comment">//导入png图片</span>
<span class="token keyword">import</span> imgsrc <span class="token keyword">from</span> <span class="token string">'../assets/pic1.png'</span> <span class="token comment">//4kb</span>
<span class="token keyword">import</span> img2src <span class="token keyword">from</span> <span class="token string">'../assets/pic2.png'</span> <span class="token comment">//13kb</span>

<span class="token keyword">const</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span> 
img<span class="token punctuation">.</span>src <span class="token operator">=</span> imgsrc 
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span>

<span class="token keyword">const</span> img2 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span> 
img2<span class="token punctuation">.</span>src <span class="token operator">=</span> img2src 
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>img2<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>3. 打包。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/95e189fe6ff441d98c895fb19bc2e910%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124031559351.png" alt="image-20220124031559351"></p>
<p>4. 浏览器执行效果。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/12acb16fe11e438d905d89d22556494e%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<h2 id="小结-2"><a class="markdownIt-Anchor" href="#小结-2">#</a> 小结</h2>
<p>webpad 给我们提供了四种资原类型，来加载除了 js 以外的资源，比如图片等。</p>
<p><strong>resource 资源</strong>：asset/resource。<br>
它可以生成一个单独的文件，并导出 url。这个 url 是个资源路径，可以在业务代码里边直接使用。</p>
<p><strong>inline 资源</strong>: asset/inline。<br>
它导出一个资源的 dataUrl。 比如可以将一个 svg 转换为一个 base64 编码的字符串，在业务代码中可以直接使用这个字符串。</p>
<p><strong>source 资源</strong>：asset/source。<br>
它可以导出资源的源代码。</p>
<p><strong>通用资源类型</strong>: asset。</p>
<p>经过前 5 章的学习，我们学会了以下配置：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    entry<span class="token operator">:</span> <span class="token string">'./src/js/index.js'</span><span class="token punctuation">,</span>
    output<span class="token operator">:</span><span class="token punctuation">&#123;</span>
        filename<span class="token operator">:</span> <span class="token string">'bundle.js'</span><span class="token punctuation">,</span>
        path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        clean<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token comment">//assetModuleFilename: 'images/[contenthash][ext]'</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    mode<span class="token operator">:</span> <span class="token string">'development'</span><span class="token punctuation">,</span>
    devtool<span class="token operator">:</span> <span class="token string">'inline-source-map'</span><span class="token punctuation">,</span>
    <span class="token comment">/* 
    devServer: &#123;
        static: './dist'
    &#125; */</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
            template<span class="token operator">:</span> <span class="token string">'./src/index.html'</span><span class="token punctuation">,</span>
            filename<span class="token operator">:</span> <span class="token string">'app.html'</span><span class="token punctuation">,</span>
            inject<span class="token operator">:</span> <span class="token string">'body'</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        rules<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">&#123;</span>
                test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.png$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                <span class="token comment">//type: 'asset/resource',</span>
                type<span class="token operator">:</span> <span class="token string">'asset'</span><span class="token punctuation">,</span>
                generator<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                    filename<span class="token operator">:</span> <span class="token string">'images/[contenthash][ext]'</span>
                <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
                parser<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                    dataUrlCondition<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                        maxSize<span class="token operator">:</span> <span class="token number">6</span><span class="token operator">*</span><span class="token number">1024</span> <span class="token comment">// 6kb</span>
                    <span class="token punctuation">&#125;</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
            <span class="token punctuation">&#123;</span>
                test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.svg$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                type<span class="token operator">:</span> <span class="token string">'asset/inline'</span><span class="token punctuation">,</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
            <span class="token punctuation">&#123;</span>
                test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.txt$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                type<span class="token operator">:</span> <span class="token string">'asset/source'</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h1 id="第六章-管理资源"><a class="markdownIt-Anchor" href="#第六章-管理资源">#</a> 第六章：管理资源</h1>
<h2 id="61-什么是loader"><a class="markdownIt-Anchor" href="#61-什么是loader">#</a> 6.1 什么是 loader</h2>
<p>实际上，webpack 除了资源模块以外，还可以通过 loader，去引入其他类型的文件。</p>
<p>webpack 本身只能理解和打包 js 和 json 文件，而 loader 可以让 webpack 去解析他的类型的文件，并且将这些文件<strong>转化</strong>为有效的模块，以供我们应用程序使用。</p>
<p>哪如何使用 loaders 呢？<br>
loader 定义有两个 module.rules 选项中重要的属性：<br>
<strong>test</strong> 属性：指定处理哪种类型的文件，通过正则表达式来匹配文件名。<br>
<strong>use</strong> 属性：指定使用哪个 loader 来处理。</p>
<h2 id="62-加载css"><a class="markdownIt-Anchor" href="#62-加载css">#</a> 6.2 加载 CSS</h2>
<h3 id="css-loader"><a class="markdownIt-Anchor" href="#css-loader">#</a> css-loader</h3>
<h3 id="style-loader"><a class="markdownIt-Anchor" href="#style-loader">#</a> style-loader</h3>
<p>less-loader、sass-loader、stylus-loader</p>
<p>为了在 JavaScript 模块中 import 一个 CSS 文件，你需要安装<strong> style-loader</strong> 和<strong> css-loader</strong>，并在 module 配置中添加这些 loader。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npm install <span class="token operator">--</span>save<span class="token operator">-</span>dev style<span class="token operator">-</span>loader css<span class="token operator">-</span>loader<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>修改配置文件。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token comment">//处理css文件</span>
        <span class="token punctuation">&#123;</span>
            test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span><span class="token string">'css-loader'</span><span class="token punctuation">]</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>注意：</p>
<ul>
<li>
<p>css-loader 和 style-loader 的区别：</p>
<p>css-loader：将 css 文件转换为有效的模块，使得 webpack 能够识别和打包。<br>
style-loader：会通过 js 代码，将 css 代码以 style 标签的形式插入到 html 中，使得其样式生效。</p>
</li>
<li>
<p>css-loader 和 style-loader 的顺序不能颠倒，先使用 css-loader，再使用 style-loader。</p>
</li>
<li>
<p>webpack 支持 loaders 的<strong>链式调用</strong>，上一个 loader 将转换后的代码传递给下一个 loader 继续进行处理，最后一个 loader 会转换为 js 代码，传递为 webpack。</p>
</li>
<li>
<p>use 数组 是<strong>从末尾到头部的顺序</strong>，依次使用 loader 进行处理的。</p>
</li>
</ul>
<p>1、安装 css-loader、style-loader。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124031722154.png" alt="image-20220124031722154"></p>
<p>2、修改配置文件。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">...</span>
module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token operator">...</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token operator">...</span>
        <span class="token comment">//处理css文件</span>
        <span class="token punctuation">&#123;</span>
            test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span><span class="token string">'css-loader'</span><span class="token punctuation">]</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>3、引入 css 文件。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//style.css</span>

<span class="token punctuation">.</span>hello<span class="token punctuation">&#123;</span>
    color<span class="token operator">:</span> red<span class="token punctuation">;</span>
    font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">40</span>px<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//index.js</span>

<span class="token comment">//导入css</span>
<span class="token keyword">import</span> <span class="token string">'../css/style.css'</span>
<span class="token operator">...</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>4、打包。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124031733974.png" alt="image-20220124031733974"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/17c5e35977d04873a15849de95c7fab9%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>5、浏览器执行效果。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124031751905.png" alt="image-20220124031751905"></p>
<h3 id="less-loader"><a class="markdownIt-Anchor" href="#less-loader">#</a> less-loader</h3>
<p>如何打包.sass、.less 文件呢？使用 less-loader。</p>
<p>1、安装 less-loader。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npm install less less<span class="token operator">-</span>loader <span class="token operator">--</span>save<span class="token operator">-</span>dev<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/443edddfa48c4cc9b1cc25d9b69ac1df%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>2、修改配置文件。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token comment">//处理css、less文件</span>
        <span class="token punctuation">&#123;</span> 
            test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(css|less)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> 
            use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span> <span class="token string">'less-loader'</span><span class="token punctuation">]</span> 
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>3、引入 less 文件。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//style2.less</span>

@backgroundColor<span class="token operator">:</span> pink<span class="token punctuation">;</span>
p<span class="token punctuation">&#123;</span>
    background<span class="token operator">-</span>color<span class="token operator">:</span> @backgroundColor<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//index.js</span>

<span class="token operator">...</span>
<span class="token comment">//导入less</span>
<span class="token keyword">import</span> <span class="token string">'../css/style2.less'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>4、打包。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/2878b364ceb34635b46f6c57972fed0d%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/b7c2a4967fff4a42957bc94078483136%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>5、浏览器执行效果。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/1cf756b792c248a7b8f6b3522dc782f5%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<h2 id="63-抽离和压缩css"><a class="markdownIt-Anchor" href="#63-抽离和压缩css">#</a> 6.3 抽离和压缩 CSS</h2>
<p>通过 <code>css-loader</code> 、 <code>style-loader</code> 、 <code>less-loader</code> ，可以将样式文件（.css、.less）文件转化为 js 代码，这些 js 代码会被合并到 bundle.js 中，它们会在执行时，创建 style 标签，将样式字符串包裹进 style 标签中，最后将 style 标签添加到 html 文件中，使得样式代码生效。</p>
<p>缺点：css 代码并没有单独输入成一个文件，容易导致 bundle.js 文件体积过大。</p>
<p>哪如何将 css 代码单独打包成一个文件呢？然后再通过 link 标签自动引入它呢？</p>
<h3 id="mini-css-extract-plugin"><a class="markdownIt-Anchor" href="#mini-css-extract-plugin">#</a> mini-css-extract-plugin</h3>
<p>在多数情况下，我们也可以进行压缩 CSS，以便在生产环境中节省加载时间，同时还可以将 CSS 文件抽离成一个单独的文件。</p>
<p>实现这个功能，需要 <strong>mini-css-extract-plugin</strong> 这个插件来帮忙。</p>
<p>该插件会将 CSS 提取到单独的文件中，为每个包含 CSS 的 JS 文件创建一个 CSS 文件，并且支持 CSS 和 SourceMaps 的按需加载。本插件基于 webpack v5 的新特性构建，并且需要 webpack 5 才能正常工作。</p>
<p>单独的 mini-css-extract-plugin 插件不会将这些 CSS 加载到页面中。 html-webpack-plugin 可以帮助我们自动生成 link 标签或者在创建 index.html 文件时使用 link 标签，自动引入打包输出的样式文件。</p>
<p>注意： <code>style-loader</code>  和 <code>mini-css-extract-plugin</code>  只能使用其中一个。</p>
<p>1、安装插件。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npm install mini<span class="token operator">-</span>css<span class="token operator">-</span>extract<span class="token operator">-</span>plugin <span class="token operator">--</span>save<span class="token operator">-</span>dev<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>2、修改配置文件。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mini-css-extract-plugin'</span><span class="token punctuation">)</span>

<span class="token operator">...</span>
module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token operator">...</span>
        <span class="token comment">//抽离css文件</span>
        <span class="token punctuation">&#123;</span>
            test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(css|less)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            use<span class="token operator">:</span> <span class="token punctuation">[</span>MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span><span class="token string">'css-loader'</span><span class="token punctuation">,</span><span class="token string">'less-loader'</span><span class="token punctuation">]</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>

plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token operator">...</span>
    <span class="token comment">//实例化MiniCssExtractPlugin</span>
    <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>指定输出目录</strong></p>
<p>如何指定 css 打包后的输出目录呢？实例化插件时，传入一个配置对象。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"mini-css-extract-plugin"</span><span class="token punctuation">)</span>
<span class="token operator">...</span>
plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token operator">...</span>
    <span class="token comment">//指定css输出目录</span>
    <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
        filename<span class="token operator">:</span> <span class="token string">'css/[contenthash].css'</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="css-minimizer-webpack-plugin"><a class="markdownIt-Anchor" href="#css-minimizer-webpack-plugin">#</a> css-minimizer-webpack-plugin</h3>
<p>发现文件并没有压缩和优化，为了压缩输出文件，请使用类似于 <strong>css-minimizer-webpack-plugin</strong> 这样的插件。</p>
<p>注意：<br>
1.css-minimizer-webpack-plugin 插件 需要 <strong>optimization</strong> 选项 中进行配置。<br>
2.css-minimizer-webpack-plugin 插件 一般在生产模式下使用。</p>
<p>1、安装插件。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npm install css<span class="token operator">-</span>minimizer<span class="token operator">-</span>webpack<span class="token operator">-</span>plugin <span class="token operator">--</span>save<span class="token operator">-</span>dev<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>2、修改配置文件。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">...</span>
<span class="token comment">//引入插件</span>
<span class="token keyword">const</span> CssMinimizerPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'css-minimizer-webpack-plugin'</span><span class="token punctuation">)</span>

<span class="token operator">...</span>
<span class="token comment">//生产模式</span>
mode<span class="token operator">:</span> <span class="token string">'production'</span>

<span class="token operator">...</span>
<span class="token comment">//优化配置</span>
optimization<span class="token operator">:</span><span class="token punctuation">&#123;</span>
    minimizer<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">CssMinimizerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="示例"><a class="markdownIt-Anchor" href="#示例">#</a> 示例</h3>
<p>1、安装 mini-css-extract-plugin、css-minimizer-webpack-plugin。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124031828214.png" alt="image-20220124031828214"> <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/598afced0a7347b3aad82ac1e47af045%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>2、修改配置文件。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">...</span>
<span class="token comment">//引入插件</span>
<span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mini-css-extract-plugin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> CssMinimizerPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'css-minimizer-webpack-plugin'</span><span class="token punctuation">)</span>

<span class="token operator">...</span>
<span class="token comment">//生产模式</span>
mode<span class="token operator">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>

<span class="token operator">...</span>
plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token comment">//实例化插件</span>
    <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
         <span class="token comment">//指定css输出目录</span>
        filename<span class="token operator">:</span> <span class="token string">'css/[contenthash].css'</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span>
        <span class="token operator">...</span>
        <span class="token comment">//抽离css文件</span>
        <span class="token punctuation">&#123;</span>
            test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(css|less)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            use<span class="token operator">:</span> <span class="token punctuation">[</span>MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span><span class="token string">'css-loader'</span><span class="token punctuation">,</span><span class="token string">'less-loader'</span><span class="token punctuation">]</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token comment">//优化配置</span>
optimization<span class="token operator">:</span><span class="token punctuation">&#123;</span>
    minimizer<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">CssMinimizerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>4、引入样式文件。</p>
<p>5、打包。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124031839683.png" alt="image-20220124031839683"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124031846507.png" alt="image-20220124031846507"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/85a212ae11084fa5b3287b2f03e38656%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>6、浏览器执行效果。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124031854740.png" alt="image-20220124031854740"></p>
<h2 id="64-加载images图像"><a class="markdownIt-Anchor" href="#64-加载images图像">#</a> 6.4 加载 images 图像</h2>
<p>css 文件中，如果某些 css 属性引用了图片，则 webpack 要如何进行打包呢？</p>
<p>其实，在第 5 章 资源模块中，webpack 通过内置的资源模块就可以打包 js 文件中引用的 png、svg、jpg 等图片。同样，也可以打包 css 文件中引用的图片。配置方法是一样的。</p>
<p>示例：<br>
1、css 文件引用图片。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//style.css</span>

<span class="token operator">...</span>
<span class="token punctuation">.</span>bg<span class="token operator">-</span>img<span class="token punctuation">&#123;</span>
    background<span class="token operator">-</span>image<span class="token operator">:</span> <span class="token function">url</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span>assets<span class="token operator">/</span>img<span class="token operator">-</span><span class="token number">1.</span>png<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>2、入口文件。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//index.js</span>

<span class="token comment">//导入css</span>
<span class="token keyword">import</span> <span class="token string">'../css/style.css'</span>

<span class="token keyword">const</span> block <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
block<span class="token punctuation">.</span>style<span class="token punctuation">.</span>cssText <span class="token operator">=</span> <span class="token string">'width: 200px; height: 200px;'</span>
block<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">'bg-img'</span><span class="token punctuation">)</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>block<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>3、配置文件。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">...</span>
module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">&#123;</span>
                test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.png$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                <span class="token comment">//type: 'asset/resource',</span>
                type<span class="token operator">:</span> <span class="token string">'asset'</span><span class="token punctuation">,</span>
                generator<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                    filename<span class="token operator">:</span> <span class="token string">'images/[contenthash][ext]'</span>
                <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
                parser<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                    dataUrlCondition<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                        maxSize<span class="token operator">:</span> <span class="token number">6</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token comment">// 6kb</span>
                    <span class="token punctuation">&#125;</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
            <span class="token punctuation">&#123;</span>
                test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.svg$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                type<span class="token operator">:</span> <span class="token string">'asset/inline'</span><span class="token punctuation">,</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>4、打包。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124031916008.png" alt="image-20220124031916008"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/0c690c2873e04f2bb64fed8c847bed1a%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>5、浏览器执行效果。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/a44bb18ff1c0428ba0885a59f8a37892%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<h2 id="65-加载fonts字体"><a class="markdownIt-Anchor" href="#65-加载fonts字体">#</a> 6.5 加载 fonts 字体</h2>
<p>那么，像字体这样的其他资源如何处理呢？使用 Asset Modules 可以接收并加载任何文件，然后将其输出到构建目录。这就是说，我们可以将它们用于任何类型的文件，也包括字体。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">...</span>
module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span>
        <span class="token operator">...</span>
        <span class="token comment">//处理字体文件</span>
        <span class="token punctuation">&#123;</span>
            test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(woff|woff2|eot|ttf|otf)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            type<span class="token operator">:</span> <span class="token string">'asset/resource'</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>示例：<br>
1、修改配置文件。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//处理字体文件</span>
<span class="token punctuation">&#123;</span>
    test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(woff|woff2|eot|ttf|otf)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    type<span class="token operator">:</span> <span class="token string">'asset/resource'</span><span class="token punctuation">,</span>
    <span class="token comment">//指定输出目录</span>
    generator<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        filename<span class="token operator">:</span> <span class="token string">'fonts/[contenthash][ext]'</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>2、引入字体。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//style.css</span>

<span class="token comment">/* 声明字体 */</span>
@font<span class="token operator">-</span>face <span class="token punctuation">&#123;</span>
    font<span class="token operator">-</span>family<span class="token operator">:</span> <span class="token string">'webfont'</span><span class="token punctuation">;</span>
    font<span class="token operator">-</span>display<span class="token operator">:</span> swap<span class="token punctuation">;</span>
    src<span class="token operator">:</span> <span class="token function">url</span><span class="token punctuation">(</span><span class="token string">'../font/webfont.eot'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">/* IE9 */</span>
    src<span class="token operator">:</span> <span class="token function">url</span><span class="token punctuation">(</span><span class="token string">'../font/webfont.eot?#iefix'</span><span class="token punctuation">)</span> <span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'embedded-opentype'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">/* IE6-IE8 */</span>
        <span class="token function">url</span><span class="token punctuation">(</span><span class="token string">'../font/webfont.woff2'</span><span class="token punctuation">)</span> <span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'woff2'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">url</span><span class="token punctuation">(</span><span class="token string">'../font/webfont.woff'</span><span class="token punctuation">)</span> <span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'woff'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">/* chrome、firefox */</span>
        <span class="token function">url</span><span class="token punctuation">(</span><span class="token string">'../font/webfont.ttf'</span><span class="token punctuation">)</span> <span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'truetype'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">/* chrome、firefox、opera、Safari, Android, iOS 4.2+*/</span>
        <span class="token function">url</span><span class="token punctuation">(</span><span class="token string">'../font/webfont.svg#webfont'</span><span class="token punctuation">)</span> <span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'svg'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">/* iOS 4.1- */</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/* 使用字体 */</span>
<span class="token punctuation">.</span>fun <span class="token punctuation">&#123;</span>
    font<span class="token operator">-</span>family<span class="token operator">:</span> <span class="token string">"webfont"</span> <span class="token operator">!</span>important<span class="token punctuation">;</span>
    font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">16</span>px<span class="token punctuation">;</span>
    font<span class="token operator">-</span>style<span class="token operator">:</span> normal<span class="token punctuation">;</span>
    <span class="token operator">-</span>webkit<span class="token operator">-</span>font<span class="token operator">-</span>smoothing<span class="token operator">:</span> antialiased<span class="token punctuation">;</span>
    <span class="token operator">-</span>moz<span class="token operator">-</span>osx<span class="token operator">-</span>font<span class="token operator">-</span>smoothing<span class="token operator">:</span> grayscale<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>3、打包。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124031930569.png" alt="image-20220124031930569"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/1319f328a79b41dcbf6454ca37a165f0%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>4、浏览器执行效果。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/e7546f835444415e8c52fad80f68869f%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<h2 id="66-加载数据"><a class="markdownIt-Anchor" href="#66-加载数据">#</a> 6.6 加载数据</h2>
<h3 id="csv-loader"><a class="markdownIt-Anchor" href="#csv-loader">#</a> csv-loader</h3>
<h3 id="xml-loader"><a class="markdownIt-Anchor" href="#xml-loader">#</a> xml-loader</h3>
<p>此外，可以加载的有用资源还有数据，如 JSON 文件，CSV、TSV 和 XML。类似于 NodeJS，JSON 支持实际上是内置的，也就是说 import Data from ‘./data.json’ 默认将正常运行。要导入 CSV、TSV 和 XML，你可以使用 <strong>csv-loader</strong> 和 <strong>xml-loader</strong> 来加载这三类文件。</p>
<p>1、安装 csv-loader、xml-loader。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npm install <span class="token operator">--</span>save<span class="token operator">-</span>dev csv<span class="token operator">-</span>loader xml<span class="token operator">-</span>loader<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/bbc78c993a7948c6b5bba1ae3504a858%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>2、修改配置文件。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token punctuation">&#123;</span>
    test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(csv|tsv)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'csv-loader'</span><span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#123;</span>
    test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.xml$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'xml-loader'</span><span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>3、现在，你可以 import 这四种类型的数据 (JSON, CSV, TSV, XML) 中的任何一种，所导入的 Data 变量，将包含可直接使用的已解析 JSON。<strong>.xml 文件转化为一个 JS 对象， .cvs 转化为一个数组。</strong></p>
<p>示例：<br>
1、引入 xml、csv。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//test.xml</span>

<span class="token operator">&lt;</span><span class="token operator">?</span>xml version<span class="token operator">=</span><span class="token string">"1.0"</span> encoding<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">?</span><span class="token operator">></span> 
<span class="token operator">&lt;</span>note<span class="token operator">></span> 
    <span class="token operator">&lt;</span>to<span class="token operator">></span>Mary<span class="token operator">&lt;</span><span class="token operator">/</span>to<span class="token operator">></span> 
    <span class="token operator">&lt;</span>from<span class="token operator">></span>John<span class="token operator">&lt;</span><span class="token operator">/</span>from<span class="token operator">></span> 
    <span class="token operator">&lt;</span>heading<span class="token operator">></span>Reminder<span class="token operator">&lt;</span><span class="token operator">/</span>heading<span class="token operator">></span> 
    <span class="token operator">&lt;</span>body<span class="token operator">></span>Call Cindy on Tuesday<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span> 
<span class="token operator">&lt;</span><span class="token operator">/</span>note<span class="token operator">></span>

<span class="token comment">//test2.csv</span>

to<span class="token punctuation">,</span>from<span class="token punctuation">,</span>heading<span class="token punctuation">,</span>body 
Mary<span class="token punctuation">,</span>John<span class="token punctuation">,</span>Reminder<span class="token punctuation">,</span>Call Cindy on Tuesday 
Zoe<span class="token punctuation">,</span>Bill<span class="token punctuation">,</span>Reminder<span class="token punctuation">,</span>Buy orange juice 
Autumn<span class="token punctuation">,</span>Lindsey<span class="token punctuation">,</span>Letter<span class="token punctuation">,</span><span class="token constant">I</span> miss you

<span class="token comment">//index.js</span>

<span class="token comment">//导入xml</span>
<span class="token keyword">import</span> xmlData <span class="token keyword">from</span> <span class="token string">'../data/test.xml'</span>
<span class="token comment">//导入csv</span>
<span class="token keyword">import</span> csvData <span class="token keyword">from</span> <span class="token string">'../data/test2.csv'</span>

<span class="token operator">...</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xmlData<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>csvData<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>2、修改配置文件。 3、打包。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124031947071.png" alt="image-20220124031947071"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/a48894c592e04a219df80f9f4e58e8fd%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>4、浏览器执行效果。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124031954929.png" alt="image-20220124031954929"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124032656999.png" alt="image-20220124032656999"></p>
<h2 id="67-自定义json模块parser"><a class="markdownIt-Anchor" href="#67-自定义json模块parser">#</a> 6.7 自定义 JSON 模块 parser</h2>
<p><strong>yaml</strong> 文件我们在做项目过程中经常的看到，它有 key、value，同时通过缩进来去完成子项的设置。注意：yaml 文件只能用空格来缩进，而不能用 Tab 键。</p>
<p><strong>toml</strong> 相比较 yaml 就会好一些，不是通过缩进而是通过一个 key 等于 value 的方式。如果有子项，则通过一个中括号来定义。</p>
<p><strong>json5</strong> 格式 是对 json 格式的一个升级。json 格式不能使用注释，并且 key 必须使用双引号。json5 中 key 可以不使用引号，value 可以使用单引号，还可以使用 /n、/r 等等。</p>
<p>webpack 中，如何处理 yaml、toml、json5 文件呢？</p>
<p>通过使用 <strong>自定义 parser</strong> 替代特定的 webpack loader，可以将任何 toml 、 yaml 或 json5 文件作为 JSON 模块导入。</p>
<p>1、首先安装 toml、 yamljs、json5 的 packages。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npm install toml yamljs json5 <span class="token operator">--</span>save<span class="token operator">-</span>dev<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/daf6e59b12f642bd9e9b926302704372%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>2、配置。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> toml <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'toml'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> yaml <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'yamljs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> json5 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'json5'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token comment">//处理toml、yaml、json5</span>
        <span class="token punctuation">&#123;</span>
            test<span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.toml$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            type<span class="token operator">:</span> <span class="token string">'json'</span><span class="token punctuation">,</span>
            parser<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                parse<span class="token operator">:</span> toml<span class="token punctuation">.</span>parse
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span>
            test<span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.yaml$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            type<span class="token operator">:</span> <span class="token string">'json'</span><span class="token punctuation">,</span>
            parser<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                parse<span class="token operator">:</span> yaml<span class="token punctuation">.</span>parse
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span>
            test<span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.json5$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            type<span class="token operator">:</span> <span class="token string">'json'</span><span class="token punctuation">,</span>
            parser<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                parse<span class="token operator">:</span> json5<span class="token punctuation">.</span>parse
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>3、引入 toml、yaml、json5。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//data.toml</span>

title <span class="token operator">=</span> <span class="token string">"TOML Example"</span>

<span class="token punctuation">[</span>owner<span class="token punctuation">]</span>
name <span class="token operator">=</span> <span class="token string">"Tom Preston-Werner"</span>
organization <span class="token operator">=</span> <span class="token string">"GitHub"</span>
bio <span class="token operator">=</span> <span class="token string">"GitHub Cofounder &amp; CEO\nLikes tater tots and beer."</span>
dob <span class="token operator">=</span> <span class="token number">1979</span><span class="token operator">-</span><span class="token number">05</span><span class="token operator">-</span><span class="token number">27</span>T07<span class="token operator">:</span><span class="token number">32</span><span class="token operator">:</span><span class="token number">00</span>Z

<span class="token comment">//data.yaml</span>

title<span class="token operator">:</span> <span class="token constant">YAML</span> Example
owner<span class="token operator">:</span>
	name<span class="token operator">:</span> Tom Preston<span class="token operator">-</span>Werner
	organization<span class="token operator">:</span> GitHub
	bio<span class="token operator">:</span> <span class="token operator">|</span><span class="token operator">-</span>
		GitHub Cofounder <span class="token operator">&amp;</span> <span class="token constant">CEO</span>
		Likes tater tots and beer<span class="token punctuation">.</span>
	dob<span class="token operator">:</span> <span class="token number">1979</span><span class="token operator">-</span><span class="token number">05</span><span class="token operator">-</span><span class="token number">27</span>T07<span class="token operator">:</span><span class="token number">32</span><span class="token operator">:</span><span class="token number">00.000</span>Z

<span class="token comment">//data.json5</span>

<span class="token punctuation">&#123;</span>
    <span class="token comment">//comment</span>
    title<span class="token operator">:</span> <span class="token string">'JSON5 Example'</span><span class="token punctuation">,</span>
    owner<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        name<span class="token operator">:</span> <span class="token string">'Tom Preston-Werner'</span><span class="token punctuation">,</span>
        organization<span class="token operator">:</span> <span class="token string">'GitHub'</span><span class="token punctuation">,</span>
        bio<span class="token operator">:</span> <span class="token string">'GitHub Cofounder &amp; CEO\n\
                                Likes tater tots and beer.'</span><span class="token punctuation">,</span>
        dob<span class="token operator">:</span> <span class="token string">'1979-05-27T07:32:00.000Z'</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//index.js</span>

<span class="token comment">//导入toml、yaml、json5</span>
<span class="token keyword">import</span> toml <span class="token keyword">from</span> <span class="token string">'../json/data.toml'</span>
<span class="token keyword">import</span> yaml <span class="token keyword">from</span> <span class="token string">'../json/data.yaml'</span>
<span class="token keyword">import</span> json5 <span class="token keyword">from</span> <span class="token string">'../json/data.json5'</span>


console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>toml<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>toml<span class="token punctuation">.</span>title<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>toml<span class="token punctuation">.</span>owner<span class="token punctuation">.</span>name<span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>yaml<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>yaml<span class="token punctuation">.</span>title<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>yaml<span class="token punctuation">.</span>owner<span class="token punctuation">.</span>name<span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>json5<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>json5<span class="token punctuation">.</span>title<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>json5<span class="token punctuation">.</span>owner<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>4、打包。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npx webpack<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/c80a5824246f4a3eb333d7254b3f13b3%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/2834e47c826a451dafcd880052067294%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>5、浏览器执行效果。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/de1d73a2c57b4911a92eacd8042c281d%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/36e61f2e31d84b3c97b7c4e9d34fbb3a%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<hr>
<h1 id="第七章-使用babel-loader"><a class="markdownIt-Anchor" href="#第七章-使用babel-loader">#</a> 第七章：使用 babel-loader</h1>
<h2 id="71-为什么需要babel-loader"><a class="markdownIt-Anchor" href="#71-为什么需要babel-loader">#</a> 7.1 为什么需要 babel-loader</h2>
<p>webpack 自身可以自动加载 JS 文件，就像加载 JSON 文件一样，无需任何 loader。可是，加载的 JS 文件会原样输出，即使你的 JS 文件里包含 ES6 + 的代码，也不会做任何的转化。</p>
<p>低版本浏览器可能不支持最新的 JS 语法。该怎么办呢？</p>
<p>这时我们就需要<strong> Babel</strong> 来帮忙。Babel 是一个 JavaScript 编译器，可以将 ES6 + 转化成 ES5。在 Webpack 里使用 Babel，需要使用 babel-loader。</p>
<h2 id="72-使用babel-loader"><a class="markdownIt-Anchor" href="#72-使用babel-loader">#</a> 7.2 使用 babel-loader</h2>
<p>1、安装<strong> babel-loader</strong>、<strong>@babel/core</strong>、<strong>@babel/preset-env</strong>。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npm install <span class="token operator">-</span><span class="token constant">D</span> babel<span class="token operator">-</span>loader @babel<span class="token operator">/</span>core @babel<span class="token operator">/</span>preset<span class="token operator">-</span>env<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>babel-loader: 在 webpack 里应用 babel 解析 ES6 的桥梁。<br>
@babel/core: babel 核心模块。<br>
@babel/preset-env: babel 预设，一组 babel 插件的集合。</p>
<p>2、安装 <strong>@babel/runtime</strong>。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npm install <span class="token operator">--</span>save @babel<span class="token operator">/</span>runtime<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>@babel/runtime 中包含了 <strong>regeneratorRuntime</strong>，运行时需要（运行时依赖 ）。</p>
<p>3、安装 <strong>@babel/plugin-transform-runtime</strong>。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npm install <span class="token operator">-</span><span class="token constant">D</span> @babel<span class="token operator">/</span>plugin<span class="token operator">-</span>transform<span class="token operator">-</span>runtime<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>作用：在需要 regeneratorRuntime 的地方，自动 require 导包。编译时需要（开发依赖）。<br>
它是 babel-loader 的一个插件，需要在 options.plugins 选项中进行配置。</p>
<p>3、配置。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span> 
        <span class="token punctuation">&#123;</span>
            test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            use<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                loader<span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
                options<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                    presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@babel/preset-env'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
                        <span class="token punctuation">[</span>
                            <span class="token string">'@babel/plugin-transform-runtime'</span>
                        <span class="token punctuation">]</span>
                    <span class="token punctuation">]</span>
               <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>exclude 选项</strong> ：node_modules 目录中第三方库的 js 文件不需要 babel 来进行转换，使用 exclude 选项来排除。</p>
<p><strong>options 选项</strong> ：loader 的配置对象。</p>
<h2 id="73-regeneratorruntime插件"><a class="markdownIt-Anchor" href="#73-regeneratorruntime插件">#</a> 7.3 regeneratorRuntime 插件</h2>
<p>示例：</p>
<p>1、入口文件。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//test.js</span>

<span class="token keyword">function</span> <span class="token function">getString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
            <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'hello,world!'</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">helloWorld</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">let</span> string <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//导出函数</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> helloWorld

<span class="token comment">//index.js</span>

<span class="token keyword">import</span> helloWorld <span class="token keyword">from</span> <span class="token string">'./test.js'</span>
<span class="token function">helloWorld</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>2、打包。</p>
<p>3、浏览器执行效果。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/0405e9ec23d04bd8afc12c518a2d92fb%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<hr>
<h1 id="第八章-代码分离"><a class="markdownIt-Anchor" href="#第八章-代码分离">#</a> 第八章：代码分离</h1>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/0feed874047d42c7b13a49938e581861%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>代码分离是 webpack 中最引人注目的特性之一。<strong>此特性能够把代码分离到不同的 bundle 中，然后可以按需加载或并行加载这些文件。代码分离可以用于获取更小的 bundle，以及控制资源加载优先级，如果使用合理，会极大减少加载时间。</strong></p>
<p>常用的代码分离方法有三种：</p>
<ul>
<li>入口起点：使用 <a href="https://link.juejin.cn?target=https%3A%2F%2Fwebpack.docschina.org%2Fconfiguration%2Fentry-context">entry</a> 配置手动地分离代码。</li>
<li>防止重复：使用 <a href="https://link.juejin.cn?target=https%3A%2F%2Fwebpack.docschina.org%2Fconfiguration%2Fentry-context%2F%23dependencies">Entry dependencies</a> 或者 <a href="https://link.juejin.cn?target=https%3A%2F%2Fwebpack.docschina.org%2Fplugins%2Fsplit-chunks-plugin">SplitChunksPlugin</a> 去重和分离 chunk。</li>
<li>动态导入：通过模块的内联函数调用来分离代码。</li>
</ul>
<h2 id="82-入口起点"><a class="markdownIt-Anchor" href="#82-入口起点">#</a> 8.2 入口起点</h2>
<p>这是迄今为止最简单直观的分离代码的方式。不过，这种方式手动配置较多，并有一些隐患，我们将会解决这些问题。先来看看如何从 main bundle 中分离 another module (另一个模块)：</p>
<p>bundle：指打包输出的文件。</p>
<p>1、安装 lodash。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npm install lodash <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>2、在 src 目录下创建 another-module.js 文件。</p>
<p>这两个 js 文件都使用了 lodash 库，都作为入口文件。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//another-module.js</span>

<span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">'lodash'</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Another'</span><span class="token punctuation">,</span> <span class="token string">'module'</span><span class="token punctuation">,</span> <span class="token string">'loaded!'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">//index.js</span>

<span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">'lodash'</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'index'</span><span class="token punctuation">,</span> <span class="token string">'module'</span><span class="token punctuation">,</span> <span class="token string">'loaded!'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>3、<strong>配置多入口</strong>。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">entry<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    index<span class="token operator">:</span> <span class="token string">'./src/js/index.js'</span><span class="token punctuation">,</span>
    another<span class="token operator">:</span> <span class="token string">'./src/js/another-module.js'</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
output<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    filename<span class="token operator">:</span> <span class="token string">'[name].bundle.js'</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>4、打包。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/af192e1f3a284b83851dd4c767446227%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124032101004.png" alt="image-20220124032101004"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/52dbe3688e7940e68faf25562f610cee%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>5、结论。<br>
1、打包输出了两个 bundle：index.bundle.js、another.bundle.js。它们都被自动引入 html 中，浏览器执行正常。说明多入口配置成功。<br>
2、<strong>这种方式的确存在一些隐患</strong>：<br>
● 如果入口 chunk 之间包含一些重复的模块，那些重复模块都会被引入到各个 bundle 中。<br>
● 这种方法不够灵活，并且不能动态地将核心应用程序逻辑中的代码拆分出来。</p>
<h2 id="83-防止重复"><a class="markdownIt-Anchor" href="#83-防止重复">#</a> 8.3 防止重复</h2>
<h3 id="入口依赖"><a class="markdownIt-Anchor" href="#入口依赖">#</a> 入口依赖</h3>
<p>配置 <a href="https://link.juejin.cn?target=https%3A%2F%2Fwebpack.docschina.org%2Fconfiguration%2Fentry-context%2F%23dependencies">dependOn option</a> 选项，这样可以在多个 chunk 之间共享模块。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">entry<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    index<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">import</span><span class="token operator">:</span> <span class="token string">'./src/js/index.js'</span><span class="token punctuation">,</span>
        dependOn<span class="token operator">:</span> <span class="token string">'shared'</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    another<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">import</span><span class="token operator">:</span> <span class="token string">'./src/js/another-module.js'</span><span class="token punctuation">,</span>
        dependOn<span class="token operator">:</span> <span class="token string">'shared'</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    shared<span class="token operator">:</span> <span class="token string">'lodash'</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
output<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    filename<span class="token operator">:</span> <span class="token string">'[name].bundle.js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    clean<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>示例：<br>
1、配置。<br>
2、打包。<br>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/8a199fa3229b4a18970e0838777f138a%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124032112714.png" alt="image-20220124032112714"></p>
<p>3、结论。<br>
index.bundle.js 与 another.bundle.js 共享的模块 lodash.js 被打包到一个单独的文件 shared.bundle.js 中。</p>
<h3 id="splitchunksplugin"><a class="markdownIt-Anchor" href="#splitchunksplugin">#</a> SplitChunksPlugin</h3>
<p>SplitChunksPlugin 是 webpack 内置的一个插件。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwebpack.docschina.org%2Fplugins%2Fsplit-chunks-plugin">SplitChunksPlugin</a> 插件可以自动地将公共的依赖模块提取到已有的入口 chunk 中，或者提取到一个新生成的 chunk。</p>
<p>1、配置。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">entry<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    index<span class="token operator">:</span> <span class="token string">'./src/js/index.js'</span><span class="token punctuation">,</span>
    another<span class="token operator">:</span> <span class="token string">'./src/js/another-module.js'</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
output<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    filename<span class="token operator">:</span> <span class="token string">'[name].bundle.js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    clean<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
optimization<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token operator">...</span>
    splitChunks<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        chunks<span class="token operator">:</span> <span class="token string">'all'</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>2、打包。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/b6d22a5e58c842b493ac036561975a68%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/88870fdff3ec47dfb0440fcc970bf482%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>3、结论。</p>
<p>使用 <strong>optimization.splitChunks</strong> 配置选项之后，现在应该可以看出，index.bundle.js 和 another.bundle.js 中已经移除了重复的依赖模块。需要注意的是，插件将 lodash 分离到单独的 chunk，并且将其从 main bundle 中移除，减轻了大小。</p>
<h2 id="84-动态导入"><a class="markdownIt-Anchor" href="#84-动态导入">#</a> 8.4 动态导入</h2>
<p>当涉及到动态代码拆分时，webpack 提供了两个类似的技术。第一种，也是推荐选择的方式是，使用符合 ECMAScript 提案 的 <strong>import()</strong> 语法 来实现动态导入。第二种，则是 webpack 的遗留功能，使用 webpack 特定的 <strong>require.ensure</strong> 。</p>
<h3 id="import"><a class="markdownIt-Anchor" href="#import">#</a> import()</h3>
<p>静态导入： 全局作用域中执行 import ()。<br>
动态导入： 函数作用域中执行 import ()。</p>
<p>1、创建 async-module.js 文件。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">getComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'loadsh'</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">&#123;</span><span class="token keyword">default</span><span class="token operator">:</span> _<span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">const</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
            element<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Hello'</span><span class="token punctuation">,</span> <span class="token string">'webpack'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> element
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token string">'An error occurred while loading the component'</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>

<span class="token function">getComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">component</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>component<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>2、配置。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">optimization<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    splitChunks<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        chunks<span class="token operator">:</span> <span class="token string">'all'</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>3、在入口文件中导入。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//index.js</span>

<span class="token keyword">import</span> <span class="token string">'./async-module.js'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>4、打包、浏览器执行效果。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/99412fa9c3df470d9654bdfd33986bca%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124032138497.png" alt="image-20220124032138497"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/338eff7e9f694472bb2b1247d8d67084%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>4、结论。<br>
我们看到，静态和动态载入的模块都正常工作了。而且它们公共的 lodash 模块也被单独打包成一个文件。（another-module.js 中静态导入 lodash， async-module.js 中动态导入 lodash）</p>
<h2 id="85-懒加载"><a class="markdownIt-Anchor" href="#85-懒加载">#</a> 8.5 懒加载</h2>
<p>懒加载或者按需加载，是一种很好的优化网页或应用的方式。这种方式实际上是先把你的代码在一些逻辑断点处分离开，然后在一些代码块中完成某些操作后，立即引用或即将引用另外一些新的代码块。这样加快了应用的初始加载速度，减轻了它的总体体积，因为某些代码块可能永远不会被加载。</p>
<p>懒加载 是动态导入的一种应用场景。</p>
<p>1、创建一个 math.js 文件，在主页面中通过点击按钮调用其中的函数。<br>
我们希望 math.js 文件是懒加载的。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// math.js</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y
<span class="token punctuation">&#125;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">minus</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> x <span class="token operator">-</span> y
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>2、编辑 index.js 文件。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//index.js</span>
<span class="token keyword">const</span> button <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'button'</span><span class="token punctuation">)</span> 
button<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token string">'点击执行加法运算'</span>
button<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span>
    <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName: 'math' */</span> <span class="token string">'./math.js'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">&#123;</span> add <span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>

document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>button<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这里有句注释，我们把它称为 webpack 魔法注释：  <code>webpackChunkName: 'math'</code> ，告诉 webpack 打包生成的文件名为 math 。</p>
<p>3、打包。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124032152535.png" alt="image-20220124032152535"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/629a93563ff64cb89ffbc4aa09967e70%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>4、启动服务，在浏览器上查看。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124032202926.png" alt="image-20220124032202926"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/53297ed871bf4c1fa6f2fd4840332128%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>5、结论。</p>
<ul>
<li>懒加载模块（ math.js）被单独打包成一个文件。</li>
<li>页面第一次加载时，不会立即加载懒加载模块。点击按钮时，浏览器才会向服务器请求 懒加载模块（ math.js）。可以节省用户的网络的流量。</li>
</ul>
<h2 id="86-预获取-预加载模块"><a class="markdownIt-Anchor" href="#86-预获取-预加载模块">#</a> 8.6 预获取、预加载模块</h2>
<p><strong>预获取</strong>、<strong>预加载</strong> 是 <strong>动态导入</strong> 的第二个应用场景。</p>
<p>Webpack v4.6.0+ 增加了对预获取和预加载的支持。</p>
<p>在声明 import 时，使用下面这些内置指令，可以让 webpack 输出 “resource hint (资源提示)”，来告知浏览器：</p>
<ul>
<li><strong>prefetch</strong> (预获取)：将来某些导航下可能需要的资源</li>
<li><strong>preload</strong> (预加载)：当前导航下可能需要资源</li>
</ul>
<h3 id="prefetch-预获取"><a class="markdownIt-Anchor" href="#prefetch-预获取">#</a> prefetch 预获取</h3>
<p>示例 1：prefetch。</p>
<p>1、编辑 index.js 文件。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> button <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'button'</span><span class="token punctuation">)</span> 
button<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token string">'点击执行加法运算'</span>
button<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span>
    <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName: 'math', webpackPrefetch: true */</span> <span class="token string">'./math.js'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">&#123;</span> add <span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>

document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>button<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>添加第二句魔法注释： <strong>webpackPrefetch: true</strong> 告诉 webpack 执行预获取。这会生成  <code>&lt;link rel=&quot;prefetch&quot; href=&quot;math.js&quot;&gt;</code>  并追加到页面头部，指示着浏览器在闲置时间预取 math.js 文件。</p>
<p>2、打包。</p>
<p>3、启动服务，在浏览器上查看。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124032229841.png" alt="image-20220124032229841"></p>
<p>4、结论。<br>
我们发现，在还没有点击按钮时， math.bundle.js 就已经下载下来了。同时，在 app.html 里 webpack 自动添加了一句： <code>&lt;link rel=&quot;prefetch&quot; as=&quot;script&quot; href=&quot;http://localhost:8080/math.bundle.js&quot;&gt;</code> 。点击按钮，会立即调用已经下载好的 math.bundle.js 文件中的 add 方法。</p>
<h3 id="preload-预加载"><a class="markdownIt-Anchor" href="#preload-预加载">#</a> preload 预加载</h3>
<p>与 prefetch 指令相比，preload 指令有许多不同之处：</p>
<ul>
<li>preload chunk 会在父 chunk 加载时，以并行方式开始加载。prefetch chunk 会在父 chunk 加载结束后开始加载。</li>
<li>preload chunk 具有中等优先级，并立即下载。prefetch chunk 在浏览器闲置时下载。</li>
<li>preload chunk 会在父 chunk 中立即请求，用于当下时刻。prefetch chunk 会用于未来的某个时刻。</li>
<li>浏览器支持程度不同。</li>
</ul>
<p>示例：preload。</p>
<p>1、创建一个 print.js 文件。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">print</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'preload chunk.'</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>2、修改 index.js 文件。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName: 'print', webpackPreload: true */</span> <span class="token string">'./print.js'</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">&#123;</span> print <span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
	<span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>3、打包，启动服务，打开浏览器。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npx webpack<span class="token operator">-</span>dev<span class="token operator">-</span>server <span class="token operator">--</span>open<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124032249824.png" alt="image-20220124032249824"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/bab76b012bd34916a72eee72ad8f0891%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/f6e9cda0b2134bdeb682ee0c5f3263ac%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>4、结论。<br>
print.bundle.js 被加载下来，是和当前 index.bundle.js 并行加载的。</p>
<h2 id="小结-3"><a class="markdownIt-Anchor" href="#小结-3">#</a> 小结</h2>
<p>代码分离 是 webpack 是一个非常好的一个功能，可以把多个模块共享的代码抽离出去，减少入口文件的大小，从而提高首屏的加载速度。</p>
<p>预获取 prefetch：在网络空闲的时侯，把将来很可能会使用的代码请求下载下来。这样既不影响首屏的加载速度，又省去了将来模块加载的延迟。</p>
<p>预加载 preload：实现多个模块的并行加载。</p>
<hr>
<h1 id="第九章-缓存"><a class="markdownIt-Anchor" href="#第九章-缓存">#</a> 第九章：缓存</h1>
<p>以上，我们使用 webpack 来打包我们的模块化后的应用程序，webpack 会生成一个可部署的 /dist 目录，然后把打包后的内容放置在此目录中。只要 /dist 目录中的内容部署到 server 上，client（通常是浏览器）就能够访问此 server 的网站及其资源。而最后一步获取资源是比较耗费时间的，这就是为什么浏览器使用一种名为缓存 的技术。可以通过命中缓存，以降低网络流量，使网站加载速度更快，然而，如果我们在部署新版本时不更改资源的文件名，浏览器可能会认为它没有被更新，就会使用它的缓存版本。由于缓存的存在，当你需要获取新的代码时，就会显得很棘手。</p>
<p>本节通过必要的配置，以确保 webpack 编译生成的文件能够被客户端缓存，而在文件内容变化后，能够请求到新的文件。</p>
<h2 id="91-输出文件的文件名"><a class="markdownIt-Anchor" href="#91-输出文件的文件名">#</a> 9.1 输出文件的文件名</h2>
<p><strong>原理：当我们修改自己的代码后，打包后的文件名（哈希值部分）就会发生变化，浏览器就会重新请求新的资源，而不是使用缓存的旧资源。</strong></p>
<p>我们可以通过替换 <strong>output.filename</strong> 中的 <strong>substitutions</strong> 设置，来定义输出文件的名称。webpack 提供了一种使用称为 <strong>substitution (可替换模板字符串)</strong> 的方式，通过带括号字符串来模板化文件名。其中，  <code>[contenthash]</code>  substitution 将根据资源内容创建出唯一 hash。当资源内容发生变化时，  <code>[contenthash]</code>  也会发生变化。</p>
<p>修改配置文件：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">output<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    filename<span class="token operator">:</span> <span class="token string">'[name].[contenthash].js'</span><span class="token punctuation">,</span>
    <span class="token operator">...</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>执行打包编译：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/df1920d02cfd4e47b28dd3ca79639875%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>可以看到，bundle 的名称是它内容（通过 hash）的映射。如果我们不做修改，然后再次运行构建，文件名会保持不变。</p>
<h2 id="92-缓存第三方库"><a class="markdownIt-Anchor" href="#92-缓存第三方库">#</a> 9.2 缓存第三方库</h2>
<p>将第三方库 (library)（例如 lodash ）提取到单独的 vendor chunk 文件中，是比较推荐的做法，这是因为，它们很少像本地的源代码那样频繁修改。因此通过实现以上步骤，利用 client 的长效缓存机制，命中缓存来消除请求，并减少向 server 获取资源，同时还能保证 client 代码和 server 代码版本一致。</p>
<p>我们在 optimization.splitChunks 添加如下 cacheGroups 参数并构建：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">optimization<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token operator">...</span>
    splitChunks<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        cacheGroups<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            vendor<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\/]node_modules[\\/]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                name<span class="token operator">:</span> <span class="token string">'vendors'</span><span class="token punctuation">,</span>
                chunks<span class="token operator">:</span> <span class="token string">'all'</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>执行编译：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124032312005.png" alt="image-20220124032312005"></p>
<h2 id="93-将js文件放到一个文件夹中"><a class="markdownIt-Anchor" href="#93-将js文件放到一个文件夹中">#</a> 9.3 将 js 文件放到一个文件夹中</h2>
<p>目前，全部 js 文件都在 dist 文件夹根目录下，我们尝试把它们放到一个文件夹中，这个其实也简单，修改配置文件：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">output<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    filename<span class="token operator">:</span> <span class="token string">'js/[name].[contenthash].js'</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>我们在输出配置中修改 filename ，在前面加上路径即可。执行编译：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npx webpack<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124032322293.png" alt="image-20220124032322293"></p>
<p>截止目前，我们已经把 JS 文件、样式文件及图片等资源文件分别放到了 scripts、styles、 images 三个文件夹中。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">...</span>
output<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">//指定js文件输出目录</span>
    filename<span class="token operator">:</span> <span class="token string">'js/[name].[contenthash].js'</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
       <span class="token punctuation">&#123;</span>
            test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.png$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            type<span class="token operator">:</span> <span class="token string">'asset'</span><span class="token punctuation">,</span>
            generator<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                <span class="token comment">//指定图片输出目录</span>
                filename<span class="token operator">:</span> <span class="token string">'images/[contenthash][ext]'</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span>
            test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(woff|woff2|eot|ttf|otf)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            type<span class="token operator">:</span> <span class="token string">'asset/resource'</span><span class="token punctuation">,</span>
            generator<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                <span class="token comment">//指定字体文件输出目录</span>
                filename<span class="token operator">:</span> <span class="token string">'fonts/[contenthash][ext]'</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token operator">...</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span>
plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token operator">...</span>
    <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
        <span class="token comment">//指定css文件输出目录</span>
        filename<span class="token operator">:</span> <span class="token string">'css/[contenthash].css'</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h1 id="第十章-拆分开发环境和生产环境配"><a class="markdownIt-Anchor" href="#第十章-拆分开发环境和生产环境配">#</a> 第十章：拆分开发环境和生产环境配</h1>
<p>现在，我们只能手工的来调整 mode 选项，实现生产环境和开发环境的切换，且很多配置在生产环境和开发环境中存在不一致的情况，比如开发环境没有必要设置缓存，生产环境还需要设置公共路径等等。</p>
<p>本节介绍拆分开发环境和生产环境，让打包更灵活。</p>
<h2 id="101-公共路径"><a class="markdownIt-Anchor" href="#101-公共路径">#</a> 10.1 公共路径</h2>
<p>在开发环境中，我们通常有一个 assets/ 文件夹，它与索引页面位于同一级别。这没太大问题，但是，如果我们将所有静态资源托管至 CDN，然后想在生产环境中使用呢？</p>
<p><strong>publicPath</strong> 配置选项在各种场景中都非常有用。你可以通过它来指定应用程序中所有资源的基础路径。</p>
<p>示例：output.publicPath。</p>
<p>1、设置 publicPath 选项。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">output<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    publicPath<span class="token operator">:</span> <span class="token string">'http://localhost:8080/'</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>2、打包效果。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124032339718.png" alt="image-20220124032339718"></p>
<p>3、结论。<br>
通过 output.publicPath 选项可以在打包资源的引用路径前添加一个域名，这个域名可以指定为项目的前端域名，或者 cdn 服务器的域名等等都可以的。</p>
<h2 id="102-环境变量"><a class="markdownIt-Anchor" href="#102-环境变量">#</a> 10.2 环境变量</h2>
<p>想要消除 webpack.config.js 在 <a href="https://link.juejin.cn?target=https%3A%2F%2Fwebpack.docschina.org%2Fguides%2Fdevelopment">开发环境</a> 和 <a href="https://link.juejin.cn?target=https%3A%2F%2Fwebpack.docschina.org%2Fguides%2Fproduction">生产环境</a> 之间的差异，你可能需要环境变量 (environment variable)。</p>
<p>webpack 命令行 <a href="https://link.juejin.cn?target=https%3A%2F%2Fwebpack.docschina.org%2Fapi%2Fcli%2F%23environment-options">环境配置</a> 的 --env 参数，可以允许你传入任意数量的环境变量。而在 webpack.config.js 中可以访问到这些环境变量。例如， --env production 或–env goal=local 。</p>
<p>对于我们的 webpack 配置，有一个必须要修改之处。通常， module.exports 指向配置对象。要使用 env 变量，你必须将 module.exports 转换成一个函数。函数会默认传入一个参数环境变量 env，根据命令行参数 env 来设置不同环境的 mode。</p>
<p>示例：环境变量。</p>
<p>1、修改配置文件。</p>
<ul>
<li>module.exports 一个函数，函数中返回一个对象。</li>
<li>函数中可以使用环境变量。</li>
</ul>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">env</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>env<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>env<span class="token punctuation">.</span>goal<span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span>
        <span class="token operator">...</span>
        <span class="token comment">// 根据命令行参数 env 来设置不同环境的 mode</span>
        mode<span class="token operator">:</span> env<span class="token punctuation">.</span>production <span class="token operator">?</span> <span class="token string">'production'</span> <span class="token operator">:</span> <span class="token string">'development'</span><span class="token punctuation">,</span>
        <span class="token operator">...</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>2、执行打包命令时，添加–env 参数，设置环境变量。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npx webpack <span class="token operator">--</span>env production <span class="token operator">--</span>env goal<span class="token operator">=</span>local<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>3、打包效果。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124032402967.png" alt="image-20220124032402967"></p>
<h3 id="压缩js代码"><a class="markdownIt-Anchor" href="#压缩js代码">#</a> 压缩 js 代码</h3>
<p>在前面，我们使用了  <code>mini-css-extract-plugin</code> 、 <code>css-minimizer-webpack-plugin</code>  插件来抽离和压缩 css 代码，但是它们会导致 webpack 默认的压缩 js 的功能失效，所以需要手动进行配置 <strong>terser</strong> 插件。</p>
<p>1、安装 terser-webpack-plugin。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npm install terser<span class="token operator">-</span>webpack<span class="token operator">-</span>plugin <span class="token operator">--</span>save<span class="token operator">-</span>dev<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>2、修改配置。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> TerserPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'terser-webpack-plugin'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">env</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span>
        <span class="token operator">...</span>
        optimization<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            minimizer<span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token operator">...</span>
                <span class="token comment">//实例化Terser插件</span>
                <span class="token keyword">new</span> <span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>3、重新打包。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npx webpack <span class="token operator">--</span>env production <span class="token operator">--</span>env goal<span class="token operator">=</span>local<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>4、打包效果。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/da767bc362c14f0f8d9587fa7af4b6b4%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>5、结论。<br>
打包输出的 js 文件成功压缩了。</p>
<p>注意： <strong>webpack 只会在生产打包时，对 js 代码进行压缩。而开发打包时，不会压缩 js 代码。</strong></p>
<h2 id="103-拆分配置文件"><a class="markdownIt-Anchor" href="#103-拆分配置文件">#</a> 10.3 拆分配置文件</h2>
<p>在前面，我们可以通过 环境变量 和 三元运算符 来判断当前是开发打包还是生产打包，从而进行各自的配置，但是这种方式比较糟糕。推荐划分两个不同的配置文件的方式来执行不同环境的打包。</p>
<p>目前，生产环境和开发环境使用的是一个配置文件，我们需要将这两个文件单独放到不同的配置文件中。如 webpack.config.dev.js （开发环境配置）和 webpack.config.prod.js （生产环境配置）。在项目根目录下创建一个配置文件夹 config 来存放他们。</p>
<p>注意：<strong>因为配置文件被放在 config/ 目录中了，所以需要将 output.path 中的’./dist’修改为’…/dist’。</strong></p>
<h3 id="webpackconfigdevjs"><a class="markdownIt-Anchor" href="#webpackconfigdevjs">#</a> webpack.config.dev.js</h3>
<p>webpack.config.dev.js 配置如下：</p>
<p>1.module.exports 是一个对象。<br>
2. 不需要缓存：去掉 output.filename 中的 contenthash。<br>
3. 不需要公共路径： 去掉 publicPath。<br>
4.mode 选项指定为’development’。<br>
5. 需要调试代码 devtool。<br>
6. 需要开发服务器 devServer。<br>
7. 不需要 css、js 压缩：去掉 css-minimizer-webpack-plugin、terser-webpack-plugin、optimization.minimizer。<br>
8. 其它项保留。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span>
<span class="token comment">//const MiniCssExtractPlugin = require('mini-css-extract-plugin')</span>
<span class="token comment">//const CssMinimizerPlugin = require('css-minimizer-webpack-plugin')</span>
<span class="token keyword">const</span> toml <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'toml'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> yaml <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'yamljs'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> json5 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'json5'</span><span class="token punctuation">)</span>
<span class="token comment">//const TerserPlugin = require('terser-webpack-plugin')</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span>  <span class="token punctuation">&#123;</span>
	<span class="token comment">//entry: './src/js/index.js',</span>
	
	entry<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
		index<span class="token operator">:</span> <span class="token string">'./src/js/index.js'</span><span class="token punctuation">,</span>
		another<span class="token operator">:</span> <span class="token string">'./src/js/another-module.js'</span>
	<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
	<span class="token comment">/* 
	entry: &#123;
		index: &#123;
			import: './src/js/index.js',
			dependOn: 'shared'
		&#125;,
		another: &#123;
			import: './src/js/another-module.js',
			dependOn: 'shared'
		&#125;,
		shared: 'lodash'
	&#125;, */</span>
	output<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
		<span class="token comment">//filename: 'bundle.js',</span>
		filename<span class="token operator">:</span> <span class="token string">'[name].bundle.js'</span><span class="token punctuation">,</span>
		<span class="token comment">//filename: 'js/[name].[contenthash].js',</span>
		path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		clean<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
		assetModuleFilename<span class="token operator">:</span> <span class="token string">'images/[contenthash][ext]'</span><span class="token punctuation">,</span> 
		<span class="token comment">//publicPath: 'http://localhost:8080/'</span>
	<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
	<span class="token comment">//生产模式</span>
	<span class="token comment">//mode: 'production',</span>
	<span class="token comment">//mode: 'development',</span>
	mode<span class="token operator">:</span> <span class="token string">'development'</span><span class="token punctuation">,</span>
	devtool<span class="token operator">:</span> <span class="token string">'inline-source-map'</span><span class="token punctuation">,</span>
	
	<span class="token comment">//开发服务器</span>
	devServer<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">static</span><span class="token operator">:</span> <span class="token string">'./dist'</span>
	<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
	plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
		<span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
			template<span class="token operator">:</span> <span class="token string">'./src/index.html'</span><span class="token punctuation">,</span>
			filename<span class="token operator">:</span> <span class="token string">'app.html'</span><span class="token punctuation">,</span>
			inject<span class="token operator">:</span> <span class="token string">'body'</span>
		<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token comment">//指定css输出目录</span>
		<span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
			filename<span class="token operator">:</span> <span class="token string">'css/[contenthash].css'</span>
		<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
	<span class="token punctuation">]</span><span class="token punctuation">,</span>
	module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
		rules<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.png$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				<span class="token comment">//type: 'asset/resource',</span>
				type<span class="token operator">:</span> <span class="token string">'asset'</span><span class="token punctuation">,</span>
				generator<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
					filename<span class="token operator">:</span> <span class="token string">'images/[contenthash][ext]'</span>
				<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
				parser<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
					dataUrlCondition<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
						maxSize<span class="token operator">:</span> <span class="token number">6</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token comment">// 6kb</span>
					<span class="token punctuation">&#125;</span>
				<span class="token punctuation">&#125;</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.svg$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				type<span class="token operator">:</span> <span class="token string">'asset/inline'</span><span class="token punctuation">,</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.txt$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				type<span class="token operator">:</span> <span class="token string">'asset/source'</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token comment">//处理css文件、less文件</span>
			<span class="token comment">/* 
			&#123;
				test: /\.(css|less)$/,
				use: ['style-loader','css-loader','less-loader']
			&#125; */</span>
			<span class="token comment">//抽离css文件</span>
			<span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(css|less)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				use<span class="token operator">:</span> <span class="token punctuation">[</span>MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span> <span class="token string">'less-loader'</span><span class="token punctuation">]</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token comment">//处理字体文件</span>
			<span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(woff|woff2|eot|ttf|otf)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				type<span class="token operator">:</span> <span class="token string">'asset/resource'</span><span class="token punctuation">,</span>
				generator<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
					filename<span class="token operator">:</span> <span class="token string">'fonts/[contenthash][ext]'</span>
				<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(csv|tsv)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'csv-loader'</span><span class="token punctuation">]</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.xml$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'xml-loader'</span><span class="token punctuation">]</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token comment">//处理toml、yaml、json5</span>
			<span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.toml$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				type<span class="token operator">:</span> <span class="token string">'json'</span><span class="token punctuation">,</span>
				parser<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
					parse<span class="token operator">:</span> toml<span class="token punctuation">.</span>parse
				<span class="token punctuation">&#125;</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.yaml$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				type<span class="token operator">:</span> <span class="token string">'json'</span><span class="token punctuation">,</span>
				parser<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
					parse<span class="token operator">:</span> yaml<span class="token punctuation">.</span>parse
				<span class="token punctuation">&#125;</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.json5$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				type<span class="token operator">:</span> <span class="token string">'json'</span><span class="token punctuation">,</span>
				parser<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
					parse<span class="token operator">:</span> json5<span class="token punctuation">.</span>parse
				<span class="token punctuation">&#125;</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				use<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
					loader<span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
					options<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
						presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@babel/preset-env'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
						plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
							<span class="token punctuation">[</span>
								<span class="token string">'@babel/plugin-transform-runtime'</span>
							<span class="token punctuation">]</span>
						<span class="token punctuation">]</span>
					<span class="token punctuation">&#125;</span>
				<span class="token punctuation">&#125;</span>
			<span class="token punctuation">&#125;</span>
		<span class="token punctuation">]</span>
	<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
	<span class="token comment">//优化配置</span>
	optimization<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
		<span class="token comment">/* minimizer: [
			new CssMinimizerPlugin(),
			new TerserPlugin()
		], */</span>
		<span class="token comment">/* 
		splitChunks: &#123;
			chunks: 'all'
		&#125;, */</span>
		splitChunks<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
			cacheGroups<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
				vendor<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
					test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\/]node_modules[\\/]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
					name<span class="token operator">:</span> <span class="token string">'vendors'</span><span class="token punctuation">,</span>
					chunks<span class="token operator">:</span> <span class="token string">'all'</span>
				<span class="token punctuation">&#125;</span>
			<span class="token punctuation">&#125;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="webpackconfigprodjs"><a class="markdownIt-Anchor" href="#webpackconfigprodjs">#</a> webpack.config.prod.js</h3>
<p>webpack.config.prod.js 配置如下：</p>
<p>1.module.exports 是一个对象。<br>
2. 需要缓存：output.filename 中使用 contenthash。<br>
3. 需要公共路径：output.publicPath。<br>
4.mode 指定为’production’。<br>
5. 不需要开发服务器：去掉 devtool。<br>
6. 不需要调试代码：去掉 devServer。<br>
7. 其它项保留。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mini-css-extract-plugin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> CssMinimizerPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'css-minimizer-webpack-plugin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> toml <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'toml'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> yaml <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'yamljs'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> json5 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'json5'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> TerserPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'terser-webpack-plugin'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
	<span class="token comment">//entry: './src/js/index.js',</span>
	
	entry<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
		index<span class="token operator">:</span> <span class="token string">'./src/js/index.js'</span><span class="token punctuation">,</span>
		another<span class="token operator">:</span> <span class="token string">'./src/js/another-module.js'</span>
	<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
	<span class="token comment">/* 
	entry: &#123;
		index: &#123;
			import: './src/js/index.js',
			dependOn: 'shared'
		&#125;,
		another: &#123;
			import: './src/js/another-module.js',
			dependOn: 'shared'
		&#125;,
		shared: 'lodash'
	&#125;, */</span>
	output<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
		<span class="token comment">//filename: 'bundle.js',</span>
		<span class="token comment">//filename: '[name].bundle.js',</span>
		filename<span class="token operator">:</span> <span class="token string">'js/[name].[contenthash].js'</span><span class="token punctuation">,</span>
		path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		clean<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
		assetModuleFilename<span class="token operator">:</span> <span class="token string">'images/[contenthash][ext]'</span><span class="token punctuation">,</span>
		publicPath<span class="token operator">:</span> <span class="token string">'http://localhost:8080/'</span>
	<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
	<span class="token comment">//生产模式</span>
	<span class="token comment">//mode: 'production',</span>
	<span class="token comment">//mode: 'development',</span>
	mode<span class="token operator">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
	<span class="token comment">//devtool: 'inline-source-map',</span>
	
	<span class="token comment">//开发服务器</span>
	<span class="token comment">/* 
	devServer: &#123;
		static: './dist'
	&#125;, */</span>
	plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
		<span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
			template<span class="token operator">:</span> <span class="token string">'./src/index.html'</span><span class="token punctuation">,</span>
			filename<span class="token operator">:</span> <span class="token string">'app.html'</span><span class="token punctuation">,</span>
			inject<span class="token operator">:</span> <span class="token string">'body'</span>
		<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token comment">//指定css输出目录</span>
		<span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
			filename<span class="token operator">:</span> <span class="token string">'css/[contenthash].css'</span>
		<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
	<span class="token punctuation">]</span><span class="token punctuation">,</span>
	module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
		rules<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.png$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				<span class="token comment">//type: 'asset/resource',</span>
				type<span class="token operator">:</span> <span class="token string">'asset'</span><span class="token punctuation">,</span>
				generator<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
					filename<span class="token operator">:</span> <span class="token string">'images/[contenthash][ext]'</span>
				<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
				parser<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
					dataUrlCondition<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
						maxSize<span class="token operator">:</span> <span class="token number">6</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token comment">// 6kb</span>
					<span class="token punctuation">&#125;</span>
				<span class="token punctuation">&#125;</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.svg$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				type<span class="token operator">:</span> <span class="token string">'asset/inline'</span><span class="token punctuation">,</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.txt$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				type<span class="token operator">:</span> <span class="token string">'asset/source'</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token comment">//处理css文件、less文件</span>
			<span class="token comment">/* 
			&#123;
				test: /\.(css|less)$/,
				use: ['style-loader','css-loader','less-loader']
			&#125; */</span>
			<span class="token comment">//抽离css文件</span>
			<span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(css|less)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				use<span class="token operator">:</span> <span class="token punctuation">[</span>MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span> <span class="token string">'less-loader'</span><span class="token punctuation">]</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token comment">//处理字体文件</span>
			<span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(woff|woff2|eot|ttf|otf)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				type<span class="token operator">:</span> <span class="token string">'asset/resource'</span><span class="token punctuation">,</span>
				generator<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
					filename<span class="token operator">:</span> <span class="token string">'fonts/[contenthash][ext]'</span>
				<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(csv|tsv)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'csv-loader'</span><span class="token punctuation">]</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.xml$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'xml-loader'</span><span class="token punctuation">]</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token comment">//处理toml、yaml、json5</span>
			<span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.toml$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				type<span class="token operator">:</span> <span class="token string">'json'</span><span class="token punctuation">,</span>
				parser<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
					parse<span class="token operator">:</span> toml<span class="token punctuation">.</span>parse
				<span class="token punctuation">&#125;</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.yaml$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				type<span class="token operator">:</span> <span class="token string">'json'</span><span class="token punctuation">,</span>
				parser<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
					parse<span class="token operator">:</span> yaml<span class="token punctuation">.</span>parse
				<span class="token punctuation">&#125;</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.json5$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				type<span class="token operator">:</span> <span class="token string">'json'</span><span class="token punctuation">,</span>
				parser<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
					parse<span class="token operator">:</span> json5<span class="token punctuation">.</span>parse
				<span class="token punctuation">&#125;</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				use<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
					loader<span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
					options<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
						presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@babel/preset-env'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
						plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
							<span class="token punctuation">[</span>
								<span class="token string">'@babel/plugin-transform-runtime'</span>
							<span class="token punctuation">]</span>
						<span class="token punctuation">]</span>
					<span class="token punctuation">&#125;</span>
				<span class="token punctuation">&#125;</span>
			<span class="token punctuation">&#125;</span>
		<span class="token punctuation">]</span>
	<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
	<span class="token comment">//优化配置</span>
	optimization<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
		minimizer<span class="token operator">:</span> <span class="token punctuation">[</span>
			<span class="token keyword">new</span> <span class="token class-name">CssMinimizerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
			<span class="token keyword">new</span> <span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">]</span><span class="token punctuation">,</span>
		<span class="token comment">/* 
		splitChunks: &#123;
			chunks: 'all'
		&#125;, */</span>
		splitChunks<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
			cacheGroups<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
				vendor<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
					test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\/]node_modules[\\/]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
					name<span class="token operator">:</span> <span class="token string">'vendors'</span><span class="token punctuation">,</span>
					chunks<span class="token operator">:</span> <span class="token string">'all'</span>
				<span class="token punctuation">&#125;</span>
			<span class="token punctuation">&#125;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>拆分成两个配置文件后，分别运行这两个文件：</p>
<p>开发环境：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npx webpack <span class="token operator">-</span>c <span class="token punctuation">.</span><span class="token operator">/</span>config<span class="token operator">/</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>dev<span class="token punctuation">.</span>js 
或
npx webpack serve <span class="token operator">-</span>c <span class="token punctuation">.</span><span class="token operator">/</span>config<span class="token operator">/</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>dev<span class="token punctuation">.</span>js<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>生产环境：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npx webpack <span class="token operator">-</span>c <span class="token punctuation">.</span><span class="token operator">/</span>config<span class="token operator">/</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>prod<span class="token punctuation">.</span>js 
或
npx webpack <span class="token operator">-</span>c <span class="token punctuation">.</span><span class="token operator">/</span>config<span class="token operator">/</span>webpack<span class="token punctuation">.</span>config<span class="token punctuation">.</span>prod<span class="token punctuation">.</span>js<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>说明：<br>
1、-c 参数，–config，指定使用哪个配置文件。<br>
2、serve 参数 表示启动开发服务器。开发打包时，可以使用该参数启动一个开发服务器，方便查看页面效果和调试代码。</p>
<p>示例 1：使用 开发配置文件 进行打包。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/5e563c106f7347bab575db97b6712ea8%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/bb29bc2e143e47c7878dffb255376d5e%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>结论：开发打包 输出的文件没有被压缩，文件名中也不包含 hash 值。</p>
<p>示例 2：使用 生产配置文件 进行打包。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/a0b662aca00144649c759f13fae58c37%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/ca0533774c334d15aedf42c59bb9e401%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>结论：生产打包 输出的文件被压缩，文件名中包含 hash 值。</p>
<h2 id="104-npm脚本"><a class="markdownIt-Anchor" href="#104-npm脚本">#</a> 10.4 npm 脚本</h2>
<h3 id="简化打包指令"><a class="markdownIt-Anchor" href="#简化打包指令">#</a> 简化打包指令</h3>
<p>每次打包或启动服务时，都需要在命令行里输入一长串的命令。能不能优化一下呢？</p>
<p>可以通过在 package.json 的 <code>scripts</code>  选项中添加 自定义指令 的方式来简化打包指令。</p>
<p>1、我们将父目录的 package.json 、 node_modules 与 package-lock.json 拷贝到当前目录下。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/image-20220124032438821.png" alt="image-20220124032438821"></p>
<p>2、package.json/scripts 选项中，添加自定义指令。</p>
<p>配置 npm 脚本来简化命令行的输入，这时可以省略 npx。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//package.json</span>

<span class="token operator">...</span>
<span class="token string">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token string">"start"</span><span class="token operator">:</span> <span class="token string">"npx webpack serve -c ./config/webpack.config.dev.js"</span><span class="token punctuation">,</span>
    <span class="token string">"build"</span><span class="token operator">:</span> <span class="token string">"npx webpack -c ./config/webpack.config.prod.js"</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>

或

<span class="token string">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token string">"start"</span><span class="token operator">:</span> <span class="token string">"webpack serve -c ./config/webpack.config.dev.js"</span><span class="token punctuation">,</span>
    <span class="token string">"build"</span><span class="token operator">:</span> <span class="token string">"webpack -c ./config/webpack.config.prod.js"</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>3、执行打包指令。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//开发打包</span>
npm run start

<span class="token comment">//生产打包</span>
npm run build<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="关闭性能提示"><a class="markdownIt-Anchor" href="#关闭性能提示">#</a> 关闭性能提示</h3>
<p>生产打包时，会输出一些性能方面的警告信息。如果我们不需要这些提示信息，则可以： 在配置文件中添加一个选项 performance 来关闭它。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//webpack.config.prod.js</span>

performance<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    hints<span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="105-提取公共配置"><a class="markdownIt-Anchor" href="#105-提取公共配置">#</a> 10.5 提取公共配置</h2>
<p>这时，我们发现这两个配置文件里存在大量的重复代码，可以手动的将这些重复的代码单独提取到一个文件里。</p>
<h3 id="webpackconfigcommonjs"><a class="markdownIt-Anchor" href="#webpackconfigcommonjs">#</a> webpack.config.common.js</h3>
<p>1、创建 webpack.config.common.js ，配置公共的内容。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mini-css-extract-plugin'</span><span class="token punctuation">)</span>
<span class="token comment">//const CssMinimizerPlugin = require('css-minimizer-webpack-plugin')</span>
<span class="token keyword">const</span> toml <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'toml'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> yaml <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'yamljs'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> json5 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'json5'</span><span class="token punctuation">)</span>
<span class="token comment">//const TerserPlugin = require('terser-webpack-plugin')</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
	<span class="token comment">//entry: './src/js/index.js',</span>
	
	entry<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
		index<span class="token operator">:</span> <span class="token string">'./src/js/index.js'</span><span class="token punctuation">,</span>
		another<span class="token operator">:</span> <span class="token string">'./src/js/another-module.js'</span>
	<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
	<span class="token comment">/* 
	entry: &#123;
		index: &#123;
			import: './src/js/index.js',
			dependOn: 'shared'
		&#125;,
		another: &#123;
			import: './src/js/another-module.js',
			dependOn: 'shared'
		&#125;,
		shared: 'lodash'
	&#125;, */</span>
	output<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
		<span class="token comment">//filename: 'bundle.js',</span>
		<span class="token comment">//filename: '[name].bundle.js',</span>
		<span class="token comment">//filename: 'js/[name].[contenthash].js',</span>
		path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		clean<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
		assetModuleFilename<span class="token operator">:</span> <span class="token string">'imgs/[contenthash][ext]'</span><span class="token punctuation">,</span>
		<span class="token comment">//publicPath: 'http://localhost:8080/'</span>
	<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
	<span class="token comment">//生产模式</span>
	<span class="token comment">//mode: 'production',</span>
	<span class="token comment">//mode: 'development',</span>
	<span class="token comment">//mode: env.production ? 'production' : 'development',</span>
	<span class="token comment">//devtool: 'inline-source-map',</span>
	
	<span class="token comment">//开发服务器</span>
	<span class="token comment">/* 
	devServer: &#123;
		static: './dist'
	&#125;, */</span>
	plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
		<span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
			template<span class="token operator">:</span> <span class="token string">'./src/index.html'</span><span class="token punctuation">,</span>
			filename<span class="token operator">:</span> <span class="token string">'app.html'</span><span class="token punctuation">,</span>
			inject<span class="token operator">:</span> <span class="token string">'body'</span>
		<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token comment">//指定css输出目录</span>
		<span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
			filename<span class="token operator">:</span> <span class="token string">'css/[contenthash].css'</span>
		<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
	<span class="token punctuation">]</span><span class="token punctuation">,</span>
	module<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
		rules<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.png$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				<span class="token comment">//type: 'asset/resource',</span>
				type<span class="token operator">:</span> <span class="token string">'asset'</span><span class="token punctuation">,</span>
				generator<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
					filename<span class="token operator">:</span> <span class="token string">'images/[contenthash][ext]'</span>
				<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
				parser<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
					dataUrlCondition<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
						maxSize<span class="token operator">:</span> <span class="token number">6</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token comment">// 6kb</span>
					<span class="token punctuation">&#125;</span>
				<span class="token punctuation">&#125;</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.svg$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				type<span class="token operator">:</span> <span class="token string">'asset/inline'</span><span class="token punctuation">,</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.txt$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				type<span class="token operator">:</span> <span class="token string">'asset/source'</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token comment">//处理css文件、less文件</span>
			<span class="token comment">/* 
			&#123;
				test: /\.(css|less)$/,
				use: ['style-loader','css-loader','less-loader']
			&#125; */</span>
			<span class="token comment">//抽离css文件</span>
			<span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(css|less)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				use<span class="token operator">:</span> <span class="token punctuation">[</span>MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span> <span class="token string">'less-loader'</span><span class="token punctuation">]</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token comment">//处理字体文件</span>
			<span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(woff|woff2|eot|ttf|otf)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				type<span class="token operator">:</span> <span class="token string">'asset/resource'</span><span class="token punctuation">,</span>
				generator<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
					filename<span class="token operator">:</span> <span class="token string">'fonts/[contenthash][ext]'</span>
				<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(csv|tsv)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'csv-loader'</span><span class="token punctuation">]</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.xml$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'xml-loader'</span><span class="token punctuation">]</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token comment">//处理toml、yaml、json5</span>
			<span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.toml$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				type<span class="token operator">:</span> <span class="token string">'json'</span><span class="token punctuation">,</span>
				parser<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
					parse<span class="token operator">:</span> toml<span class="token punctuation">.</span>parse
				<span class="token punctuation">&#125;</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.yaml$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				type<span class="token operator">:</span> <span class="token string">'json'</span><span class="token punctuation">,</span>
				parser<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
					parse<span class="token operator">:</span> yaml<span class="token punctuation">.</span>parse
				<span class="token punctuation">&#125;</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.json5$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				type<span class="token operator">:</span> <span class="token string">'json'</span><span class="token punctuation">,</span>
				parser<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
					parse<span class="token operator">:</span> json5<span class="token punctuation">.</span>parse
				<span class="token punctuation">&#125;</span>
			<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
			<span class="token punctuation">&#123;</span>
				test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
				use<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
					loader<span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
					options<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
						presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@babel/preset-env'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
						plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
							<span class="token punctuation">[</span>
								<span class="token string">'@babel/plugin-transform-runtime'</span>
							<span class="token punctuation">]</span>
						<span class="token punctuation">]</span>
					<span class="token punctuation">&#125;</span>
				<span class="token punctuation">&#125;</span>
			<span class="token punctuation">&#125;</span>
		<span class="token punctuation">]</span>
	<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
	<span class="token comment">//优化配置</span>
	optimization<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
		<span class="token comment">/* 
		minimizer: [
			new CssMinimizerPlugin(),
			new TerserPlugin()
		], */</span>
		<span class="token comment">/* 
		splitChunks: &#123;
			chunks: 'all'
		&#125;, */</span>
		splitChunks<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
			cacheGroups<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
				vendor<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
					test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\/]node_modules[\\/]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
					name<span class="token operator">:</span> <span class="token string">'vendors'</span><span class="token punctuation">,</span>
					chunks<span class="token operator">:</span> <span class="token string">'all'</span>
				<span class="token punctuation">&#125;</span>
			<span class="token punctuation">&#125;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="webpackconfigdevjs-2"><a class="markdownIt-Anchor" href="#webpackconfigdevjs-2">#</a> webpack.config.dev.js</h3>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span>  <span class="token punctuation">&#123;</span>
    output<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        filename<span class="token operator">:</span> <span class="token string">'[name].js'</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    mode<span class="token operator">:</span> <span class="token string">'development'</span><span class="token punctuation">,</span>
    devtool<span class="token operator">:</span> <span class="token string">'inline-source-map'</span><span class="token punctuation">,</span>
    <span class="token comment">//开发服务器</span>
    devServer<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">static</span><span class="token operator">:</span> <span class="token string">'./dist'</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="webpackconfigprodjs-2"><a class="markdownIt-Anchor" href="#webpackconfigprodjs-2">#</a> webpack.config.prod.js</h3>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> CssMinimizerPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'css-minimizer-webpack-plugin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> TerserPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'terser-webpack-plugin'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    output<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        filename<span class="token operator">:</span> <span class="token string">'js/[name].[contenthash].js'</span><span class="token punctuation">,</span>
        publicPath<span class="token operator">:</span> <span class="token string">'http://localhost:8080/'</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token comment">//生产模式</span>
    mode<span class="token operator">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
    <span class="token comment">//优化配置</span>
    optimization<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        minimizer<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token keyword">new</span> <span class="token class-name">CssMinimizerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token keyword">new</span> <span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="106-合并配置文件"><a class="markdownIt-Anchor" href="#106-合并配置文件">#</a> 10.6 合并配置文件</h2>
<p>配置文件拆分好后，新的问题来了，如何保证配置合并没用问题呢？<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fwebpack-merge">webpack-merge</a> 这个工具可以完美解决这个问题。</p>
<p>1、安装 webpack-merge 。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npm install webpack<span class="token operator">-</span>merge <span class="token operator">-</span><span class="token constant">D</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>2、创建 <strong>webpack.config.js</strong> ，合并代码。</p>
<p>在 config 目录中，新建一个 webpack.config.js 文件，对前面三个文件进行合并。写入以下内容：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">&#123;</span> merge <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-merge'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> commonConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack.config.common.js'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> developmentConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack.config.dev.js'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> productionConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack.config.prod.js'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">env</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">switch</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">case</span> env<span class="token punctuation">.</span>development<span class="token operator">:</span>
            <span class="token keyword">return</span> <span class="token function">merge</span><span class="token punctuation">(</span>commonConfig<span class="token punctuation">,</span> developmentConfig<span class="token punctuation">)</span>
        <span class="token keyword">case</span> env<span class="token punctuation">.</span>production<span class="token operator">:</span>
            <span class="token keyword">return</span> <span class="token function">merge</span><span class="token punctuation">(</span>commonConfig<span class="token punctuation">,</span> productionConfig<span class="token punctuation">)</span>
        <span class="token keyword">default</span><span class="token operator">:</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'No matching configuration was found!'</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span> 
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>3、修改自定义脚本。</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//package.json</span>

<span class="token string">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token string">"start"</span><span class="token operator">:</span> <span class="token string">"npx webpack serve -c ./config/webpack.config.js --env development"</span><span class="token punctuation">,</span>
    <span class="token string">"build"</span><span class="token operator">:</span> <span class="token string">"npx webpack -c ./config/webpack.config.js --env production"</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://raw.githubusercontent.com/HarryQu1229/image-host/main/notes-img/aeb86b1a07e540efac7cb0fd935be00f%7Etplv-k3u1fbpfcp-watermark.awebp" alt="image.png"></p>
<p>4、打包。</p>
<p>开发打包:</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npm run start<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>生产打包：</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">npm run build<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<hr>
<h1 id="小结-4"><a class="markdownIt-Anchor" href="#小结-4">#</a> 小结</h1>
<p>1、bundle、chunk、vendor<br>
bundle：n. 捆；(一) 包；(一) 扎；一批 (同类事物或出售的货品);<br>
chunk：n. 厚块；厚片；大块；相当大的量；<br>
vendor：n. 小贩；摊贩；</p>
<hr>
<h1 id="官方链接"><a class="markdownIt-Anchor" href="#官方链接">#</a> 官方链接</h1>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bootcdn.cn%2F">BootCDN</a></p>
<p><a href="https://link.juejin.cn?target=http%3A%2F%2Fnodejs.cn%2F">Node.js 中文网</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fnaotu.baidu.com%2F">百度脑图</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwebpack.js.org%2F">webpack</a><br>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fwebpack.js.org%2Fplugins%2F">webpack Plugins</a><br>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fwebpack.docschina.org%2Floaders%2Fcss-loader">css-loader</a><br>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftheplatapi%2Fcsv-loader">csv-loader</a><br>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fgisikw%2Fxml-loader">xml-loader</a><br>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fwebpack.docschina.org%2Fconfiguration%2Fmodule%2F%23ruleparserparse"> 自定义 parser</a><br>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fwebpack.docschina.org%2Fconfiguration%2Fentry-context">entry</a><br>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fwebpack.docschina.org%2Fconfiguration%2Fentry-context%2F%23dependencies">Entry dependencies</a><br>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fwebpack.docschina.org%2Fplugins%2Fsplit-chunks-plugin">SplitChunksPlugin</a><br>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fwebpack.docschina.org%2Fconfiguration%2Fentry-context%2F%23dependencies">dependOn option</a><br>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fwebpack.docschina.org%2Fplugins%2Fsplit-chunks-plugin">SplitChunksPlugin</a><br>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fwebpack.docschina.org%2Fconfiguration%2Foutput%2F%23outputpublicpath">output.publicPath</a><br>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fwebpack.docschina.org%2Fguides%2Fdevelopment"> 开发环境</a><br>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fwebpack.docschina.org%2Fguides%2Fproduction">生产环境</a><br>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fwebpack.docschina.org%2Fapi%2Fcli%2F%23environment-options">环境配置</a><br>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fwebpack-merge"> webpack-merge</a></p>
<h1 id="视频教程"><a class="markdownIt-Anchor" href="#视频教程">#</a> 视频教程</h1>
<p>_ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV1YU4y1g745">千锋最新前端 webpack5 全套教程，全网最完整的 webpack 教程（基础 + 高级）</a></p>
<p>webpack5 课程分为四大部分，分别是 webpack 基础应用篇，webpack 高级应用篇，webpack 项目实战篇以及 webpack 内部原理篇。在本课程中，我们将通过前后呼应的 demo 来一步步从 0 到 1 地进行 webpack5 教学，在课程后期我们也将学到更低层的原理知识。从而做到知其然并知其所以然的精熟掌握程度。</p>
<h1 id="配套资料"><a class="markdownIt-Anchor" href="#配套资料">#</a> 配套资料</h1>
<p>资料目录：H:\ 学习课程 \ediary 日记 \ 学习课程 \webpack5_千峰 \ 资料</p>
<p>练习代码目录：H:\ 学习课程 \ediary 日记 \ 学习课程 \webpack5_千峰 \wepack5_千峰_练习代码目录</p>
<p>作者：良仔 75<br>
 链接：<a target="_blank" rel="noopener" href="https://juejin.cn/post/7048971886696497183">https://juejin.cn/post/7048971886696497183</a><br>
 来源：稀土掘金<br>
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Harry Qu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://harryqu1229.github.io/2021/12/29/webpack5%E5%9F%BA%E7%A1%80/">https://harryqu1229.github.io/2021/12/29/webpack5%E5%9F%BA%E7%A1%80/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/frontend/">frontend</a><a class="post-meta__tags" href="/tags/webpack5/">webpack5</a></div><div class="post_share"><div class="addthis_inline_share_toolbox"></div><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-621848f44e1c3724" async="async"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/12/29/webpack5%E9%AB%98%E7%BA%A7/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default-covers/car.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">My Webpack5 notes</div></div></a></div><div class="next-post pull-right"><a href="/2021/12/30/mysql+jdbc+redis/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default-covers/statue.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Mysql + JDBC + Redis</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2021/12/29/webpack5%E9%AB%98%E7%BA%A7/" title="My Webpack5 notes"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default-covers/car.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-12-29</div><div class="title">My Webpack5 notes</div></div></a></div><div><a href="/2022/01/01/20%E9%81%93%E5%A4%A7%E5%8E%82%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E9%A2%98/" title="20 Frontend Interview Quesitions"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default-covers/car.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-01-01</div><div class="title">20 Frontend Interview Quesitions</div></div></a></div><div><a href="/2022/01/01/45%E9%81%93promise%E9%9D%A2%E8%AF%95%E9%A2%98/" title="45 Promise Frontend Interview Quesitions"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default-covers/cat.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-01-01</div><div class="title">45 Promise Frontend Interview Quesitions</div></div></a></div><div><a href="/2022/01/01/30%E9%81%93vue%E9%9D%A2%E8%AF%95%E9%A2%98/" title="30 Vue Frontend Interview Quesitions"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default-covers/mountain2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-01-01</div><div class="title">30 Vue Frontend Interview Quesitions</div></div></a></div><div><a href="/2022/01/01/50%E9%81%93%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E9%A2%98/" title="50 Frontend Interview Quesitions"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default-covers/home.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-01-01</div><div class="title">50 Frontend Interview Quesitions</div></div></a></div><div><a href="/2021/09/13/AJAX/" title="My Ajax notes"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default-covers/forest.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-09-13</div><div class="title">My Ajax notes</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div><div id="comment-switch"><span class="first-comment">Disqus</span><span class="switch-btn"></span><span class="second-comment">Gitalk</span></div></div><div class="comment-wrap"><div><div id="disqus_thread"></div></div><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/avatar.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Harry Qu</div><div class="author-info__description">Software Engineering Student</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">158</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">84</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">57</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/HarryQu1229"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://www.linkedin.com/in/harry-qu-a0a38220a" target="_blank" title="LinkedIn"><i class="fab fa-linkedin"></i></a><a class="social-icon" href="https://github.com/HarryQu1229" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:Harryqu666@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="weixin://dl/chat?harry666ya" target="_blank" title="Wechat"><i class="fab fa-weixin"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">be healthy, stay safe</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#0-%E8%AF%BE%E7%A8%8B%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text"> 0、课程介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E5%AD%A6%E4%B9%A0webpack"><span class="toc-number">1.1.</span> <span class="toc-text"> 为什么学习 Webpack？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E6%98%AFwebpack%E5%91%A2"><span class="toc-number">1.2.</span> <span class="toc-text"> 为什么是 Webpack 呢？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0webpack5%E7%9A%84%E5%89%8D%E6%8F%90"><span class="toc-number">1.3.</span> <span class="toc-text"> 学习 Webpack5 的前提？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%BE%E7%A8%8B%E5%AE%89%E6%8E%92"><span class="toc-number">1.4.</span> <span class="toc-text"> 课程安排？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%BE%E7%A8%8B%E6%94%B6%E8%8E%B7"><span class="toc-number">1.5.</span> <span class="toc-text"> 课程收获？</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81webpack"><span class="toc-number">2.</span> <span class="toc-text"> 第一章：为什么需要 webpack</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#10-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81webpack"><span class="toc-number">2.1.</span> <span class="toc-text"> 1.0 为什么需要 webpack</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3%E4%BD%9C%E7%94%A8%E5%9F%9F%E9%97%AE%E9%A2%98"><span class="toc-number">2.2.</span> <span class="toc-text"> 1.1 如何解决作用域问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#iife"><span class="toc-number">2.2.1.</span> <span class="toc-text"> IIFE</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3%E4%BB%A3%E7%A0%81%E6%8B%86%E5%88%86%E9%97%AE%E9%A2%98"><span class="toc-number">2.3.</span> <span class="toc-text"> 1.2 如何解决代码拆分问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#nodejs"><span class="toc-number">2.3.1.</span> <span class="toc-text"> node.js</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#commonjs"><span class="toc-number">2.3.2.</span> <span class="toc-text"> common.js</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-%E5%A6%82%E4%BD%95%E8%AE%A9%E6%B5%8F%E8%A7%88%E5%99%A8%E6%94%AF%E6%8C%81%E6%A8%A1%E5%9D%97"><span class="toc-number">2.4.</span> <span class="toc-text"> 1.3 如何让浏览器支持模块</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-webpack%E4%B8%8E%E7%AB%9E%E5%93%81"><span class="toc-number">2.5.</span> <span class="toc-text"> 1.4 webpack 与竞品</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E5%B0%8F%E8%AF%95webpack"><span class="toc-number">3.</span> <span class="toc-text"> 第二章：小试 webpack</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#21-%E5%BC%80%E5%8F%91%E5%87%86%E5%A4%87"><span class="toc-number">3.1.</span> <span class="toc-text"> 2.1 开发准备</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#22-%E5%AE%89%E8%A3%85webpack"><span class="toc-number">3.2.</span> <span class="toc-text"> 2.2 安装 Webpack</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85nodejs"><span class="toc-number">3.2.1.</span> <span class="toc-text"> 安装 Node.js</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85webpack"><span class="toc-number">3.2.2.</span> <span class="toc-text"> 安装 webpack</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#23-%E8%BF%90%E8%A1%8Cwebpack"><span class="toc-number">3.3.</span> <span class="toc-text"> 2.3 运行 Webpack</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F1%E4%BD%BF%E7%94%A8%E5%85%A8%E5%B1%80%E7%9A%84webpack%E8%BF%9B%E8%A1%8C%E6%89%93%E5%8C%85"><span class="toc-number">3.3.1.</span> <span class="toc-text"> 方式 1：使用全局的 webpack 进行打包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F2%E4%BD%BF%E7%94%A8%E6%9C%AC%E5%9C%B0%E7%9A%84webpack%E8%BF%9B%E8%A1%8C%E6%89%93%E5%8C%85-%E6%8E%A8%E8%8D%90"><span class="toc-number">3.3.2.</span> <span class="toc-text"> 方式 2：使用本地的 webpack 进行打包 （推荐）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#24-%E8%87%AA%E5%AE%9A%E4%B9%89webpack%E9%85%8D%E7%BD%AE"><span class="toc-number">3.4.</span> <span class="toc-text"> 2.4 自定义 Webpack 配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F1%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%8F%82%E6%95%B0"><span class="toc-number">3.4.1.</span> <span class="toc-text"> 方式 1：命令行参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F2%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%8E%A8%E8%8D%90"><span class="toc-number">3.4.2.</span> <span class="toc-text"> 方式 2：配置文件（推荐）</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E7%AB%A0-%E8%87%AA%E5%8A%A8%E5%BC%95%E5%85%A5%E8%B5%84%E6%BA%90"><span class="toc-number">4.</span> <span class="toc-text"> 第三章：自动引入资源</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#31-%E4%BB%80%E4%B9%88%E6%98%AF%E6%8F%92%E4%BB%B6"><span class="toc-number">4.1.</span> <span class="toc-text"> 3.1 什么是插件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#32-%E4%BD%BF%E7%94%A8htmlwebpackplugin"><span class="toc-number">4.2.</span> <span class="toc-text"> 3.2 使用 HtmlWebpackPlugin</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#plugins%E9%80%89%E9%A1%B9"><span class="toc-number">4.2.1.</span> <span class="toc-text"> plugins 选项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E4%BB%B6%E7%9A%84%E9%85%8D%E7%BD%AE%E5%AF%B9%E8%B1%A1"><span class="toc-number">4.2.2.</span> <span class="toc-text"> 插件的配置对象</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#33-%E6%B8%85%E7%90%86dist"><span class="toc-number">4.3.</span> <span class="toc-text"> 3.3 清理 dist</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83"><span class="toc-number">5.</span> <span class="toc-text"> 第四章：搭建开发环境</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#41-mode%E9%80%89%E9%A1%B9"><span class="toc-number">5.1.</span> <span class="toc-text"> 4.1 mode 选项</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#42-%E4%BD%BF%E7%94%A8source-map"><span class="toc-number">5.2.</span> <span class="toc-text"> 4.2 使用 source map</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#43-%E4%BD%BF%E7%94%A8watch-mode"><span class="toc-number">5.3.</span> <span class="toc-text"> 4.3 使用 watch mode</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#44-%E4%BD%BF%E7%94%A8webpack-dev-server"><span class="toc-number">5.4.</span> <span class="toc-text"> 4.4 使用 webpack-dev-server</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93"><span class="toc-number">5.5.</span> <span class="toc-text"> 小结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E7%AB%A0-%E8%B5%84%E6%BA%90%E6%A8%A1%E5%9D%97"><span class="toc-number">6.</span> <span class="toc-text"> 第五章：资源模块</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#51-%E8%B5%84%E6%BA%90%E6%A8%A1%E5%9D%97%E4%BB%8B%E7%BB%8D"><span class="toc-number">6.1.</span> <span class="toc-text"> 5.1 资源模块介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#52-resource%E8%B5%84%E6%BA%90"><span class="toc-number">6.2.</span> <span class="toc-text"> 5.2 Resource 资源</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#module%E9%80%89%E9%A1%B9"><span class="toc-number">6.2.1.</span> <span class="toc-text"> module 选项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rules%E9%80%89%E9%A1%B9"><span class="toc-number">6.2.2.</span> <span class="toc-text"> rules 选项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%84%E7%90%86%E5%9B%BE%E7%89%87%E8%B5%84%E6%BA%90"><span class="toc-number">6.2.3.</span> <span class="toc-text"> 处理图片资源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E8%BE%93%E5%87%BA%E7%9B%AE%E5%BD%95%E5%92%8C%E6%96%87%E4%BB%B6%E5%90%8D"><span class="toc-number">6.2.4.</span> <span class="toc-text"> 自定义输出目录和文件名</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E6%B3%951assetmodulefilename%E5%B1%9E%E6%80%A7"><span class="toc-number">6.2.4.1.</span> <span class="toc-text"> 方法 1：assetModuleFilename 属性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E6%B3%952generator%E5%B1%9E%E6%80%A7"><span class="toc-number">6.2.4.2.</span> <span class="toc-text"> 方法 2：generator 属性</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#53-inline%E8%B5%84%E6%BA%90"><span class="toc-number">6.3.</span> <span class="toc-text"> 5.3 inline 资源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#54-source%E8%B5%84%E6%BA%90"><span class="toc-number">6.4.</span> <span class="toc-text"> 5.4 source 资源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#55-%E9%80%9A%E7%94%A8%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">6.5.</span> <span class="toc-text"> 5.5 通用数据类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93-2"><span class="toc-number">6.6.</span> <span class="toc-text"> 小结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E5%85%AD%E7%AB%A0-%E7%AE%A1%E7%90%86%E8%B5%84%E6%BA%90"><span class="toc-number">7.</span> <span class="toc-text"> 第六章：管理资源</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#61-%E4%BB%80%E4%B9%88%E6%98%AFloader"><span class="toc-number">7.1.</span> <span class="toc-text"> 6.1 什么是 loader</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#62-%E5%8A%A0%E8%BD%BDcss"><span class="toc-number">7.2.</span> <span class="toc-text"> 6.2 加载 CSS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#css-loader"><span class="toc-number">7.2.1.</span> <span class="toc-text"> css-loader</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#style-loader"><span class="toc-number">7.2.2.</span> <span class="toc-text"> style-loader</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#less-loader"><span class="toc-number">7.2.3.</span> <span class="toc-text"> less-loader</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#63-%E6%8A%BD%E7%A6%BB%E5%92%8C%E5%8E%8B%E7%BC%A9css"><span class="toc-number">7.3.</span> <span class="toc-text"> 6.3 抽离和压缩 CSS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#mini-css-extract-plugin"><span class="toc-number">7.3.1.</span> <span class="toc-text"> mini-css-extract-plugin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#css-minimizer-webpack-plugin"><span class="toc-number">7.3.2.</span> <span class="toc-text"> css-minimizer-webpack-plugin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B"><span class="toc-number">7.3.3.</span> <span class="toc-text"> 示例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#64-%E5%8A%A0%E8%BD%BDimages%E5%9B%BE%E5%83%8F"><span class="toc-number">7.4.</span> <span class="toc-text"> 6.4 加载 images 图像</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#65-%E5%8A%A0%E8%BD%BDfonts%E5%AD%97%E4%BD%93"><span class="toc-number">7.5.</span> <span class="toc-text"> 6.5 加载 fonts 字体</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#66-%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE"><span class="toc-number">7.6.</span> <span class="toc-text"> 6.6 加载数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#csv-loader"><span class="toc-number">7.6.1.</span> <span class="toc-text"> csv-loader</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#xml-loader"><span class="toc-number">7.6.2.</span> <span class="toc-text"> xml-loader</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#67-%E8%87%AA%E5%AE%9A%E4%B9%89json%E6%A8%A1%E5%9D%97parser"><span class="toc-number">7.7.</span> <span class="toc-text"> 6.7 自定义 JSON 模块 parser</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B8%83%E7%AB%A0-%E4%BD%BF%E7%94%A8babel-loader"><span class="toc-number">8.</span> <span class="toc-text"> 第七章：使用 babel-loader</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#71-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81babel-loader"><span class="toc-number">8.1.</span> <span class="toc-text"> 7.1 为什么需要 babel-loader</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#72-%E4%BD%BF%E7%94%A8babel-loader"><span class="toc-number">8.2.</span> <span class="toc-text"> 7.2 使用 babel-loader</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#73-regeneratorruntime%E6%8F%92%E4%BB%B6"><span class="toc-number">8.3.</span> <span class="toc-text"> 7.3 regeneratorRuntime 插件</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E5%85%AB%E7%AB%A0-%E4%BB%A3%E7%A0%81%E5%88%86%E7%A6%BB"><span class="toc-number">9.</span> <span class="toc-text"> 第八章：代码分离</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#82-%E5%85%A5%E5%8F%A3%E8%B5%B7%E7%82%B9"><span class="toc-number">9.1.</span> <span class="toc-text"> 8.2 入口起点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#83-%E9%98%B2%E6%AD%A2%E9%87%8D%E5%A4%8D"><span class="toc-number">9.2.</span> <span class="toc-text"> 8.3 防止重复</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A5%E5%8F%A3%E4%BE%9D%E8%B5%96"><span class="toc-number">9.2.1.</span> <span class="toc-text"> 入口依赖</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#splitchunksplugin"><span class="toc-number">9.2.2.</span> <span class="toc-text"> SplitChunksPlugin</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#84-%E5%8A%A8%E6%80%81%E5%AF%BC%E5%85%A5"><span class="toc-number">9.3.</span> <span class="toc-text"> 8.4 动态导入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#import"><span class="toc-number">9.3.1.</span> <span class="toc-text"> import()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#85-%E6%87%92%E5%8A%A0%E8%BD%BD"><span class="toc-number">9.4.</span> <span class="toc-text"> 8.5 懒加载</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#86-%E9%A2%84%E8%8E%B7%E5%8F%96-%E9%A2%84%E5%8A%A0%E8%BD%BD%E6%A8%A1%E5%9D%97"><span class="toc-number">9.5.</span> <span class="toc-text"> 8.6 预获取、预加载模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#prefetch-%E9%A2%84%E8%8E%B7%E5%8F%96"><span class="toc-number">9.5.1.</span> <span class="toc-text"> prefetch 预获取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#preload-%E9%A2%84%E5%8A%A0%E8%BD%BD"><span class="toc-number">9.5.2.</span> <span class="toc-text"> preload 预加载</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93-3"><span class="toc-number">9.6.</span> <span class="toc-text"> 小结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B9%9D%E7%AB%A0-%E7%BC%93%E5%AD%98"><span class="toc-number">10.</span> <span class="toc-text"> 第九章：缓存</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#91-%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6%E7%9A%84%E6%96%87%E4%BB%B6%E5%90%8D"><span class="toc-number">10.1.</span> <span class="toc-text"> 9.1 输出文件的文件名</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#92-%E7%BC%93%E5%AD%98%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93"><span class="toc-number">10.2.</span> <span class="toc-text"> 9.2 缓存第三方库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#93-%E5%B0%86js%E6%96%87%E4%BB%B6%E6%94%BE%E5%88%B0%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%AD"><span class="toc-number">10.3.</span> <span class="toc-text"> 9.3 将 js 文件放到一个文件夹中</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E5%8D%81%E7%AB%A0-%E6%8B%86%E5%88%86%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%92%8C%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E9%85%8D"><span class="toc-number">11.</span> <span class="toc-text"> 第十章：拆分开发环境和生产环境配</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#101-%E5%85%AC%E5%85%B1%E8%B7%AF%E5%BE%84"><span class="toc-number">11.1.</span> <span class="toc-text"> 10.1 公共路径</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#102-%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="toc-number">11.2.</span> <span class="toc-text"> 10.2 环境变量</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%8B%E7%BC%A9js%E4%BB%A3%E7%A0%81"><span class="toc-number">11.2.1.</span> <span class="toc-text"> 压缩 js 代码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#103-%E6%8B%86%E5%88%86%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">11.3.</span> <span class="toc-text"> 10.3 拆分配置文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#webpackconfigdevjs"><span class="toc-number">11.3.1.</span> <span class="toc-text"> webpack.config.dev.js</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#webpackconfigprodjs"><span class="toc-number">11.3.2.</span> <span class="toc-text"> webpack.config.prod.js</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#104-npm%E8%84%9A%E6%9C%AC"><span class="toc-number">11.4.</span> <span class="toc-text"> 10.4 npm 脚本</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8C%96%E6%89%93%E5%8C%85%E6%8C%87%E4%BB%A4"><span class="toc-number">11.4.1.</span> <span class="toc-text"> 简化打包指令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E9%97%AD%E6%80%A7%E8%83%BD%E6%8F%90%E7%A4%BA"><span class="toc-number">11.4.2.</span> <span class="toc-text"> 关闭性能提示</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#105-%E6%8F%90%E5%8F%96%E5%85%AC%E5%85%B1%E9%85%8D%E7%BD%AE"><span class="toc-number">11.5.</span> <span class="toc-text"> 10.5 提取公共配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#webpackconfigcommonjs"><span class="toc-number">11.5.1.</span> <span class="toc-text"> webpack.config.common.js</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#webpackconfigdevjs-2"><span class="toc-number">11.5.2.</span> <span class="toc-text"> webpack.config.dev.js</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#webpackconfigprodjs-2"><span class="toc-number">11.5.3.</span> <span class="toc-text"> webpack.config.prod.js</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#106-%E5%90%88%E5%B9%B6%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">11.6.</span> <span class="toc-text"> 10.6 合并配置文件</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93-4"><span class="toc-number">12.</span> <span class="toc-text"> 小结</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E9%93%BE%E6%8E%A5"><span class="toc-number">13.</span> <span class="toc-text"> 官方链接</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A7%86%E9%A2%91%E6%95%99%E7%A8%8B"><span class="toc-number">14.</span> <span class="toc-text"> 视频教程</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%85%8D%E5%A5%97%E8%B5%84%E6%96%99"><span class="toc-number">15.</span> <span class="toc-text"> 配套资料</span></a></li></ol></div></div><div class="card-widget card-map"><div class="card-content"><div class="item-headline"><i class="fa fa-globe-asia" aria-hidden="true"></i><span>Visitor Map</span></div><script id="clstr_globe" type="text/javascript" defer="defer" src="//clustrmaps.com/globe.js?d=4LA950xi3DtQgUHPlkO0mo-n_QgrcOu-1BIiVpExg7k"></script></div></div><div class="card-widget card-pixiv"><div class="card-content"><div class="item-headline"><i class="fa fa-image" aria-hidden="true"></i><span>Pixiv Top50</span><iframe src="https://cloud.mokeyjay.com/pixiv" frameborder="0" style="width:99%;height:380px;margin:0;"></iframe></div></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/07/28/Maven/" title="My Maven notes"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default-covers/hello-world.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="My Maven notes"/></a><div class="content"><a class="title" href="/2022/07/28/Maven/" title="My Maven notes">My Maven notes</a><time datetime="2022-07-27T12:00:00.000Z" title="Created 2022-07-28 00:00:00">2022-07-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/25/nodejs/" title="Nodejs notes"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default-covers/town.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Nodejs notes"/></a><div class="content"><a class="title" href="/2022/07/25/nodejs/" title="Nodejs notes">Nodejs notes</a><time datetime="2022-07-24T12:00:00.000Z" title="Created 2022-07-25 00:00:00">2022-07-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/12/%E7%AE%97%E6%B3%95%E7%BB%88%E6%9E%81%E6%8C%87%E5%8D%97/" title="My ultimate data structure and algorithm guide"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default-covers/statue.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="My ultimate data structure and algorithm guide"/></a><div class="content"><a class="title" href="/2022/06/12/%E7%AE%97%E6%B3%95%E7%BB%88%E6%9E%81%E6%8C%87%E5%8D%97/" title="My ultimate data structure and algorithm guide">My ultimate data structure and algorithm guide</a><time datetime="2022-06-11T12:00:00.000Z" title="Created 2022-06-12 00:00:00">2022-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/12/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" title="Design Patterns"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default-covers/home.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Design Patterns"/></a><div class="content"><a class="title" href="/2022/06/12/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" title="Design Patterns">Design Patterns</a><time datetime="2022-06-11T12:00:00.000Z" title="Created 2022-06-12 00:00:00">2022-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/11/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%20-%20%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95/" title="Design Patterns - Factory Method"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/default-covers/home.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Design Patterns - Factory Method"/></a><div class="content"><a class="title" href="/2022/06/11/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%20-%20%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95/" title="Design Patterns - Factory Method">Design Patterns - Factory Method</a><time datetime="2022-06-10T12:00:00.000Z" title="Created 2022-06-11 00:00:00">2022-06-11</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2022 By Harry Qu</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="Chat"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Local search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function loadDisqus () {
  var disqus_config = function () {
    this.page.url = 'https://harryqu1229.github.io/2021/12/29/webpack5%E5%9F%BA%E7%A1%80/'
    this.page.identifier = '2021/12/29/webpack5基础/'
    this.page.title = 'My Webpack5 Advanced notes'
  };

  window.disqusReset = () => {
    DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  if (window.DISQUS) disqusReset()
  else {
    (function() { 
      var d = document, s = d.createElement('script');
      s.src = 'https://harry-study-blog.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  }
}

if ('Disqus' === 'Disqus' || !true) {
  if (true) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
  else loadDisqus()
} else {
  function loadOtherComment () {
    loadDisqus()
  }
}
</script><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: '5df1e915e0fa867b50de',
      clientSecret: 'ce1cb793fe49078ee9d0102d3326d0d50ff6937b',
      repo: 'blog-comments-storage',
      owner: 'HarryQu1229',
      admin: ['HarryQu1229'],
      id: 'a4f248904d6be733346cf09c2dbb04a9',
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Disqus' === 'Gitalk' || !true) {
  if (true) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[image]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[link]') // replace url
    content = content.replace(/<code>.*?<\/code>/gi, '[code]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    fetch('https://disqus.com/api/3.0/forums/listPosts.json?forum=harry-study-blog&related=thread&limit=6&api_key=B5XFmdGuVaYDW7OIBakffpXoKorvphwRiwONIol4puEtr8YiwYAMAk2K7QcExNLY')
      .then(response => response.json())
      .then(data => {
        const disqusArray = data.response.map(item => {
          return {
            'avatar': item.author.avatar.cache,
            'content': changeContent(item.message),
            'nick': item.author.name,
            'url': item.url,
            'date': item.createdAt
          }
        })

        saveToLocal.set('disqus-newest-comments', JSON.stringify(disqusArray), 10/(60*24))
        generateHtml(disqusArray)
      }).catch(e => {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.innerHTML= "Unable to get the data, please make sure the settings are correct."
      })
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick}</span><time> / ${btf.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += 'No Comment'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('disqus-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><div class="aplayer no-destroy" data-id="2809513713" data-server="netease" data-type="playlist" data-autoplay="false" data-fixed="true" data-order="random" data-theme="#e9ccd3"> </div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script id="canvas_nest" defer="defer" color="255,255,255" opacity="0.7" zIndex="-1" count="99" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script>((window.gitter = {}).chat = {}).options = {
  disableDefaultChat: true,
};
document.addEventListener('gitter-sidecar-ready', (e) => {
  const GitterChat = e.detail.Chat
  let chat

  function initGitter () {
    chat = new GitterChat({
      room: 'HarryStudyBlog/community',
      activationElement: '#chat_btn'
    });
  }

  initGitter()

  if (true) {
    document.addEventListener('pjax:complete', () => {
      chat.destroy()
      initGitter()
    })
  }

})</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async="async" defer="defer"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<div id="ghbdages" style="overflow:hidden;max-height:90px;height:auto;text-align:center;margin-top:10px"><div class="swiper-wrapper"><div class="swiper-slide"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" title="博客框架为Hexo_v5.4.0"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" title="主题版本Butterfly_v3.8.2"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" title="本站项目由Github托管"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a></div><div class="swiper-slide"><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a></div></div></div><style>a.github-badge:hover:before {display:none}</style>';
    console.log('已挂载butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-footer-beautify/lib/swiperbdage_init.min.js"></script><!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":300,"height":450},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>